!function(){"use strict";var t="undefined"==typeof window?global:window;if("function"!=typeof t.require){var e={},r={},o={}.hasOwnProperty,n={},a=function(t,e){var r=0;e&&(e.indexOf(!1)&&(r="components/".length),e.indexOf("/",r)>0&&(e=e.substring(r,e.indexOf("/",r))));var o=n[t+"/index.js"]||n[e+"/deps/"+t+"/index.js"];return o?"components/"+o.substring(0,o.length-".js".length):t},i=function(){var t=/^\.\.?(\/|$)/;return function(e,r){var o,n,a=[];o=(t.test(r)?e+"/"+r:r).split("/");for(var i=0,s=o.length;s>i;i++)n=o[i],".."===n?a.pop():"."!==n&&""!==n&&a.push(n);return a.join("/")}}(),s=function(t){return t.split("/").slice(0,-1).join("/")},c=function(e){return function(r){var o=i(s(e),r);return t.require(o,e)}},l=function(t,e){var o={id:t,exports:{}};return r[t]=o,e(o.exports,c(t),o),o.exports},u=function(t,n){var s=i(t,".");if(null==n&&(n="/"),s=a(t,n),o.call(r,s))return r[s].exports;if(o.call(e,s))return l(s,e[s]);var c=i(s,"./index");if(o.call(r,c))return r[c].exports;if(o.call(e,c))return l(c,e[c]);throw new Error('Cannot find module "'+t+'" from "'+n+'"')};u.alias=function(t,e){n[e]=t},u.register=u.define=function(t,r){if("object"==typeof t)for(var n in t)o.call(t,n)&&(e[n]=t[n]);else e[t]=r},u.list=function(){var t=[];for(var r in e)o.call(e,r)&&t.push(r);return t},u.brunch=!0,t.require=u}}(),require.register("application",function(t,e,r){var o,n,a,i,s,c,l,u,p={}.hasOwnProperty,d=function(t,e){function r(){this.constructor=t}for(var o in e)p.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};l=e("routes"),i=e("models/config"),s=e("collections/contacts"),u=e("collections/tags"),o=e("views/app_layout"),n=e("views/models/app"),c=e("lib/intent_manager"),a=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return d(r,t),r.prototype.initialize=function(){return this.on("before:start",function(t){return function(){var r;return r=new i(e("imports").config),t.model=new n(null,{model:r}),t.contacts=new s,t.tags=new u,t.layout=new o({model:t.model}),t.router=new l,t.intentManager=new c,"function"==typeof Object.freeze?Object.freeze(t):void 0}}(this)),this.on("start",function(t){return function(){return t.contacts.fetch({reset:!0}),t.tags.fetch({reset:!0}),t.layout.render(),Backbone.history?Backbone.history.start({pushState:!1}):void 0}}(this))},r.prototype.search=function(t,r){var o,n,a;return o=this.model.get("filter"),n="`"+t+":"+r+"`",t=e("config").search.pattern(t),a=null!=o?o.match(t):void 0,r?a?o=o.replace(t,n):(null!=o?o.length:void 0)?o+=n:o=n:a&&(o=o.replace(t,"")),this.model.set("filter",o)},r}(Mn.Application),r.exports=new a}),require.register("collections/charindex",function(t,e,r){var o,n,a,i,s,c={}.hasOwnProperty,l=function(t,e){function r(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};n=BackboneProjections.Filtered,s=e("lib/diacritics"),i=s.asciize,a=s.alphabet,r.exports=o=function(t){function r(t,o){var n;n=e("application"),o.filter=function(t){var e,r,n,s,c,l;return n=i(t.attributes.n).toLowerCase(),"fn"===o.filter.sort?(c=n.split(";"),s=c[0],e=c[1]):(l=n.split(";"),e=l[0],s=l[1]),r=e?e[0]:s?s[0]:"#","#"===o["char"]?!r.match(a):o["char"]===r},o.filter.sort=n.model.get("sort"),r.__super__.constructor.apply(this,arguments),this.stopListening(this.underlying,"sort"),this.listenTo(t,"sort",function(){return _.defer(function(t){return function(){return o.filter.sort=n.model.get("sort"),t.reset(t.underlying.models.filter(t.options.filter))}}(this))})}return l(r,t),r}(n)}),require.register("collections/contacts",function(t,e,r){var o,n,a,i={}.hasOwnProperty,s=function(t,e){function r(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};n=e("lib/contacts_listener"),a=function(t,e){var r;return t=t.get("n").split(";"),e=e.get("n").split(";"),r=function(){switch(this.comparator.sort){case"gn":return 0;case"fn":return 1;default:return 0}}.call(this),t[r].localeCompare(e[r])},r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.model=e("models/contact"),r.prototype.url="contacts",r.prototype.initialize=function(){var t;return t=e("application"),this.comparator=a,this.comparator.sort=t.model.get("sort"),this.listenTo(t.model,"change:sort",function(t,e){return this.comparator.sort=e,this.sort()}),this.listenToOnce(this,"sync",function(){return(new n).watch(this)})},r.prototype.importFromVCF=function(t){var e,r,o;return r=0,e=t.split(/END:VCARD[\r\n]{0,2}/gi).filter(function(t){return!_.isEmpty(t)}).map(function(t){return""+t+"END:VCARD"}),this.trigger("before:import:progress",e.length),o=function(t){return function(){var n,a;return n=e.pop(),n?(a=new VCardParser,a.read(n),t.create(a.contacts[0],{parse:!0}),t.trigger("import:progress",++r),setTimeout(o)):t.trigger("import",r)}}(this),setTimeout(o,35)},r}(Backbone.Collection)}),require.register("collections/duplicates",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=e("lib/compare_contacts"),r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.model=e("views/models/merge"),r.prototype.url=null,r.prototype.initialize=function(t,e){var r,n;return(r=e.collection)?(n=o.findSimilars(r.toJSON()),n.forEach(function(t){return function(e){return e=e.map(function(t){return r.get(t.id)}),t.add({candidates:e})}}(this))):void 0},r}(Backbone.Collection)}),require.register("collections/search",function(t,e,r){var o,n,a=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,s=function(t,e){function r(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=BackboneProjections.Filtered,r.exports=n=function(t){function r(t,o){var n;null==o&&(o={}),this.filter=a(this.filter,this),n=e("application"),this.search=n.model.get("filter"),o.filter=this.filter,r.__super__.constructor.call(this,t,o),this.listenTo(n.model,"change:filter",function(t,e){return this.search=e,this.update()})}return s(r,t),r.prototype.filter=function(t){var r,o;return r=null!=(o=this.search)?o.match(e("config").search.pattern()):void 0,r?r.reduce(function(e,r){var o,n,a,i;return i=r.slice(1,-1).split(":"),n=i[0],a=i[1],o=function(){switch(n){case"tag":return _.contains(t.attributes.tags,a);case"text":return t.match(a);default:return!0}}(),o||(e=!1),e},!0):!0},r.prototype.update=function(){return this.filter?this.reset(this.underlying.models.filter(this.options.filter)):this.reset(this.underlying.models)},r}(o)}),require.register("collections/tags",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};n=e("lib/tags_listener"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.model=e("models/tag"),r.prototype.url="tags",r.prototype.initialize=function(){return this.listenToOnce(this,"sync",function(){return(new n).watch(this)})},r.prototype.parse=function(t){return _.uniq(t,function(t){return t.name.toLowerCase()})},r}(Backbone.Collection)}),require.register("config",function(t,e,r){r.exports={contact:{xtras:["bday"],datapoints:{main:["tel","email","adr"],types:{"default":["main","work","home"],social:["twitter:social","skype:chat"],url:["website","blog"]}}},settings:{sortkeys:["gn","fn"]},colorSet:["304FFE","2979FF","00B0FF","00DCE9","00D5B8","00C853","E70505","FF5700","FF7900","FFA300","B3C51D","64DD17","FF2828","F819AA","AA00FF","6200EA","7190AB","51658D"],search:{pattern:function(t,e){return e=t?"i":"ig",new RegExp("`"+(t||"\\w+")+":([^`]+)`",e)}}}}),require.register("initialize",function(t,e,r){var o;window.onerror=function(t,e,r,o,n){var a,i,s;return console.error(t,e,r,o,n,null!=n?n.stack:void 0),i=(null!=n?n.toString():void 0)||t,i!==window.lastError?(a={data:{type:"error",error:{msg:t,name:null!=n?n.name:void 0,full:i,stack:null!=n?n.stack:void 0},url:e,line:r,col:o,href:window.location.href}},s=new XMLHttpRequest,s.open("POST","log",!0),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.send(JSON.stringify(a)),window.lastError=i):void 0},o=e("./application"),$(function(){return ColorHash.addScheme("cozy",e("config").colorSet),Mn.Behaviors.behaviorsLookup=e("lib/behaviors"),window.t=e("lib/i18n"),o.start()})}),require.register("lib/behaviors/confirm",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};n=e("lib/views/confirm"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.ui={confirms:"[data-confirm]"},r.prototype.events={"click @ui.confirms":"confirm"},r.prototype.initialize=function(t){return this.events=_.extend({},this.events,this._buildTriggers())},r.prototype.confirm=function(t){var e;return t.preventDefault(),t.stopPropagation(),e=this.$(t.currentTarget).data("confirm"),this._triggerView(e)},r.prototype._buildTriggers=function(){var t;return t=this.view,_.reduce(this.options.triggers,function(t,e,r){var o,n;return n=function(){return _.defaults({},_.isFunction(e)?e():e,{preventDefault:!0,stopPropagation:!0})},_.isFunction(e)||(o=n()),t[r]=function(t){var r;return _.isFunction(e)&&(o=n()),t&&(t.preventDefault&&o.preventDefault&&t.preventDefault(),t.stopPropagation&&o.stopPropagation&&t.stopPropagation()),r=this._triggerView(o)},t},{})},r.prototype._triggerView=function(t){var r,o,a;return r=e("application"),a=_.pick(t,"title","message","btn_ok","btn_cancel"),o=new n({model:new Backbone.Model(a)}),this.view.$el.attr("aria-busy",!0),Mn.bindEntityEvents(this,o,{"confirm:close":function(){return this.view.$el.attr("aria-busy",!1),this.view.triggerMethod("confirm:close")},"confirm:true":function(){return this.view.triggerMethod("confirm:true"),t.event?this.view.triggerMethod(t.event):void 0}}),r.layout.showChildView("alerts",o),o},r}(Mn.Behavior)}),require.register("lib/behaviors/dialog",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.behaviors={Keyboard:{keymaps:{27:"key:escape"}}},e.prototype.ui={backdrop:"[role=separator]",content:"[role=contentinfo]"},e.prototype.triggers={"click @ui.backdrop":"click:backdrop"},e.prototype.events={"click @ui.content":"detectClickOutside"},e.prototype.initialize=function(){return this.listenTo(this.view,"click:backdrop",this.close),this.listenTo(this.view,"key:escape",this.close)},e.prototype.close=function(){return this.view.triggerMethod("dialog:close")},e.prototype.detectClickOutside=function(t){var e,r,o;if(t.pageX||t.pageY)return e=this.ui.content[0].getBoundingClientRect(),o=t.pageX<e.left||t.pageX>e.right,r=t.pageY<e.top||t.pageY>e.bottom,r&&o?this.close():void 0},e}(Mn.Behavior)}),require.register("lib/behaviors/dropdown",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.ui={trigger:"[aria-haspopup=true] > :first-child"},e.prototype.events={"click @ui.trigger":"toggleExpand",click:"closeAll"},e.prototype.toggleExpand=function(t){var e;return t.stopPropagation(),e=this.$(t.currentTarget).parent("[aria-haspopup]"),this.closeAll(e),e.attr("aria-expanded","true"!==e.attr("aria-expanded"))},e.prototype.closeAll=function(t){return this.$("[aria-haspopup=true]").not(t).attr("aria-expanded",!1)},e}(Mn.Behavior)}),require.register("lib/behaviors/form",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.behaviors={Keyboard:{keymaps:{13:{event:"form:key:enter",preventDefault:!1}}}},e.prototype.events=function(){return{"click @ui.formAdd":"addField","keyup @ui.formAutoAdd":"addField","keyup @ui.formInputs":_.debounce(this.updateFields,250),"change @ui.formInputs":"updateFields","click @ui.formClear":"clearField","click @ui.formDelete":"deleteField"}},e.prototype.triggers={"click @ui.formSubmit":"form:submit"},e.prototype.updateFields=function(t,e){var r,o;return null==e&&(e=t.currentTarget),(r={}).setValueOf(e.name,e.value),null!=(o=this.view.model)&&o.set(r,{silent:!0}),e.classList.toggle("empty",""===e.value),this.view.triggerMethod("form:field:update",e,t)},e.prototype.addField=function(t){var e,r,o;return"click"===t.type?this.view.triggerMethod("form:field:add",t.currentTarget.value):(e=this.$(t.currentTarget).parents("[data-type]"),o=e.data("type"),(r=!!e.find(".value").filter(function(){return!this.value}).length)?void 0:this.view.triggerMethod("form:field:add",o))},e.prototype.clearField=function(t){var e;return e=this.$(t.currentTarget).prev(".value"),e.val(null),this.view.triggerMethod("form:field:clear",t),this.updateFields(t,e[0])},e.prototype.deleteField=function(t){var e;return e=this.$(t.currentTarget).parents("[data-cid]").data("cid"),this.view.triggerMethod("form:field:delete",e,t)},e}(Mn.Behavior)}),require.register("lib/behaviors/index",function(t,e,r){var o;o={Confirm:e("./confirm"),Dialog:e("./dialog"),Dropdown:e("./dropdown"),Form:e("./form"),Keyboard:e("./keyboard"),Navigator:e("./navigator"),PickAvatar:e("./pickavatar")},r.exports=o}),require.register("lib/behaviors/keyboard",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},i=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};r.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults={eventName:"keydown"},e.prototype.events=function(){var t,e;if(this.options.keymaps)return e=_.mapObject(this.options.keymaps,this._buildKeyboardTrigger),(t={})[this.options.eventName]=function(t){return function(r){var o;return o=r.which.toString(),i.call(_.keys(e),o)<0?void 0:e[o].call(t,r)}}(this),t},e.prototype._buildKeyboardTrigger=function(t){var e,r,o;return r=_.isObject(t),o=_.defaults({},r?t:{},{preventDefault:!0,stopPropagation:!0}),e=r?o.event:t,function(t){return t&&(t.preventDefault&&o.preventDefault&&t.preventDefault(),t.stopPropagation&&o.stopPropagation&&t.stopPropagation()),this.view.triggerMethod(e,t)}},e}(Mn.Behavior)}),require.register("lib/behaviors/navigator",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.behaviors={Confirm:{}},r.prototype.events={"click @ui.navigate":"navigate"},r.prototype.navigate=function(t){var r;return t.preventDefault(),r=function(){var r,o;return o=t.currentTarget,r=o.dataset.next||o.getAttribute("href"),e("application").router.navigate(r,{trigger:!0})},t.currentTarget.dataset.confirm?Mn.bindEntityEvents(this,this.view,{"confirm:true":r,"confirm:close":function(){return Mn.unbindEntityEvents(this,this.view)}}):r()},r}(Mn.Behavior)}),require.register("lib/behaviors/pickavatar",function(t,e,r){var o,n=function(t,e){return function(){return t.apply(e,arguments)}},a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return this.choosePhoto_answer=n(this.choosePhoto_answer,this),this.choosePhoto=n(this.choosePhoto,this),r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.events=function(){return{"click @ui.avatar":"choosePhoto"}},r.prototype.choosePhoto=function(){var t,r,o;return t=e("application"),r={type:"pickObject",params:{objectType:"singlePhoto",isCropped:!0,proportion:1,maxWidth:10,minWidth:10}},o=108e5,t.intentManager.send("nameSpace",r,o).then(this.choosePhoto_answer,function(t){return console.error("contact : response in error : ",t)})},r.prototype.choosePhoto_answer=function(t){var e,r;return e=t.data,e.newPhotoChosen&&null!=(r=this.view.model)?r.set("avatar",e.dataUrl):void 0},r}(Mn.Behavior)}),require.register("lib/compare_contacts",function(t,e,r){var o,n,a,i,s,c,l;i=e("lib/diacritics"),n=e("lib/contact_helper"),r.exports=o={},o.isSamePerson=function(t,e){return t.fn===e.fn&&t.datapoints.some(function(t){var r;return"tel"===(r=t.name)||"adr"===r||"email"===r||"chat"===r?s(t,e):!1})},o.mayBeSamePerson=function(t,e){return a(t.n,e.n)>0},o.findSimilars=function(t){var e,r,n,a,i,s,c,l,u;for(i={},a=[],s=0,l=t.length;l>s;s++){for(e=t[s],i[e._id]=!0,n=[e],c=0,u=t.length;u>c;c++)r=t[c],r._id in i||!o.mayBeSamePerson(e,r)||(i[r._id]=!0,n.push(r));n.length>1&&a.push(n)}return a},o.mergeContacts=function(t,e){return e.datapoints.forEach(function(e){return s(e,t,!0)?void 0:t.datapoints.push(e)}),delete e.datapoints,null!=e.accounts&&(e.accounts.forEach(function(e){return n.hasAccount(t,e.type,e.name)?void 0:n.setAccount(t,e)}),delete e.accounts),t.tags=l(t.tags,e.tags),delete e.tags,null!=e.note&&""!==e.note&&null!=t.note&&""!==t.note&&(t.note+="\n"+e.note),delete e.note,t=c(t,e)},a=function(t,e){var r,o,n,a,s,c,l,u;return l=t.split(";"),a=l[0],o=l[1],r=l[2],r=l[3],r=l[4],u=e.split(";"),s=u[0],n=u[1],r=u[2],r=u[3],r=u[4],c=function(t){return t=i.asciize(t),t.toLowerCase()},a=c(a),o=c(o),s=c(s),n=c(n),""===a&&""===o||""===s&&""===n||!(a===s&&o===n||a===n&&o===s)?-1:1},s=function(t,e,r){return null==r&&(r=!1),null==t.value?!1:e.datapoints.some(function(e){var o,n,a;if(t.name===e.name&&(!r||r&&t.type===e.type)&&null!=e.value){if("tel"===t.name)return t.value.replace(/[-\s]/g,"")===e.value.replace(/[-\s]/g,"");if("adr"===t.name){for(n=!0,o=0;n&&7>o;)n=n&&t.value[o]===e.value[o]||""===t.value[o]&&null==e.value[o]||!(null!=(a=t.value)?a[o]:void 0)&&""===e.value[o],o++;return n}return t.value===e.value}return!1})},l=function(t,e){return t=t||[],e=e||[],t.concat(e.filter(function(e){return t.indexOf(e)<0}))},c=function(t,e){var r,o;for(r in e)o=e[r],null!=o&&(t[r]=o);return t}}),require.register("lib/contact_helper",function(t,e,r){var o,n,a=[].slice;r.exports=o={},o.nToFN=function(t){var e,r,o,n,a,i;return t=t||[],e=t[0],r=t[1],o=t[2],a=t[3],i=t[4],n=[a,r,o,e,i],n=n.filter(function(t){return null!=t&&""!==t}),n.join(" ")},o.fnToN=function(t){return t=t||"",["",t,"","",""]},o.fnToNLastnameNFirstname=function(t){var e,r,o,n,i,s;return t=t||"",s=t.split(" "),r=s[0],o=3<=s.length?a.call(s,1,i=s.length-1):(i=1,[]),e=s[i++],n=[e,r,o.join(" "),"",""]},n=function(t){return t=t.filter(function(t){return null!=t&&""!==t}),t.join(", ")},o.adrArrayToString=function(t){var e,r,o;return t=t||[],o=n(t.slice(0,3)),e=n(t.slice(3,7)),r=o,""!==e&&(r+="\n"+e),r},o.adrCompleteStreet=function(t){return t=t||[],n(t.slice(0,3))},o.adrStringToArray=function(t){return t=t||"",["","",t,"","","",""]},o.imgUrl2DataUrl=function(t,e){var r;return r=new Image,r.onload=function(){var t,o,n,a,i,s;return t=600,s=r.width>r.height?"height":"width",i=t/r[s],o=document.createElement("canvas"),o.height=o.width=t,n=o.getContext("2d"),n.drawImage(r,0,0,i*r.width,i*r.height),a=o.toDataURL("image/jpeg"),e(null,a)},r.src=t},o.getAccount=function(t,e,r){var o;return null==t.accounts?null:(o=t.accounts.filter(function(t){return t.type===e&&t.name===r}),o.length>0?o[0]:null)},o.setAccount=function(t,e){var r,n,a,i;if(r=o.getAccount(t,e.type,e.name),null!=r){i=[];for(n in e)a=e[n],i.push(r[n]=a);return i}return t.accounts=t.accounts||[],t.accounts.push(e)},o.deleteAccount=function(t,e){var r,o,n,a,i;for(i=t.accounts,o=n=0,a=i.length;a>n;o=++n)if(r=i[o],r.type===e.type&&r.name===e.name)return contacts.accounts.splice(o,1),!0;return!1},o.hasAccount=function(t,e,r){return null!=o.getAccount(t,e,r)},o.intrinsicRev=function(t){var e,r,n,a,i,s;for(n=["fn","n","org","title","bday","nickname","url","note"],e="",i=0,s=n.length;s>i;i++)r=n[i],r in t&&null!=t[r]&&""!==t[r]&&(e+=r,e+=": ",e+=t[r],e+=", ");return a=t.datapoints.map(function(t){var e,r;return e="name:"+t.name+", type:"+t.type+", value: ",e+="adr"===t.name?o.adrArrayToString(t.value):"tel"===t.name?null!=(r=t.value)?r.replace(/[^\d+]/g,""):void 0:t.value}),a.sort(),e+="datapoints: "+a.join(", ")}}),require.register("lib/contacts_listener",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=e("models/contact"),r.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.models={contact:o},e.prototype.events=["contact.create","contact.update","contact.delete"],e.prototype.onRemoteCreate=function(t){return this.collection.add(t,{merge:!0})},e.prototype.onRemoteUpdate=function(t){return this.collection.add(t,{merge:!0})},e.prototype.onRemoteDelete=function(t){return this.collection.remove(t)},e}(CozySocketListener)}),require.register("lib/diacritics",function(t,e,r){var o,n,a;o=/[\u0041-\u005A\u0061-\u007A]/g,a={"Á":"A","Ă":"A","Ắ":"A","Ặ":"A","Ằ":"A","Ẳ":"A","Ẵ":"A","Ǎ":"A","Â":"A","Ấ":"A","Ậ":"A","Ầ":"A","Ẩ":"A","Ẫ":"A","Ä":"A","Ǟ":"A","Ȧ":"A","Ǡ":"A","Ạ":"A","Ȁ":"A","À":"A","Ả":"A","Ȃ":"A","Ā":"A","Ą":"A","Å":"A","Ǻ":"A","Ḁ":"A","Ⱥ":"A","Ã":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ḃ":"B","Ḅ":"B","Ɓ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ć":"C","Č":"C","Ç":"C","Ḉ":"C","Ĉ":"C","Ċ":"C","Ƈ":"C","Ȼ":"C","Ď":"D","Ḑ":"D","Ḓ":"D","Ḋ":"D","Ḍ":"D","Ɗ":"D","Ḏ":"D","ǲ":"D","ǅ":"D","Đ":"D","Ƌ":"D","Ǳ":"DZ","Ǆ":"DZ","É":"E","Ĕ":"E","Ě":"E","Ȩ":"E","Ḝ":"E","Ê":"E","Ế":"E","Ệ":"E","Ề":"E","Ể":"E","Ễ":"E","Ḙ":"E","Ë":"E","Ė":"E","Ẹ":"E","Ȅ":"E","È":"E","Ẻ":"E","Ȇ":"E","Ē":"E","Ḗ":"E","Ḕ":"E","Ę":"E","Ɇ":"E","Ẽ":"E","Ḛ":"E","Ꝫ":"ET","Ḟ":"F","Ƒ":"F","Ǵ":"G","Ğ":"G","Ǧ":"G","Ģ":"G","Ĝ":"G","Ġ":"G","Ɠ":"G","Ḡ":"G","Ǥ":"G","Ḫ":"H","Ȟ":"H","Ḩ":"H","Ĥ":"H","Ⱨ":"H","Ḧ":"H","Ḣ":"H","Ḥ":"H","Ħ":"H","Í":"I","Ĭ":"I","Ǐ":"I","Î":"I","Ï":"I","Ḯ":"I","İ":"I","Ị":"I","Ȉ":"I","Ì":"I","Ỉ":"I","Ȋ":"I","Ī":"I","Į":"I","Ɨ":"I","Ĩ":"I","Ḭ":"I","Ꝺ":"D","Ꝼ":"F","Ᵹ":"G","Ꞃ":"R","Ꞅ":"S","Ꞇ":"T","Ꝭ":"IS","Ĵ":"J","Ɉ":"J","Ḱ":"K","Ǩ":"K","Ķ":"K","Ⱪ":"K","Ꝃ":"K","Ḳ":"K","Ƙ":"K","Ḵ":"K","Ꝁ":"K","Ꝅ":"K","Ĺ":"L","Ƚ":"L","Ľ":"L","Ļ":"L","Ḽ":"L","Ḷ":"L","Ḹ":"L","Ⱡ":"L","Ꝉ":"L","Ḻ":"L","Ŀ":"L","Ɫ":"L","ǈ":"L","Ł":"L","Ǉ":"LJ","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ń":"N","Ň":"N","Ņ":"N","Ṋ":"N","Ṅ":"N","Ṇ":"N","Ǹ":"N","Ɲ":"N","Ṉ":"N","Ƞ":"N","ǋ":"N","Ñ":"N","Ǌ":"NJ","Ó":"O","Ŏ":"O","Ǒ":"O","Ô":"O","Ố":"O","Ộ":"O","Ồ":"O","Ổ":"O","Ỗ":"O","Ö":"O","Ȫ":"O","Ȯ":"O","Ȱ":"O","Ọ":"O","Ő":"O","Ȍ":"O","Ò":"O","Ỏ":"O","Ơ":"O","Ớ":"O","Ợ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ȏ":"O","Ꝋ":"O","Ꝍ":"O","Ō":"O","Ṓ":"O","Ṑ":"O","Ɵ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Õ":"O","Ṍ":"O","Ṏ":"O","Ȭ":"O","Ƣ":"OI","Ꝏ":"OO","Ɛ":"E","Ɔ":"O","Ȣ":"OU","Ṕ":"P","Ṗ":"P","Ꝓ":"P","Ƥ":"P","Ꝕ":"P","Ᵽ":"P","Ꝑ":"P","Ꝙ":"Q","Ꝗ":"Q","Ŕ":"R","Ř":"R","Ŗ":"R","Ṙ":"R","Ṛ":"R","Ṝ":"R","Ȑ":"R","Ȓ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꜿ":"C","Ǝ":"E","Ś":"S","Ṥ":"S","Š":"S","Ṧ":"S","Ş":"S","Ŝ":"S","Ș":"S","Ṡ":"S","Ṣ":"S","Ṩ":"S","ẞ":"SS","Ť":"T","Ţ":"T","Ṱ":"T","Ț":"T","Ⱦ":"T","Ṫ":"T","Ṭ":"T","Ƭ":"T","Ṯ":"T","Ʈ":"T","Ŧ":"T","Ɐ":"A","Ꞁ":"L","Ɯ":"M","Ʌ":"V","Ꜩ":"TZ","Ú":"U","Ŭ":"U","Ǔ":"U","Û":"U","Ṷ":"U","Ü":"U","Ǘ":"U","Ǚ":"U","Ǜ":"U","Ǖ":"U","Ṳ":"U","Ụ":"U","Ű":"U","Ȕ":"U","Ù":"U","Ủ":"U","Ư":"U","Ứ":"U","Ự":"U","Ừ":"U","Ử":"U","Ữ":"U","Ȗ":"U","Ū":"U","Ṻ":"U","Ų":"U","Ů":"U","Ũ":"U","Ṹ":"U","Ṵ":"U","Ꝟ":"V","Ṿ":"V","Ʋ":"V","Ṽ":"V","Ꝡ":"VY","Ẃ":"W","Ŵ":"W","Ẅ":"W","Ẇ":"W","Ẉ":"W","Ẁ":"W","Ⱳ":"W","Ẍ":"X","Ẋ":"X","Ý":"Y","Ŷ":"Y","Ÿ":"Y","Ẏ":"Y","Ỵ":"Y","Ỳ":"Y","Ƴ":"Y","Ỷ":"Y","Ỿ":"Y","Ȳ":"Y","Ɏ":"Y","Ỹ":"Y","Ź":"Z","Ž":"Z","Ẑ":"Z","Ⱬ":"Z","Ż":"Z","Ẓ":"Z","Ȥ":"Z","Ẕ":"Z","Ƶ":"Z","Ĳ":"IJ","Œ":"OE","ᴀ":"A","ᴁ":"AE","ʙ":"B","ᴃ":"B","ᴄ":"C","ᴅ":"D","ᴇ":"E","ꜰ":"F","ɢ":"G","ʛ":"G","ʜ":"H","ɪ":"I","ʁ":"R","ᴊ":"J","ᴋ":"K","ʟ":"L","ᴌ":"L","ᴍ":"M","ɴ":"N","ᴏ":"O","ɶ":"OE","ᴐ":"O","ᴕ":"OU","ᴘ":"P","ʀ":"R","ᴎ":"N","ᴙ":"R","ꜱ":"S","ᴛ":"T","ⱻ":"E","ᴚ":"R","ᴜ":"U","ᴠ":"V","ᴡ":"W","ʏ":"Y","ᴢ":"Z","á":"a","ă":"a","ắ":"a","ặ":"a","ằ":"a","ẳ":"a","ẵ":"a","ǎ":"a","â":"a","ấ":"a","ậ":"a","ầ":"a","ẩ":"a","ẫ":"a","ä":"a","ǟ":"a","ȧ":"a","ǡ":"a","ạ":"a","ȁ":"a","à":"a","ả":"a","ȃ":"a","ā":"a","ą":"a","ᶏ":"a","ẚ":"a","å":"a","ǻ":"a","ḁ":"a","ⱥ":"a","ã":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ḃ":"b","ḅ":"b","ɓ":"b","ḇ":"b","ᵬ":"b","ᶀ":"b","ƀ":"b","ƃ":"b","ɵ":"o","ć":"c","č":"c","ç":"c","ḉ":"c","ĉ":"c","ɕ":"c","ċ":"c","ƈ":"c","ȼ":"c","ď":"d","ḑ":"d","ḓ":"d","ȡ":"d","ḋ":"d","ḍ":"d","ɗ":"d","ᶑ":"d","ḏ":"d","ᵭ":"d","ᶁ":"d","đ":"d","ɖ":"d","ƌ":"d","ı":"i","ȷ":"j","ɟ":"j","ʄ":"j","ǳ":"dz","ǆ":"dz","é":"e","ĕ":"e","ě":"e","ȩ":"e","ḝ":"e","ê":"e","ế":"e","ệ":"e","ề":"e","ể":"e","ễ":"e","ḙ":"e","ë":"e","ė":"e","ẹ":"e","ȅ":"e","è":"e","ẻ":"e","ȇ":"e","ē":"e","ḗ":"e","ḕ":"e","ⱸ":"e","ę":"e","ᶒ":"e","ɇ":"e","ẽ":"e","ḛ":"e","ꝫ":"et","ḟ":"f","ƒ":"f","ᵮ":"f","ᶂ":"f","ǵ":"g","ğ":"g","ǧ":"g","ģ":"g","ĝ":"g","ġ":"g","ɠ":"g","ḡ":"g","ᶃ":"g","ǥ":"g","ḫ":"h","ȟ":"h","ḩ":"h","ĥ":"h","ⱨ":"h","ḧ":"h","ḣ":"h","ḥ":"h","ɦ":"h","ẖ":"h","ħ":"h","ƕ":"hv","í":"i","ĭ":"i","ǐ":"i","î":"i","ï":"i","ḯ":"i","ị":"i","ȉ":"i","ì":"i","ỉ":"i","ȋ":"i","ī":"i","į":"i","ᶖ":"i","ɨ":"i","ĩ":"i","ḭ":"i","ꝺ":"d","ꝼ":"f","ᵹ":"g","ꞃ":"r","ꞅ":"s","ꞇ":"t","ꝭ":"is","ǰ":"j","ĵ":"j","ʝ":"j","ɉ":"j","ḱ":"k","ǩ":"k","ķ":"k","ⱪ":"k","ꝃ":"k","ḳ":"k","ƙ":"k","ḵ":"k","ᶄ":"k","ꝁ":"k","ꝅ":"k","ĺ":"l","ƚ":"l","ɬ":"l","ľ":"l","ļ":"l","ḽ":"l","ȴ":"l","ḷ":"l","ḹ":"l","ⱡ":"l","ꝉ":"l","ḻ":"l","ŀ":"l","ɫ":"l","ᶅ":"l","ɭ":"l","ł":"l","ǉ":"lj","ſ":"s","ẜ":"s","ẛ":"s","ẝ":"s","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ᵯ":"m","ᶆ":"m","ń":"n","ň":"n","ņ":"n","ṋ":"n","ȵ":"n","ṅ":"n","ṇ":"n","ǹ":"n","ɲ":"n","ṉ":"n","ƞ":"n","ᵰ":"n","ᶇ":"n","ɳ":"n","ñ":"n","ǌ":"nj","ó":"o","ŏ":"o","ǒ":"o","ô":"o","ố":"o","ộ":"o","ồ":"o","ổ":"o","ỗ":"o","ö":"o","ȫ":"o","ȯ":"o","ȱ":"o","ọ":"o","ő":"o","ȍ":"o","ò":"o","ỏ":"o","ơ":"o","ớ":"o","ợ":"o","ờ":"o","ở":"o","ỡ":"o","ȏ":"o","ꝋ":"o","ꝍ":"o","ⱺ":"o","ō":"o","ṓ":"o","ṑ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","õ":"o","ṍ":"o","ṏ":"o","ȭ":"o","ƣ":"oi","ꝏ":"oo","ɛ":"e","ᶓ":"e","ɔ":"o","ᶗ":"o","ȣ":"ou","ṕ":"p","ṗ":"p","ꝓ":"p","ƥ":"p","ᵱ":"p","ᶈ":"p","ꝕ":"p","ᵽ":"p","ꝑ":"p","ꝙ":"q","ʠ":"q","ɋ":"q","ꝗ":"q","ŕ":"r","ř":"r","ŗ":"r","ṙ":"r","ṛ":"r","ṝ":"r","ȑ":"r","ɾ":"r","ᵳ":"r","ȓ":"r","ṟ":"r","ɼ":"r","ᵲ":"r","ᶉ":"r","ɍ":"r","ɽ":"r","ↄ":"c","ꜿ":"c","ɘ":"e","ɿ":"r","ś":"s","ṥ":"s","š":"s","ṧ":"s","ş":"s","ŝ":"s","ș":"s","ṡ":"s","ṣ":"s","ṩ":"s","ʂ":"s","ᵴ":"s","ᶊ":"s","ȿ":"s","ɡ":"g","ß":"ss","ᴑ":"o","ᴓ":"o","ᴝ":"u","ť":"t","ţ":"t","ṱ":"t","ț":"t","ȶ":"t","ẗ":"t","ⱦ":"t","ṫ":"t","ṭ":"t","ƭ":"t","ṯ":"t","ᵵ":"t","ƫ":"t","ʈ":"t","ŧ":"t","ᵺ":"th","ɐ":"a","ᴂ":"ae","ǝ":"e","ᵷ":"g","ɥ":"h","ʮ":"h","ʯ":"h","ᴉ":"i","ʞ":"k","ꞁ":"l","ɯ":"m","ɰ":"m","ᴔ":"oe","ɹ":"r","ɻ":"r","ɺ":"r","ⱹ":"r","ʇ":"t","ʌ":"v","ʍ":"w","ʎ":"y","ꜩ":"tz","ú":"u","ŭ":"u","ǔ":"u","û":"u","ṷ":"u","ü":"u","ǘ":"u","ǚ":"u","ǜ":"u","ǖ":"u","ṳ":"u","ụ":"u","ű":"u","ȕ":"u","ù":"u","ủ":"u","ư":"u","ứ":"u","ự":"u","ừ":"u","ử":"u","ữ":"u","ȗ":"u","ū":"u","ṻ":"u","ų":"u","ᶙ":"u","ů":"u","ũ":"u","ṹ":"u","ṵ":"u","ᵫ":"ue","ꝸ":"um","ⱴ":"v","ꝟ":"v","ṿ":"v","ʋ":"v","ᶌ":"v","ⱱ":"v","ṽ":"v","ꝡ":"vy","ẃ":"w","ŵ":"w","ẅ":"w","ẇ":"w","ẉ":"w","ẁ":"w","ⱳ":"w","ẘ":"w","ẍ":"x","ẋ":"x","ᶍ":"x","ý":"y","ŷ":"y","ÿ":"y","ẏ":"y","ỵ":"y","ỳ":"y","ƴ":"y","ỷ":"y","ỿ":"y","ȳ":"y","ẙ":"y","ɏ":"y","ỹ":"y","ź":"z","ž":"z","ẑ":"z","ʑ":"z","ⱬ":"z","ż":"z","ẓ":"z","ȥ":"z","ẕ":"z","ᵶ":"z","ᶎ":"z","ʐ":"z","ƶ":"z","ɀ":"z","ﬀ":"ff","ﬃ":"ffi","ﬄ":"ffl","ﬁ":"fi","ﬂ":"fl","ĳ":"ij","œ":"oe","ﬆ":"st","ₐ":"a","ₑ":"e","ᵢ":"i","ⱼ":"j","ₒ":"o","ᵣ":"r","ᵤ":"u","ᵥ":"v","ₓ":"x"},n=function(t){return t.replace(/[^A-Za-z0-9\[\] ]/g,function(t){return a[t]||t})},r.exports={alphabet:o,diacritics:a,asciize:n}}),require.register("lib/i18n",function(t,e,r){var o;o=function(){var t,r,o,n;r=$("html").attr("lang");try{o=e("locales/"+r)}catch(a){t=a,o=e("locales/en")}return n=new Polyglot({phrases:o,locale:r}),n.t.bind(n)},r.exports=o()}),require.register("lib/intent_manager",function(t,e,r){var o,n;n=3e3,r.exports=o=function(){function t(){this.talker=new Talker(window.parent,"*")}return t.prototype.send=function(t,e,r){return this.talker.timeout=r?r:n,this.talker.send("nameSpace",e)},t}()}),require.register("lib/regions/dialogs",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.toggleDialogs=function(t){return null==t&&(t="true"!==this.$el.attr("aria-hidden")),this.$el.attr("aria-hidden",!t)},e.prototype.onShow=function(){return this.toggleDialogs(!0)},e.prototype.onBeforeEmpty=function(){return this.toggleDialogs(!1)},e}(Mn.Region)}),require.register("lib/tags_listener",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=e("models/tag"),r.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.models={tag:o},e.prototype.events=["tag.create","tag.update","tag.delete"],e.prototype.onRemoteCreate=function(t){return this.collection.add(t,{merge:!0})},e.prototype.onRemoteUpdate=function(t){return this.collection.add(t,{merge:!0})},e.prototype.onRemoteDelete=function(t){return this.collection.remove(t)},e}(CozySocketListener)}),require.register("lib/views/confirm",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.template=e("./templates/confirm"),r.prototype.tagName="section",r.prototype.attributes={role:"alertdialog","aria-busy":!1},r.prototype.ui={btn_ok:"button.ok",btn_cancel:"button.cancel"},r.prototype.triggers={"click @ui.btn_ok":"confirm:true","click @ui.btn_cancel":"confirm:false","click button":"confirm:close"},r.prototype.onDomRefresh=function(){return setTimeout(function(t){return function(){return t.$el.attr("aria-busy",!0)}}(this),50)},r.prototype.onConfirmClose=function(){var t;return t=e("application"),t.layout.alerts.empty()},r}(Mn.ItemView)}),require.register("lib/views/templates/base/alert",function(t,e,r){var o=function(t){var e=[];return e.push('<div class="wrapper"><div role="contentinfo"></div></div>'),e.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o);
}),require.register("lib/views/templates/base/dialog",function(t,e,r){var o=function(t){var e=[];return e.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo"></div></div>'),e.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o)}),require.register("lib/views/templates/confirm",function(t,e,r){var o=function(t){var e,r=[],o=t||{},n=o.title,a=o.message,i=o.btn_ok,s=o.btn_cancel;return r.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo"><h2>'+jade.escape(null==(e=n)?"":e)+"</h2><p>"+jade.escape(null==(e=a)?"":e)+'</p><nav><ul class="actions"><li><button class="ok">'+jade.escape(null==(e=i)?"":e)+'</button></li><li><button class="secondary cancel">'+jade.escape(null==(e=s)?"":e)+"</button></li></ul></nav></div></div>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o)}),require.register("locales/en",function(t,e,r){r.exports={"list counter":"%{smart_count} contact |||| %{smart_count} contacts","list counter no-search":"no contact matches your criteria","list counter empty":"no contact at this time","tools subactions settings":"settings","tools actions add contact":"add contact","tools actions find duplicates":"find duplicates","tools search placeholder":"search for contacts","tools labels filters":"labels","tools labels filters all":"all contacts","tools contextual selected":"%{smart_count} contact selected |||| %{smart_count} contacts selected","tools contextual select all":"select all","tools contextual select none":"select none","tools contextual merge":"merge","tools contextual export":"export","tools contextual delete":"delete","bulk confirm delete title":"Delete contact |||| Delete contacts","bulk confirm delete message":"You'll delete a contact. Are you sure? |||| You'll delete %{smart_count} contacts. Are you sure?","bulk confirm delete ok":"delete","bulk confirm delete cancel":"keep 'em safe","settings title":"settings","settings in-out title":"import/export contacts","settings in-out import action":"import vcard","settings in-out export action":"export vcard","settings in-out import result":"You've just successfully imported %{smart_count} contact. |||| You've just successfully imported %{smart_count} contacts.","settings display title":"display settings","settings display sort gn":"sort by last name","settings display sort fn":"sort by first name","settings sync title":"mobile synchronization","settings sync gplay":"Access all your Cozy directly on your mobile device. Download our app now on the Google Play Store:","settings sync gplay get it":"Get it on Google play","settings sync carddav":"Looking for more information about the synchronization using CardDav? Take a look at [our documentation](%{link}).","card actions create":"create","card actions save":"save","card actions labels":"labels","card actions labels add":"add label","card actions labels create":"create label","card actions cancel":"cancel","card actions edit":"edit","card actions delete":"delete","card actions export":"export","card actions add select":"add field","card actions add birthday":"birthday","card actions add social":"social media","card actions add link":"url","card actions add other":"other information","card confirm delete title":"Remove %{name}?","card confirm delete message":"You'll remove %{name} from your contacts. Are you sure?","card confirm delete ok":"Delete Contact","card confirm delete cancel":"Keep it","card confirm cancel title":"Are you sure you want to leave?","card confirm cancel message":"Your contact hasn't been saved.","card confirm cancel ok":"Leave","card confirm cancel cancel":"Stay on Edit Mode","datapoint label name prefix":"prefix","datapoint label name first":"first name","datapoint label name middle":"middle name","datapoint label name given":"last name","datapoint label name suffix":"suffix","datapoint label org":"company","datapoint placeholder org":"add company name","datapoint label department":"department","datapoint placeholder department":"add department","datapoint label title":"title","datapoint placeholder title":"add title","datapoint placeholder tel":"add phone number","datapoint placeholder email":"add email address","datapoint placeholder adr":"add address","datapoint placeholder social":"add social media nickname","datapoint placeholder im":"add social media nickname","datapoint placeholder chat":"add social media nickname","datapoint placeholder url":"add an url","datapoint placeholder other":"add any information","datapoint label bday":"birthday","datapoint placeholder bday":"YYYY-MM-DD","datapoint label note":"notes","duplicates title":"Find Duplicates","duplicates actions mergeall":"merge all","duplicates empty":"No duplicates found","mergerow actions merge":"merge","mergerow actions dismiss":"dismiss","merge title":"Merge contacts","merge choose avatar":"Choose a profile picture:","merge choose name":"Choose a name:","merge choose nickname":"Choose a nickname:","merge choose organisation":"Choose an organisation:","merge choose org":"company","merge choose department":"department","merge choose title":"title","merge choose birthday":"Choose a birthday:","merge actions merge":"merge contacts","merge actions cancel":"cancel","error upload wrong filetype":"The uploaded file isn't a valid VCF/VCard format. Please try with another file."}}),require.register("locales/fr",function(t,e,r){r.exports={"list counter":"%{smart_count} contact |||| %{smart_count} contacts","list counter no-search":"aucun contact ne correspond à votre recherche","list counter empty":"aucun contact disponible","tools subactions settings":"configuration","tools actions add contact":"ajouter un contact","tools actions find duplicates":"doublons","tools search placeholder":"rechercher des contacts","tools labels filters":"libellés","tools labels filters all":"tous les contacts","tools contextual selected":"%{smart_count} contact sélectionné |||| %{smart_count} contacts sélectionnés","tools contextual select all":"tout sélectionner","tools contextual select none":"tout déslectionner","tools contextual merge":"fusionner","tools contextual export":"exporter","tools contextual delete":"supprimer","bulk confirm delete title":"Supprimer le contact |||| Supprimer les contacts","bulk confirm delete message":"Vous allez supprimer un contact. Êtes-vous sûr ? |||| Vous aller supprimer %{smart_count} contacts. Êtes vous sûr ?","bulk confirm delete ok":"Supprimer","bulk confirm delete cancel":"Conserver","settings title":"configuration","settings in-out title":"importer / exporter les contacts","settings in-out import action":"importer un fichier vcard","settings in-out export action":"exporter vos contacts","settings in-out import result":"Vous avez importé %{smart_count} contact. |||| Vous avez importé %{smart_count} contacts.","settings display title":"affichage","settings display sort gn":"trier sur le nom","settings display sort fn":"trier sur le prénom","settings sync title":"synchronisation mobile","settings sync gplay":"Accédez à votre Cozy depuis votre mobile. Télécharger notre application sur le Google Play Store:","settings sync gplay get it":"Disponible sur Google play","settings sync carddav":"Besoin de synchronisation CardDav? Jetez un œil à [notre documentation](%{link}).","card actions create":"créer","card actions save":"enregistrer","card actions labels":"libellés","card actions labels add":"ajouter un libellé","card actions labels create":"créer un libellé","card actions cancel":"annuler","card actions edit":"éditer","card actions delete":"supprimer","card actions export":"exporter","card actions add select":"ajouter un champ","card actions add birthday":"date de naissance","card actions add social":"réseau social","card actions add link":"lien","card actions add other":"autre","card confirm delete title":"Supprimer %{name} ?","card confirm delete message":"Vous allez supprimer %{name} de vos contacts. Êtes-vous sûr ?","card confirm delete ok":"Le Supprimer","card confirm delete cancel":"Le garder","card confirm cancel title":"Voulez-vous vraiment quitter l'édition ?","card confirm cancel message":"Vos modifications n'ont pas été sauvées.","card confirm cancel ok":"Quitter","card confirm cancel cancel":"Rester","datapoint label name prefix":"civilité","datapoint label name first":"prénom","datapoint label name middle":"surnom","datapoint label name given":"nom","datapoint label name suffix":"particule","datapoint label org":"société","datapoint placeholder org":"ajouter une société","datapoint label department":"département","datapoint placeholder department":"ajouter un department","datapoint label title":"poste","datapoint placeholder title":"ajouter un poste","datapoint placeholder tel":"ajouter un numéro de téléphone","datapoint placeholder email":"ajouter une adresse email","datapoint placeholder adr":"ajouter une adresse","datapoint placeholder social":"ajouter un nom d'utilisateur","datapoint placeholder im":"ajouter un nom d'utilisateur","datapoint placeholder chat":"ajouter un nom d'utilisateur","datapoint placeholder url":"ajouter une url","datapoint placeholder other":"ajouter une information","datapoint label bday":"anniversaire","datapoint placeholder bday":"YYYY-MM-DD","datapoint label note":"notes","duplicates title":"Doublons","duplicates actions mergeall":"tout fusionner","duplicates empty":"Aucun doublon détecté","mergerow actions merge":"fusionner","mergerow actions dismiss":"abandonner","merge title":"Fusionner les contacts","merge choose avatar":"Choisissez une photo de profil :","merge choose name":"Choisissez un nom :","merge choose nickname":"Choisissez un surnom :","merge choose organisation":"Choisissez une organisation:","merge choose org":"société","merge choose department":"département","merge choose title":"poste","merge choose birthday":"Choisissez un anniversaire :","merge actions merge":"fusionner","merge actions cancel":"annuler","error upload wrong filetype":"Le fichier sélectioné n'est pas un format VCard/VCF valide. Essayez avec un autre fichier."}}),require.register("models/config",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.url="config",e}(Backbone.Model)}),require.register("models/contact",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.defaults={name:"other",type:"other",value:""},e}(Backbone.Model),r.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.urlRoot="contacts",e.prototype.defaults={n:";;;;"},e.prototype.parse=function(t){var e,r,o,a;for(r in t)a=t[r],""===a&&delete t[r];return(o=t.url)&&(delete t.url,t.datapoints.unshift({name:"url",type:"main",value:o})),e=this.attributes.datapoints||new Backbone.Collection(t.datapoints||[],{model:n}),e.comparator="name",t.datapoints=e,t.tags=_.invoke(t.tags,"toLowerCase"),t},e.prototype.sync=function(t,r,o){var n,a,i,s,c;return n=r.get("avatar")||r.get("photo"),n&&(r.unset("avatar",{silent:!0}),r.unset("photo",{silent:!0}),s=o.success,o.success=function(t){return function(e,r,a){return t.savePicture(n,e,{success:function(){return s.apply(t,arguments),t.fetch()},error:o.error})}}(this)),o.attrs=r.toJSON(),a=(null!=(c=r.attributes.datapoints)?c.toJSON():void 0)||[],i=_.findWhere(a,{name:"url"}),i&&(o.attrs.datapoints=_.without(a,i),o.attrs.url=i.value),e.__super__.sync.apply(this,arguments)},e.prototype.toString=function(t){var e,r,o,n;return null==t&&(t={}),n=o=this.attributes.n.split(";"),r=n[0],e=n[1],r=_.compact([t.pre,r,t.post]).join(""),o[0]=e,o[1]=r,_.compact(o).join(" ")},e.prototype.match=function(t,e){var r,o;return null==e&&(e={}),r=e.format?{pre:"»",post:"«"}:void 0,o=fuzzy.match(t,this.toString(r),e),o&&r&&(o.rendered=o.rendered.replace("»",e.format.pre).replace("«",e.format.post)),o},e.prototype.toJSON=function(){var t;return _.extend({},e.__super__.toJSON.apply(this,arguments),{datapoints:(null!=(t=this.attributes.datapoints)?t.toJSON():void 0)||[]})},e.prototype.savePicture=function(t,e,r){var o,n,a,i,s,c,l;if(!e.id)return r.error(new Error("Model should have been saved once."));for(n=atob(t),o=[],s=c=0,l=n.length;l>=0?l>=c:c>=l;s=l>=0?++c:--c)o.push(n.charCodeAt(s));return a=new Blob([new Uint8Array(o)],{type:"image/jpeg"}),i=new FormData,i.append("picture",a),i.append("contact",e),$.ajax({type:"PUT",url:"contacts/"+e.id+"/picture",data:i,contentType:!1,processData:!1,success:r.success,error:r.error})},e.prototype.picturetoa=function(t){var e,r;return(null!=(r=this.attributes._attachments)?r.picture:void 0)?(e=new Image,e.onload=function(){var e,r,o,n;return r=document.createElement("canvas"),r.width=this.naturalWidth,r.height=this.naturalHeight,o=r.getContext("2d"),o.drawImage(this,0,0),n=r.toDataURL("image/jpeg").split(","),e=n[n.length-1],t(e)},e.src="contacts/"+this.id+"/picture.png"):t()},e.prototype.toVCF=function(t){var e;return e=this.toJSON(),this.picturetoa(function(r){return _.delay(t,0,VCardParser.toVCF(e,r))})},e}(Backbone.Model)}),require.register("models/tag",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.urlRoot="tags",e.prototype.parse=function(t){return t.name=t.name.toLowerCase(),t},e}(Backbone.Model)}),require.register("routes/contacts",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.routes={"new":"create",duplicates:"duplicates",":slug":"show",":slug/edit":"edit","":"index"},r.prototype._ensureContacts=function(t){var r;if(_.isFunction(t))return r=e("application"),r.contacts.isEmpty()?this.listenToOnce(r.contacts,"sync",t):t()},r.prototype._setCardState=function(t,r){var o,n;return o=e("application"),n=o.contacts.get(t)||"new"===t?t:!1,o.model.set("dialog",n),o.trigger("mode:edit",r)},r.prototype.index=function(){var t;return t=e("application"),t.search("tag",null)},r.prototype.show=function(t){return this._ensureContacts(_.wrap(this._setCardState,function(e){return e(t)}))},r.prototype.edit=function(t){return this._ensureContacts(_.wrap(this._setCardState,function(e){return e(t,!0)}))},r.prototype.create=function(){return this._setCardState("new",!0)},r.prototype.duplicates=function(){var t;return t=e("application"),this._ensureContacts(function(){return t.model.set("dialog","duplicates")})},r}(Backbone.SubRoute)}),require.register("routes/index",function(t,e,r){var o,n,a,i={}.hasOwnProperty,s=function(t,e){function r(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=e("routes/contacts"),a=e("routes/tags"),r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.routes={settings:"settings","contact/:slug":"legacyContactRedirect","":"index"},r.prototype.initialize=function(){var t;return t=e("application"),t.on("start",function(){var t,e;return t=new o("contacts"),e=new a("tags")}),this.listenTo(t.model,"change:dialog",function(e,r){var o,n,a;if(!r)return o=null!=(a=t.model.get("filter"))?a.match(/tag:(\w+)/i):void 0,n=o?"tags/"+o[1]:"contacts",this.navigate(n)})},r.prototype.index=function(){return this.navigate("contacts",{trigger:!0})},r.prototype.settings=function(){var t;return t=e("application"),t.model.set("dialog","settings")},r.prototype.legacyContactRedirect=function(t){return this.navigate("contacts/"+t,{trigger:!0})},r}(Backbone.Router)}),require.register("routes/tags",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.routes={":slug":"filter"},r.prototype.filter=function(t){var r;return r=e("application"),r.search("tag",t)},r}(Backbone.SubRoute)}),require.register("views/app_layout",function(t,e,r){var o,n,a,i,s,c,l,u,p,d,f,h={}.hasOwnProperty,m=function(t,e){function r(){this.constructor=t}for(var o in e)h.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};a=e("models/contact"),i=e("views/models/contact"),l=e("views/tools/default_actions"),c=e("views/tools/context_actions"),p=e("views/labels"),f=e("views/tools/toolbar"),s=e("views/contacts"),n=e("views/contacts/card"),u=e("views/duplicates"),d=e("views/settings"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return m(r,t),r.prototype.template=e("views/templates/layouts/app"),r.prototype.el="[role=application]",r.prototype.behaviors={Navigator:{},Keyboard:{keymaps:{33:"key:pageup",34:"key:pagedown"}}},r.prototype.ui={navigate:"aside [role=button]"},r.prototype.regions={actions:"aside .tool-actions",labels:"aside .tool-labels",content:"main [role=contentinfo]",toolbar:"main [role=toolbar]",dialogs:{selector:".dialogs",regionClass:e("lib/regions/dialogs")},alerts:{selector:".alerts",regionClass:e("lib/regions/dialogs")}},r.prototype.modelEvents={"change:dialog":"showDialog","change:selected":"swapContextualMenu"},r.prototype.childEvents={"drawer:toggle":"toggleDrawer","contacts:select":function(t,e){return this.model.select(e)},"contacts:unselect":function(t,e){return this.model.unselect(e)},"dialog:close":function(){return this.model.set("dialog",!1)}},r.prototype.initialize=function(){var t;return t=e("application"),this.listenToOnce(t.contacts,"sync",function(){return this.showContactsList(),this.disableBusyState()}),this.listenToOnce(t.tags,"sync",function(){return this.showFilters()})},r.prototype.onRender=function(){return this.showChildView("toolbar",new f),this.showChildView("actions",new l)},r.prototype.disableBusyState=function(){return this.$el.attr("aria-busy",!1)},r.prototype.showFilters=function(){return this.showChildView("labels",new p({model:this.model}))},r.prototype.showContactsList=function(){return this.showChildView("content",new s)},r.prototype.showDialog=function(t,e){var r;return e?(r=function(){switch(e){case"settings":return new d({model:this.model});case"duplicates":return new u;default:return this._buildContactView(e)}}.call(this),this.showChildView("dialogs",r)):(this.dialogs.empty(),this.content.currentView.$el.focus())},r.prototype._buildContactView=function(t){var r,o,s;return r=e("application"),o="new"===t?new a(null,{parse:!0}):r.contacts.get(t),s=new i({"new":"new"===t},{model:o}),r.on("mode:edit",function(t){return s.set("edit",t)}),new n({model:s})},r.prototype.toggleDrawer=function(){var t,e;return t=this.$("aside.drawer"),e="true"===t.attr("aria-expanded"),t.attr("aria-expanded",!e)},r.prototype.swapContextualMenu=function(t,e){var r;return r=t._previousAttributes.selected,r.length&&e.length?void 0:_.isEmpty(e)?this.showChildView("actions",new l):this.showChildView("actions",new c({model:this.model}))},r}(Mn.LayoutView)}),require.register("views/contacts/card",function(t,e,r){var o,n,a,i,s,c,l=function(t,e){return function(){return t.apply(e,arguments)}},u={}.hasOwnProperty,p=function(t,e){function r(){this.constructor=t}for(var o in e)u.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=e("views/contacts/components/avatar"),i=e("views/contacts/components/data"),s=e("views/contacts/components/edit_tags"),c=e("lib/i18n"),n=e("config").contact,r.exports=a=function(t){function r(){return this._deleteModalCfg=l(this._deleteModalCfg,this),r.__super__.constructor.apply(this,arguments)}return p(r,t),r.prototype.template=e("views/templates/contacts/card"),r.prototype.tagName="section",r.prototype.className="card",r.prototype.attributes={role:"dialog"},r.prototype.behaviors=function(){return{Navigator:{},Dialog:{},Form:{},Dropdown:{},Confirm:{triggers:{"click @ui.btnDelete":this._deleteModalCfg}}}},r.prototype.ui={btnEdit:".edit[role=button]",btnDelete:"button.delete",btnExport:'[formaction="contact/export"]',navigate:"[href^=contacts], [data-next]",formSubmit:"[type=submit]",formClear:"button.clear",formInputs:".group:not([data-cid]) :input:not(button)",avatar:".avatar"},r.prototype.regions={avatar:"[role=img]",data:".data",tags:"aside .tags"},r.prototype.triggers={"click @ui.btnExport":"export"},r.prototype.modelEvents={"change:edit":"render",save:"onSave",destroy:function(){return this.triggerMethod("dialog:close")}},r.prototype.childEvents={"form:key:enter":"onFormKeyEnter"},r.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},r.prototype.serializeData=function(){return _.extend({},r.__super__.serializeData.apply(this,arguments),{lists:n.datapoints.types})},r.prototype._deleteModalCfg=function(){var t,e;return e={name:this.model.get("fn")},t={event:"delete",title:c("card confirm delete title",e),message:c("card confirm delete message",e),btn_ok:c("card confirm delete ok"),btn_cancel:c("card confirm delete cancel")}},r.prototype.onRender=function(){return this.showChildView("avatar",new o({model:this.model})),this.showChildView("data",new i({model:this.model})),this.showChildView("tags",new s({model:this.model})),this.$("[role=contentinfo]").toggleClass("edit",!!this.model.get("edit"))},r.prototype.onDomRefresh=function(){return this.model.get("edit")?void 0:this.ui.btnEdit.focus()},r.prototype.onSave=function(){var t,r;if(this.model.get("new"))return t=e("application"),r="contacts/"+this.model.get("id"),t.router.navigate(r,{trigger:!0})},r.prototype.onEditCancel=function(){return this.model.get("new")?this.triggerMethod("dialog:close"):void 0},r.prototype.onFormKeyEnter=function(){var t;return t=this.$(".data.edit").find("input:not([type=hidden]), textarea"),"textarea"!==document.activeElement.tagName.toLowerCase()?t.eq(t.index(document.activeElement)+1).focus():void 0},r}(Mn.LayoutView)}),require.register("views/contacts/components/avatar",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.template=e("views/templates/contacts/components/avatar"),r.prototype.behaviors={PickAvatar:{}},r.prototype.ui=function(){return this.options.model.get("edit")?{avatar:".avatar"}:void 0},r.prototype.modelEvents={"change:initials":"updateInitials","change:avatar":"render"},r.prototype.getInitialsColor=function(){return ColorHash.getColor(this.model.get("n"),"cozy")},r.prototype.serializeData=function(){return _.extend({},r.__super__.serializeData.apply(this,arguments),{bg:this.getInitialsColor()})},r.prototype.updateInitials=function(t,e){return this.$(".initials").text(e).css("background-color",this.getInitialsColor())},r}(Mn.ItemView)}),require.register("views/contacts/components/data",function(t,e,r){var o,n,a,i,s,c={}.hasOwnProperty,l=function(t,e){function r(){this.constructor=t}for(var o in e)c.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},u=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};a=e("views/contacts/components/datapoints"),s=e("views/contacts/components/xtras"),i=e("views/contacts/components/edit_actions"),o=e("config").contact,r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return l(r,t),r.prototype.template=e("views/templates/contacts/components/data"),r.prototype.behaviors={Form:{}},r.prototype.ui={formAdd:".actions button"},r.prototype.modelEvents={change:function(){return this.model.get("edit")?void 0:this.render()}},r.prototype.childEvents={"form:key:enter":function(){return this.triggerMethod("form:key:enter")}},r.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},r.prototype.serializeData=function(){return _.extend({},r.__super__.serializeData.apply(this,arguments),{fullname:this.model.toString({pre:"<b>",post:"</b>"})})},r.prototype._renderDatapoints=function(){return this.$(".datapoints").each(function(t){return function(e,r){var o;return o=r.dataset.type,t.addRegion(o,"[data-type="+o+"]"),t.showChildView(o,new a({collection:t.model.getDatapoints(o),name:o,cardViewModel:t.model}))}}(this)),this.addRegion("xtras-infos","[data-type=xtras-infos]"),this.showChildView("xtras-infos",new s({model:this.model}))},r.prototype._renderEditActions=function(){return this.addRegion("actions",".actions"),this.showChildView("actions",new i({model:this.model}))},r.prototype.onRender=function(){return this._renderDatapoints(),this.model.get("edit")?this._renderEditActions():void 0},r.prototype.onDomRefresh=function(){return this.model.get("edit")?this.$(":input:not(button):not([type=hidden])").eq(1).focus():void 0},r.prototype.onFormFieldAdd=function(t){var e;return e=this.getRegion("xtras").currentView,u.call(o.xtras,t)<0?e.addEmptyField(t):void 0},r}(Mn.LayoutView)}),require.register("views/contacts/components/datapoint",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=e("config").contact,r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.tagName=function(){return this.options.cardViewModel.get("edit")?"div":"li"},r.prototype.className="group",r.prototype.attributes=function(){return{"data-cid":this.model.cid}},r.prototype.template=e("views/templates/contacts/components/datapoint"),r.prototype.ui={type:"input.type"},r.prototype.events=function(){return"xtras"===this.options.name?{"keyup @ui.type":_.debounce(this.updateType,250),"change @ui.type":this.updateType}:void 0},r.prototype.serializeData=function(){var t,e;return t=r.__super__.serializeData.apply(this,arguments),e=function(){switch(t.name){case"social":case"chat":return"social";case"url":return"url";default:return"default"}}(),null==t.type&&(t.type=o.datapoints.types[e][0].split(":")[0]),{edit:this.options.cardViewModel.get("edit"),ref:this.options.cardViewModel.get("ref"),name:this.options.name,index:this.options.index,entity:e,point:t}},r.prototype.updateType=function(t){var e,r,n;return r=this.model.get("name"),"url"!==r?(e=_.find(o.datapoints.types.social,function(e){return e.match(new RegExp("^"+t.currentTarget.value.toLowerCase()))}),e?(n=e.split(":"),r=n[n.length-1]):r="other",this.$(t.currentTarget).siblings(".name").val(r)):void 0},r}(Mn.ItemView)}),require.register("views/contacts/components/datapoints",function(t,e,r){var o,n,a,i={}.hasOwnProperty,s=function(t,e){function r(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},c=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};n=e("views/contacts/components/datapoint"),o=e("config").contact,r.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.tagName=function(){return this.options.cardViewModel.get("edit")?"fieldset":"ul"},e.prototype.behaviors={Form:{}},e.prototype.ui=function(){var t;return t={formInputs:":input:not(button)",formDelete:"button.delete"},"xtras"!==this.options.name&&(t.formAutoAdd=".value"),t},e.prototype.childView=n,e.prototype.childViewOptions=function(t,e){return _.extend(_.pick(this.options,"name","cardViewModel"),{index:e})},e.prototype.initialize=function(){return this.options.cardViewModel.get("edit")?this._initializeEditMode():void 0},e.prototype._initializeEditMode=function(){return"xtras"!==this.options.name?this.addEmptyField():void 0},e.prototype.onFormFieldAdd=function(t){return this.addEmptyField(t)},e.prototype.onFormFieldUpdate=function(t){var e,r,o;return e=this.$(t).parents("[data-cid]"),o=this.collection.get(e.data("cid")),r=_.reduce(e.find(":input").serializeArray(),function(t,e){return t[_.last(e.name.split("."))]=e.value,t},{}),o.set(r)},e.prototype.onFormFieldDelete=function(t){return this.collection.remove(t)},e.prototype.getDatapoints=function(){return this.collection.filter(function(t){return!_.isEmpty(t.get("value"))})},e.prototype.addEmptyField=function(t){var e;return e=this.collection.add({type:void 0,value:"",name:t||this.options.name}),c.call(o.datapoints.main,t)>=0?void 0:this.$("[data-cid="+e.cid+"] input.value").focus()},e}(Mn.CollectionView)}),require.register("views/contacts/components/edit_actions",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.tagName="dl",r.prototype.attributes={"aria-haspopup":!0,"aria-expanded":!1,"data-position":"top left"},r.prototype.template=e("views/templates/contacts/components/add_field_dropdown"),r.prototype.modelEvents={"change:bday":"render"},r}(Mn.ItemView)}),require.register("views/contacts/components/edit_tags",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};n=e("views/contacts/components/tag"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.tagName="dl",r.prototype.attributes={"aria-haspopup":!0,"aria-expanded":!1,"data-position":"bottom right"},r.prototype.template=e("views/templates/contacts/components/edit_tags"),r.prototype.childView=n,r.prototype.childViewOptions=function(t){return{contactViewModel:this.model}},r.prototype.childViewContainer="ul",r.prototype.ui={tags:"li:not(.create) :input",create:".create",dropdown:"dd"},r.prototype.events={"change @ui.tags":"onClickTag","click @ui.dropdown":function(t){return t.stopPropagation()},"click @ui.create button":"toggleCreate","keydown @ui.create [name=name]":"addNewTag"},r.prototype.modelEvents={"change:tags":function(t){return this.toggleCreate(!1),this.children.invoke("render")}},r.prototype.initialize=function(){var t;return t=e("application"),this.collection=t.tags,Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},r.prototype.onClickTag=function(t){var r,o;return r=e("application"),o=this.$("li:not(.create) :input").serializeArray().map(function(t){return r.tags.get(t.value).get("name")}),this.triggerMethod("tags:update",o)},r.prototype.toggleCreate=function(t){return(_.isNull(t)||!_.isBoolean(t))&&(t="true"!==this.ui.create.attr("aria-expanded")),this.ui.create.attr("aria-expanded",t),this.ui.create.find("[name=name]").val(""),t?this.ui.create.find("input[name=name]").focus():void 0},r.prototype.addNewTag=function(t){
var e;return t.stopPropagation(),e=t.currentTarget.value,13!==t.which||_.isEmpty(e)?void 0:this.triggerMethod("tags:add",e)},r}(Mn.CompositeView)}),require.register("views/contacts/components/tag",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.tagName="li",r.prototype.template=e("views/templates/contacts/components/tag"),r.prototype.serializeData=function(){var t;return t=this.options.contactViewModel.get("tags"),_.extend({},r.__super__.serializeData.apply(this,arguments),{selected:_.contains(t,this.model.get("name"))})},r}(Mn.ItemView)}),require.register("views/contacts/components/xtras",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},s=[].slice;o=e("config").contact,r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.tagName=function(){return this.model.get("edit")?"fieldset":"ul"},r.prototype.template=e("views/templates/contacts/components/xtras"),r.prototype.modelEvents=function(){return _.reduce(o.xtras,function(t,e){return t["change:"+e]=function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],this.render.apply(this,t),this.setFocus.apply(this,t)},t},{})},r.prototype.serializeData=function(){return{edit:this.model.get("edit"),ref:this.model.get("ref"),xtras:_.reduce(o.xtras,function(t){return function(e,r){return t.model.has(r)&&(e[r]=t.model.get(r)),e}}(this),{})}},r.prototype.setFocus=function(t){var e,r;return r=this.model.get("ref"),e=_.keys(t.changed)[0],this.$("#"+e+"-"+r).focus()},r}(Mn.ItemView)}),require.register("views/contacts/group",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=e("views/models/contact"),r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.template=e("views/templates/contacts/group"),r.prototype.tagName="dl",r.prototype.attributes={role:"rowgroup"},r.prototype.className=function(){return this.model.get("isEmpty")?"empty":void 0},r.prototype.childViewContainer="ul",r.prototype.childView=e("views/contacts/row"),r.prototype.childViewOptions=function(t){return{model:new o({},{model:t})}},r.prototype.modelEvents={"change:isEmpty":"toggleEmpty"},r.prototype.collectionEvents={update:function(){return _.defer(this.render)}},r.prototype.toggleEmpty=function(){return this.$el.toggleClass("empty",this.model.get("isEmpty"))},r}(Mn.CompositeView)}),require.register("views/contacts/index",function(t,e,r){var o,n,a,i,s,c=function(t,e){return function(){return t.apply(e,arguments)}},l={}.hasOwnProperty,u=function(t,e){function r(){this.constructor=t}for(var o in e)l.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};a=e("views/models/group"),i=e("collections/search"),o=e("collections/charindex"),s=e("lib/i18n"),r.exports=n=function(t){function r(){return this.updateCounterLabel=c(this.updateCounterLabel,this),r.__super__.constructor.apply(this,arguments)}return u(r,t),r.prototype.template=function(){},r.prototype.attributes={role:"grid",tabindex:0},r.prototype.childView=e("views/contacts/group"),r.prototype.childViewOptions=function(t){return{collection:t.compositeCollection}},r.prototype.ui={navigate:".name"},r.prototype.behaviors={Navigator:{},Dropdown:{}},r.prototype.events={"change [type=checkbox]":"updateBulkSelection"},r.prototype.initialize=function(){var t,r,n,s,c,l;for(t=e("application"),n="#abcdefghijklmnopqrstuvwxyz",this.collection=new Backbone.Collection,this.search=new i(t.contacts),this.search.on("reset update",this.updateCounterLabel),l=[],s=0,c=n.length;c>s;s++)r=n[s],l.push(function(t){return function(e){var r,n;return r={name:e},n=new o(t.search,{"char":e}),t.collection.add(new a(r,{compositeCollection:n}))}}(this)(r));return l},r.prototype._counterLabel=function(){return this.search.length?s("list counter",{smart_count:this.search.length}):s(this.search.search?"list counter no-search":"list counter empty")},r.prototype.updateCounterLabel=function(){return this.$(".counter").text(this._counterLabel()).toggleClass("important",this.search.isEmpty())},r.prototype.onRenderCollection=function(){return $("<div/>",{"class":"counter"}).appendTo(this.$el),this.updateCounterLabel()},r.prototype.onShow=function(){var t;return t=e("application"),this.listenTo(t.layout,{"key:pageup":this.scroll.bind(this,!1),"key:pagedown":this.scroll.bind(this,!0)})},r.prototype.scroll=function(t){var e,r;return e=t?1:-1,r=this._parent.$el.scrollTop()+this._parent.$el.innerHeight()*e,this._parent.$el.scrollTop(r),this.$el.focus()},r.prototype.updateBulkSelection=function(t){var e,r,o;return o=t.currentTarget.checked,e=t.currentTarget.value,r=o?"contacts:select":"contacts:unselect",this.triggerMethod(r,e)},r}(Mn.CollectionView)}),require.register("views/contacts/merge",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};n=e("lib/i18n"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.template=e("views/templates/contacts/merge"),r.prototype.tagName="section",r.prototype.className="merge",r.prototype.attributes={role:"alertdialog"},r.prototype.behaviors={Dialog:{},Form:{}},r.prototype.ui={formSubmit:"[type=submit]",formInputs:"input",cancel:".cancel"},r.prototype.modelEvents={"contacts:merge":"onClose"},r.prototype.events={"click @ui.cancel":"onCancel"},r.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},r.prototype.serializeData=function(){return{model:this.model.toJSON()}},r.prototype.onDomRefresh=function(){return _.defer(function(t){return function(){return t.$el.attr("aria-busy",!0)}}(this))},r.prototype.onFormSubmit=function(){return this.model.merge(),this.onClose()},r.prototype.onCancel=function(){return this.model.trigger("contacts:merge",this.model,"abort")},r.prototype.onClose=function(){return e("application").layout.alerts.empty()},r}(Mn.ItemView)}),require.register("views/contacts/row",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},s=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};n=e("config").search.pattern("text"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.template=e("views/templates/contacts/row"),r.prototype.tagName="li",r.prototype.attributes={role:"row"},r.prototype.modelEvents={change:"render",sync:"render"},r.prototype.initialize=function(){var t;return t=e("application"),this.listenTo(t.model,"change:selected",this.refreshChecked)},r.prototype.serializeData=function(){var t,o,a,i,c,l,u;return t=e("application"),o=null!=(l=t.model.get("filter"))?l.match(n):void 0,a={pre:"<b>",post:"</b>"},o?(c=this.model.match(o[1],{pre:'<span class="search">',post:"</span>",format:a}),i=c.rendered):i=this.model.toString(a),_.extend({},r.__super__.serializeData.call(this),{fullname:i,selected:(u=this.model.id,s.call(t.model.get("selected"),u)>=0)})},r.prototype.refreshChecked=function(t,e){var r;return this.$("[type=checkbox]").prop("checked",(r=this.model.id,s.call(e,r)>=0))},r}(Mn.ItemView)}),require.register("views/duplicates/index",function(t,e,r){var o,n,a,i,s={}.hasOwnProperty,c=function(t,e){function r(){this.constructor=t}for(var o in e)s.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};n=e("collections/duplicates"),i=e("lib/i18n"),o=e("config").contact,r.exports=a=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return c(r,t),r.prototype.template=e("views/templates/duplicates"),r.prototype.tagName="section",r.prototype.className="duplicates",r.prototype.attributes={role:"dialog"},r.prototype.childViewContainer="[role=grid]",r.prototype.childView=e("views/duplicates/row"),r.prototype.templateHelpers=function(){return{size:this.toMerge.size()}},r.prototype.behaviors={Dialog:{}},r.prototype.ui={mergeAll:".mergeall"},r.prototype.events={"click @ui.mergeAll":"mergeAll"},r.prototype.collectionEvents={"contacts:merge":"render"},r.prototype.initialize=function(){var t;return t=e("application"),this.collection=new n(null,{collection:t.contacts}),this.toMerge=new BackboneProjections.Filtered(this.collection,{filter:function(t){return t.isMergeable()}}),this.bindEntityEvents(this.collection,this.getOption("collectionEvents"))},r.prototype.mergeAll=function(){return this.$("button,input").prop("disabled",!0),_.defer(function(t){return function(){return t.ui.mergeAll.attr("aria-busy",!0)}}(this)),async.eachSeries(this.toMerge.toArray(),function(t){return function(e,r){return t.listenTo(e,"contacts:merge",function(t,e){return _.defer(r,e)}),t.children.findByModel(e).merge()}}(this),function(t){return function(e){return t.$("button,input").removeAttr("disabled"),t.ui.mergeAll.attr("aria-busy","false"),e?console.error(e):void 0}}(this))},r}(Mn.CompositeView)}),require.register("views/duplicates/row",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},s=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};o=e("views/models/contact"),r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.template=e("views/templates/duplicates/row"),r.prototype.tagName=function(){return this.model.has("result")?"div":"dl"},r.prototype.className=function(){return this.model.has("result")?"merged":""},r.prototype.attributes=function(){return{role:this.model.has("result")?"row":"rowgroup"}},r.prototype.ui={submit:"[type=submit]",dismiss:".cancel"},r.prototype.modelEvents={change:"render","contacts:merge":"onContactsMerge"},r.prototype.events={"click @ui.submit":"merge","click [type=checkbox]":"check","click @ui.dismiss":"dismiss"},r.prototype.serializeData=function(){var t;return t=this.model.has("result")?new o({"new":!1},{model:this.model.get("result")}):void 0,_.extend(r.__super__.serializeData.apply(this,arguments),{candidates:this.model.get("candidates").map(function(t){return new o({"new":!1},{model:t})}),selected:this.model.get("candidates").map(function(t){return function(e){return s.call(t.model.get("toMerge"),e)>=0}}(this)),isMergeable:this.model.isMergeable(),result:t,merging:this.merging})},r.prototype.check=function(t){var e;return e=$(t.target),this.model.selectCandidate(e.val(),e.is(":checked"))},r.prototype.dismiss=function(){return this.model.collection.remove(this.model)},r.prototype.onContactsMerge=function(){return this.merging=!1,this.render()},r.prototype.merge=function(){var t,r,o;return this.triggerMethod("merge"),this.merging=!0,this.$("button, input").prop("disabled",!0),_.defer(function(t){return function(){return t.ui.submit.attr("aria-busy",!0)}}(this)),o=this.model.buildMergeOptions(),0===Object.keys(o).length?this.model.merge():(t=e("views/contacts/merge"),r=e("application"),r.layout.showChildView("alerts",new t({model:this.model})))},r}(Mn.ItemView)}),require.register("views/labels/filter",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.template=e("views/templates/labels/filter"),r.prototype.tagName="li",r.prototype.serializeData=function(){var t,o,n,a;return t=e("application"),n=new RegExp("tag:"+this.model.get("name"),"i"),o=null!=(a=t.model.get("filter"))?a.match(n):void 0,_.extend({},r.__super__.serializeData.apply(this,arguments),{selected:!!o})},r}(Mn.ItemView)}),require.register("views/labels/index",function(t,e,r){var o,n,a,i={}.hasOwnProperty,s=function(t,e){function r(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=BackboneProjections.Filtered,a=e("config").search.pattern("tag"),r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.template=e("views/templates/labels"),r.prototype.tagName="fieldset",r.prototype.ui={navigate:"a"},r.prototype.behaviors={Navigator:{}},r.prototype.childViewContainer="ul",r.prototype.childView=e("views/labels/filter"),r.prototype.modelEvents={"change:filter":"toggleSelected"},r.prototype.initialize=function(){var t;return t=e("application"),this.collection=new o(t.tags,{filter:function(e){return t.contacts.length?!!t.contacts.find(function(t){return _.contains(t.get("tags"),e.get("name"))}):!1}}),this.collection.listenTo(t.contacts,{reset:this.collection.update,update:this.collection.update,"change:tags":this.collection.update})},r.prototype.toggleSelected=function(t,e){var r,o;return r=null!=e&&null!=(o=e.match(a))?o[1]:void 0,o=r?this.collection.find({name:r}).id:"all",this.$("a:not([data-id="+o+"])").attr("aria-checked",!1).find("input").prop("checked",!1),this.$("a[data-id="+o+"]").attr("aria-checked",!0).find("input").prop("checked",!0)},r}(Mn.CompositeView)}),require.register("views/models/app",function(t,e,r){var o,n,a,i={}.hasOwnProperty,s=function(t,e){function r(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},c=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};a=e("views/contacts/merge"),n=e("views/models/merge"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.defaults={dialog:!1,filter:null,errors:null},r.prototype.viewEvents={"settings:sort":"updateSortSetting","settings:upload":"onUploadFile","select:all":"selectAll","select:none":"unselectAll","bulk:delete":"bulkDelete","bulk:export":function(){return this.bulkExport()},"bulk:merge":"bulkMerge","contacts:export":function(){return this.bulkExport(!0)}},r.prototype.initialize=function(){return this.set("selected",[])},r.prototype.select=function(t){var e;return e=this.attributes.selected.slice(0),e.push(t),this.set({selected:e})},r.prototype.unselect=function(t){var e;return e=_.without(this.attributes.selected,t),this.set({selected:e})},r.prototype.selectAll=function(){var t,r;return t=e("application"),r=t.contacts.map(function(t){return t.id}),this.set({selected:r})},r.prototype.unselectAll=function(){return this.set({selected:[]})},r.prototype.bulkDelete=function(){var t;return t=e("application"),_.each(this.attributes.selected,function(e){return function(r){return _.defer(function(){return t.contacts.get(r).destroy({wait:!0,success:function(){return e.unselect(r)}})})}}(this))},r.prototype.bulkMerge=function(){var t,r,o,i;return t=e("application"),r=t.contacts.filter(function(t){return function(e){var r;return r=e.id,c.call(t.attributes.selected,r)>=0}}(this)),i=new n({candidates:r}),o=i.buildMergeOptions(),0===Object.keys(o).length?i.merge():t.layout.showChildView("alerts",new a({model:i}))},r.prototype.bulkExport=function(t){var r,o,n,a;return r=e("application"),o=t?r.contacts.size():this.attributes.selected.length,a=[],n=_.after(o,function(){var t;return t=new Blob(a,{type:"text/plain;charset=utf-8"}),saveAs(t,"contacts ("+a.length+").vcf")}),r.contacts.chain().filter(function(e){return function(r){var o;return t||(o=r.id,c.call(e.attributes.selected,o)>=0)}}(this)).invoke("toVCF",function(t){return a.push(t),n()})},r.prototype.updateSortSetting=function(t){return this.model.save("sort",t)},r.prototype.onUploadFile=function(t){var r;return/.+\.(vcf|vcard)$/i.test(t.name)?(this.trigger("before:import"),r=new FileReader,r.readAsText(t),r.onloadend=function(t){return function(){var o,n,a;return n=r.result,a=/^BEGIN:VCARD[\r\n]{1,2}(?:.+[\r\n]{1,2})+END:VCARD[\r\n]{0,2}$/,a.test(n)?(o=e("application"),o.contacts.importFromVCF(n)):t.set("errors",{upload:"error upload wrong filetype"})}}(this)):this.set("errors",{upload:"error upload wrong filetype"})},r}(Backbone.ViewModel)}),require.register("views/models/contact",function(t,e,r){var o,n,a,i,s={}.hasOwnProperty,c=function(t,e){function r(){this.constructor=t}for(var o in e)s.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},l=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};a=BackboneProjections.Filtered,i=e("lib/diacritics").asciize,o=e("config").contact,r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return c(r,t),r.prototype.defaults={"new":!1,edit:!1},r.prototype.map={avatar:"_attachments",initials:"n",name:"n"},r.prototype.events={"before:save":"syncDatapoints",save:"onSave",reset:"onReset"},r.prototype.viewEvents={"edit:cancel":"reset","tags:update":"updateTags","tags:add":"addNewTag","form:field:add":"onAddField","form:submit":function(){return this.save()},"export":"downloadAsVCF","delete":function(){return this.destroy()}},r.prototype.proxy=["toString","match"],r.prototype.initialize=function(){return this._setRef(),this.getDatapoints=_.memoize(this.getDatapoints,function(t){return this.attributes.edit?"edit-"+t:t}),this.listenTo(this,"change:edit",function(t,e){var r,o,n;if(e){r=this.getDatapoints.cache,n=[];for(o in r)/^edit/.test(o)&&n.push(delete r[o]);return n}})},r.prototype.toJSON=function(){var t;return t=_.reduce(o.datapoints.main,function(t){return function(e,r){return e[r]=t.getDatapoints(r).toJSON(),e}}(this),{xtras:this.getDatapoints("xtras").toJSON()}),_.extend({},r.__super__.toJSON.apply(this,arguments),t)},r.prototype.getMappedAvatar=function(t){return(null!=t?t.picture:void 0)?"contacts/"+this.model.id+"/picture.png?revpos="+t.picture.revpos:null},r.prototype.saveMappedAvatar=function(){var t,e;return t={},e=this.get("avatar"),null!=e&&null==e.match(/contacts\/.+\/picture.png/)&&(t.avatar=e.split(",")[1]),t},r.prototype.getMappedInitials=function(t){var e,r,o;return o=t.split(";"),r=o[0],e=o[1],(""+(e?i(e)[0]:"")+(r?i(r)[0]:"")).toUpperCase()},r.prototype.getMappedName=function(t){var e,r,o,n,a,i,s;return s=t.split(";"),r=s[0],e=s[1],o=s[2],a=s[3],i=s[4],n={first:e,given:r},o&&(n.middle=o),a&&(n.prefix=a),i&&(n.suffix=i),n},r.prototype.saveMappedName=function(){var t,e;return e=_.clone(this.get("name")),(t={}).n=[e.given,e.first,e.middle,e.prefix,e.suffix].join(";"),t},r.prototype._setRef=function(){return this.set("ref",this.model.cid)},r.prototype.onAddField=function(t){return l.call(o.xtras,t)>=0?this.set(t,""):void 0},r.prototype.getDatapoints=function(t){var e,r;return e=function(e){var r;return l.call(o.datapoints.main,t)>=0?e.get("name")===t:(r=e.get("name"),l.call(o.datapoints.main,r)<0)},this.attributes.edit?(r=this.model.get("datapoints").filter(e).map(function(t){return t.clone()}),new Backbone.Collection(r)):new a(this.model.get("datapoints"),{filter:e})},r.prototype.syncDatapoints=function(){var t,e,r;return t=this.getDatapoints.cache,e=this.model.get("datapoints"),r=_.reduce(t,function(t,e,r){return/^edit/.test(r)?t.concat(e.filter(function(t){return!_.isEmpty(t.get("value"))})):t},[]),e.reset(r)},r.prototype.updateTags=function(t){return this.model.save({tags:t})},r.prototype.addNewTag=function(t){var r;return r=e("application"),r.tags.create({name:t},{wait:!0,success:function(e){return function(){var r;return r=e.model.get("tags").concat(t),e.model.save({tags:r})}}(this)})},r.prototype.onSave=function(){return this.get("new")?e("application").contacts.add(this.model):void 0},r.prototype.onReset=function(){return this._setRef()},r.prototype.downloadAsVCF=function(){return this.model.toVCF(function(t){return function(e){var r;return r=new Blob([e],{type:"text/plain;charset=utf-8"}),saveAs(r,""+t.model.get("fn")+".vcf")}}(this))},r}(Backbone.ViewModel)}),require.register("views/models/group",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults=function(){return{isEmpty:this.isEmpty()}},e.prototype.initialize=function(){return this.listenTo(this.compositeCollection,{update:function(){return this.set("isEmpty",this.isEmpty())},reset:function(){return this.set("isEmpty",this.isEmpty())}})},e.prototype.isEmpty=function(){return!this.compositeCollection.length},e}(Backbone.ViewModel)}),require.register("views/models/merge",function(t,e,r){var o,n,a,i,s,c,l={}.hasOwnProperty,u=function(t,e){function r(){this.constructor=t}for(var o in e)l.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},p=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};a=e("models/contact"),s=e("views/models/contact"),n=e("lib/compare_contacts"),i=e("lib/contact_helper"),o=["org","title","department","bday","nickname"],r.exports=c=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return u(r,t),r.prototype.initialize=function(t){return null!=t.candidates?this.set("toMerge",t.candidates.slice(0)):void 0},r.prototype.selectCandidate=function(t,e){return e?this.isCandidateSelected(t)||this.attributes.toMerge.push(this.get("candidates")[t]):this.unselectCandidate(t),this.trigger("change",this)},r.prototype.unselectCandidate=function(t){return this.attributes.toMerge=this.attributes.toMerge.filter(function(e){return function(r){return r!==e.get("candidates")[t]}}(this))},r.prototype.isCandidateSelected=function(t){var e;return e=this.get("candidates")[t],p.call(this.get("toMerge"),e)>=0},r.prototype.toMergeAsJson=function(){return this.get("toMerge").map(function(t){return t.toJSON()})},r.prototype.isMergeable=function(){return!this.has("result")&&this.get("toMerge").length>1},r.prototype.buildMergeOptions=function(){var t,e,r,n,a,i;for(r={},e=o.concat(["avatar","fullname"]),a=0,i=e.length;i>a;a++)t=e[a],n=[],this.get("toMerge").forEach(function(e,r){var o,a;return a="avatar"===t?e.has("_attachments")?"contacts/"+e.get("id")+"/picture.png":null:"fullname"===t?e.toString({pre:"<b>",post:"</b>"}):e.get(t),o=function(t){return t.value===a},null==a||""===a||n.some(o)?void 0:n.push({value:a,index:r})}),n.length>0&&this.set(t,n[0].index),n.length>1&&(r[t]=n);return this.set("mergeOptions",r),r},r.prototype.merge=function(t){var e,r,s,c,l,u,p,d,f;if(u=this.toMergeAsJson(),u.length<=1)return t(new Error("not enought contact to merge."));for(c={datapoints:[],tags:[]},u.forEach(function(t){return n.mergeContacts(c,t)}),delete c._id,delete c.id,delete c.revision,delete c._rev,delete c._attachments,s=o,this.has("fullname")&&(this.set("n",this.get("fullname")),this.set("fn",this.get("fullname")),s=s.concat(["n","fn"])),d=0,f=s.length;f>d;d++)r=s[d],this.has(r)&&(c[r]=u[this.get(r)][r]);return l=new a(c,{parse:!0}),e=function(e){return function(r){return r?t(r):(e.listenToOnce(l,"sync",e.afterSyncResult.bind(e)),l.save(),null!=t?t():void 0)}}(this),this.has("avatar")?(p="contacts/"+u[this.get("avatar")].id+"/picture.png",i.imgUrl2DataUrl(p,function(t,r){return l.set("avatar",r.split(",")[1]),e(t)})):e()},r.prototype.afterSyncResult=function(t){return async.each(this.get("toMerge"),function(t,e){return t.destroy({success:function(){return e()},error:function(t,r,o){return e(r)}})},function(r){return function(o){return o?(console.error(o),r.trigger("contacts:merge",r,o)):(r.attributes.toMerge=[],r.attributes.candidates=[],r.set("result",t),r.trigger("contacts:merge",r,null)),e("application").contacts.add(t)}}(this))},r}(Backbone.ViewModel)}),require.register("views/settings/index",function(t,e,r){var o,n,a,i={}.hasOwnProperty,s=function(t,e){function r(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};n=e("config").settings,a=e("lib/i18n"),r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.template=e("views/templates/settings"),r.prototype.tagName="section",r.prototype.className="settings",r.prototype.attributes={role:"dialog"},r.prototype.behaviors={Dialog:{}},r.prototype.ui={sort:"[name=sort]","import":"button.import",upload:"[type=file]","export":'[formaction="contacts/export"]',feedback:".feedback"},r.prototype.triggers={"click @ui.export":"contacts:export"},r.prototype.events={"change @ui.sort":"updateSort","click @ui.import":"triggerUploader","change @ui.upload":"onUploadFile"},r.prototype.modelEvents={"change:errors":"render","before:import":"onBeforeImport"},r.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents),this.listenTo(e("application").contacts,{"before:import:progress":this.onBeforeImportProgress,"import:progress":this.onProgressImport,"import":this.onProgressEnd})},r.prototype.serializeData=function(){return _.extend({},r.__super__.serializeData.apply(this,arguments),n,{locale:e("imports").locale})},r.prototype.updateSort=function(t){return t.preventDefault(),t.stopPropagation(),this.triggerMethod("settings:sort",t.currentTarget.value)},r.prototype.triggerUploader=function(t){return t.preventDefault(),t.stopPropagation(),this.ui.upload.trigger("click")},r.prototype.onUploadFile=function(t){return t.preventDefault(),t.stopPropagation(),this.triggerMethod("settings:upload",t.currentTarget.files[0])},r.prototype.onBeforeImport=function(){return this.ui["import"].prop("disabled",!0),this.ui.feedback.empty()},r.prototype.onBeforeImportProgress=function(t){var e;return this.ui.progress=$("<progress/>",{max:t,value:0}),this.ui.counter=$("<span/>",{text:0}),e=$("<div/>",{text:"/"+t}).prepend(this.ui.counter),this.ui.progress.appendTo(this.ui.feedback),e.appendTo(this.ui.feedback)},r.prototype.onProgressImport=function(t){return this.ui.progress.val(t),this.ui.counter.text(t)},r.prototype.onProgressEnd=function(t){return this.ui.feedback.empty().text(a("settings in-out import result",{smart_count:t})),this.ui["import"].prop("disabled",!1)},r}(Mn.ItemView)}),require.register("views/templates/contacts/card",function(e,r,o){var n=function(e){var r,o=[],n=e||{},a=n.edit,i=n.lists,s=n.id,c=n._id;return o.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo">'),a&&function(){var t=i;if("number"==typeof t.length)for(var e=0,r=t.length;r>e;e++){var n=t[e];o.push("<datalist"+jade.attr("id","list-"+e,!0,!1)+">"),function(){var t=n;if("number"==typeof t.length)for(var e=0,r=t.length;r>e;e++){var a=t[e],i=a.split(":");o.push("<option"+jade.attr("value",i[0],!0,!1)+jade.attr("data-name",i[1],!0,!1)+"></option>")}else{var r=0;for(var e in t){r++;var a=t[e],i=a.split(":");o.push("<option"+jade.attr("value",i[0],!0,!1)+jade.attr("data-name",i[1],!0,!1)+"></option>")}}}.call(this),o.push("</datalist>")}else{var r=0;for(var e in t){r++;var n=t[e];o.push("<datalist"+jade.attr("id","list-"+e,!0,!1)+">"),function(){var t=n;if("number"==typeof t.length)for(var e=0,r=t.length;r>e;e++){var a=t[e],i=a.split(":");o.push("<option"+jade.attr("value",i[0],!0,!1)+jade.attr("data-name",i[1],!0,!1)+"></option>")}else{var r=0;for(var e in t){r++;var a=t[e],i=a.split(":");o.push("<option"+jade.attr("value",i[0],!0,!1)+jade.attr("data-name",i[1],!0,!1)+"></option>")}}}.call(this),o.push("</datalist>")}}}.call(this),o.push('<div role="img"></div><div class="data"></div><aside><ul>'),a?(s?o.push('<li><button type="submit"'+jade.attr("data-next","contacts/"+c,!0,!1)+' class="outline"><i class="fa fa-check"></i><span>'+jade.escape(null==(r=t("card actions save"))?"":r)+"</span></button></li>"):o.push('<li><button type="submit" class="outline"><i class="fa fa-plus"></i><span>'+jade.escape(null==(r=t("card actions create"))?"":r)+"</span></button></li>"),o.push('<li><a role="button"'+jade.attr("href",s?"contacts/"+c:"contacts",!0,!1)+jade.attr("data-confirm",'{"event":"edit:cancel","title":"'+t("card confirm cancel title")+'","message":"'+t("card confirm cancel message")+'","btn_ok":"'+t("card confirm cancel ok")+'","btn_cancel":"'+t("card confirm cancel cancel")+'"}',!0,!1)+' class="cancel outline secondary"><i class="fa fa-times"></i><span>'+jade.escape(null==(r=t("card actions cancel"))?"":r)+"</span></a></li>")):o.push('<li><a role="button"'+jade.attr("href","contacts/"+c+"/edit",!0,!1)+' class="edit outline secondary"><i class="fa fa-pencil"></i><span>'+jade.escape(null==(r=t("card actions edit"))?"":r)+'</span></a></li><li><button formaction="contact/export"><i class="fa fa-upload"></i><span>'+jade.escape(null==(r=t("card actions export"))?"":r)+'</span></button></li><li><button class="delete outline danger special"><i class="fa fa-trash"></i><span>'+jade.escape(null==(r=t("card actions delete"))?"":r)+"</span></button></li>"),o.push('<li class="tags"></li></ul></aside></div></div>'),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/contacts/components/add_field_dropdown",function(e,r,o){var n=function(e){var r,o=[],n=e||{},a=n.bday;return o.push('<dt role="button" class="outline secondary caret">'+jade.escape(null==(r=t("card actions add select"))?"":r)+'<i class="fa fa-caret-down"></i></dt><dd role="listbox"><ul>'),null==a&&o.push('<li role="option"><button value="bday" class="link">'+jade.escape(null==(r=t("card actions add birthday"))?"":r)+"</button></li>"),o.push('<li role="option"><button value="social" class="link">'+jade.escape(null==(r=t("card actions add social"))?"":r)+'</button></li><li role="option"><button value="url" class="link">'+jade.escape(null==(r=t("card actions add link"))?"":r)+'</button></li><li role="option"><button value="other" class="link">'+jade.escape(null==(r=t("card actions add other"))?"":r)+"</button></li></ul></dd>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/contacts/components/avatar",function(t,e,r){var o=function(t){var e,r=[],o=t||{},n=o.avatar,a=o.bg,i=o.initials;return n?r.push("<img"+jade.attr("src",n,!0,!1)+' class="avatar"/>'):r.push("<span"+jade.attr("style","background-color:"+a,!0,!1)+' class="avatar initials">'+jade.escape(null==(e=i)?"":e)+"</span>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o)}),require.register("views/templates/contacts/components/data",function(e,r,o){var n=function(e){var r,o=[],n={},a=e||{},i=a.ref,s=a.edit,c=a.name,l=a.org,u=a.department,p=a.title,d=a.fullname,f=a.tags,h=a.note;return n.formatJob=function(t,e,n){this&&this.block,this&&this.attributes||{};t&&o.push(jade.escape(null==(r=t)?"":r)),t&&e&&o.push(" - "),e&&o.push(jade.escape(null==(r=e)?"":r)),(e&&n||t&&n)&&o.push(" "),n&&o.push("("+jade.escape(null==(r=n)?"":r)+")");
},n.input=function(e,n){var a=(this&&this.block,this&&this.attributes||{}),s=t("datapoint label "+e.replace("."," ")),c=[e,i].join("-"),l=a.placeholder?t("datapoint placeholder "+e):!1,u=a.value;o.push("<label"+jade.attr("for",c,!0,!1)+' class="group"><span class="type">'+jade.escape(null==(r=s)?"":r)+"</span>"),"textarea"==n?o.push("<textarea"+jade.attr("id",c,!0,!1)+jade.attr("name",e,!0,!1)+' class="value">'+jade.escape(null==(r=u)?"":r)+"</textarea>"):o.push("<input"+jade.attr("id",c,!0,!1)+jade.attr("name",e,!0,!1)+' type="text"'+jade.attr("value",u,!0,!1)+jade.attr("placeholder",l,!0,!1)+jade.cls(["value",u?void 0:"empty"],[null,!0])+'/><button class="link clear"><div class="fa fa-times"></div></button>'),o.push("</label>")},s?(n.input.call({attributes:{value:jade.escape(c.prefix)}},"name.prefix"),n.input.call({attributes:{value:jade.escape(c.first)}},"name.first"),n.input.call({attributes:{value:jade.escape(c.middle)}},"name.middle"),n.input.call({attributes:{value:jade.escape(c.given)}},"name.given"),n.input.call({attributes:{value:jade.escape(c.suffix)}},"name.suffix"),o.push('<fieldset data-type="infos" class="block">'),n.input.call({attributes:{value:jade.escape(l),placeholder:!0}},"org"),n.input.call({attributes:{value:jade.escape(u),placeholder:!0}},"department"),n.input.call({attributes:{value:jade.escape(p),placeholder:!0}},"title"),o.push("</fieldset>")):(o.push("<header><h1>"+(null==(r=d)?"":r)+'</h1><ul class="tags">'),function(){var t=f;if("number"==typeof t.length)for(var e=0,n=t.length;n>e;e++){var a=t[e];o.push("<li>"+jade.escape(null==(r=a)?"":r)+"</li>")}else{var n=0;for(var e in t){n++;var a=t[e];o.push("<li>"+jade.escape(null==(r=a)?"":r)+"</li>")}}}.call(this),o.push('</ul></header><ul data-type="infos" class="block">'),(p||l||u||h)&&((p||l||u)&&(o.push("<li>"),n.formatJob(p,l,u),o.push("</li>")),h&&o.push("<li>"+jade.escape(null==(r=h)?"":r)+"</li>")),o.push("</ul>")),o.push('<div data-type="tel" class="block datapoints"></div><div data-type="email" class="block datapoints"></div><div data-type="adr" class="block datapoints"></div><div class="block"><div data-type="xtras" class="datapoints"></div><div data-type="xtras-infos"></div>'),s&&n.input.call({attributes:{value:jade.escape(h)}},"note","textarea"),o.push("</div>"),s&&o.push('<div class="actions"></div>'),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/contacts/components/datapoint",function(e,r,o){var n=function(e){var r,o=[],n={},a=e||{},i=a.entity,s=a.ref,c=a.edit,l=a.point,u=a.name,p=a.index;return n.formatPoint=function(t,e){this&&this.block,this&&this.attributes||{};if(e)switch(t.type.toLowerCase()){case"home":var e="home";break;case"work":var e="building";break;default:switch(t.name){case"tel":var e="phone";break;case"email":var e="envelope";break;default:var e=!1}}o.push("<i"+jade.cls(["type",e?"fa fa-"+e:!1],[null,!0])+">"+jade.escape(null==(r=t.type)?"":r)+'&nbsp;</i><span class="value">'+jade.escape(null==(r=t.value)?"":r)+"</span>")},n.groupInput=function(e,r,n){var a=(this&&this.block,this&&this.attributes||{}),c=a.placeholder?t("datapoint placeholder "+("default"==i?e.name:i)):!1,l=r+"."+n;o.push("<input"+jade.attr("id",""+l+".type-"+s,!0,!1)+jade.attr("name",""+l+".type",!0,!1)+' type="text"'+jade.attr("value",e.type,!0,!1)+jade.attr("list","list-"+i,!0,!1)+' class="type"/><input'+jade.attr("id",""+l+".value-"+s,!0,!1)+jade.attr("name",""+l+".value",!0,!1)+' type="text"'+jade.attr("value",e.value,!0,!1)+jade.attr("placeholder",c,!0,!1)+jade.cls(["value",e.value?void 0:"empty"],[null,!0])+'/><button class="link delete"><div class="fa fa-trash"></div></button><input'+jade.attr("id",""+l+".name-"+s,!0,!1)+jade.attr("name",""+l+".name",!0,!1)+' type="hidden"'+jade.attr("value",e.name,!0,!1)+' class="name"/>')},c?n.groupInput.call({attributes:{placeholder:!0}},l,u,p):n.formatPoint(l),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/contacts/components/edit_tags",function(e,r,o){var n=function(e){var r,o=[];return o.push('<dt role="button" class="outline secondary caret"><i class="fa fa-tags fa-flip-horizontal"></i>'+jade.escape(null==(r=t("card actions labels"))?"":r)+'<i class="fa fa-caret-down"></i></dt><dd><fieldset><legend>'+jade.escape(null==(r=t("card actions labels add"))?"":r)+'</legend><ul></ul><div aria-expanded="false" class="create"><label for="tag-new"><input type="text" name="name"/></label><button><i class="fa fa-plus"></i>'+jade.escape(null==(r=t("card actions labels create"))?"":r)+"</button></div></fieldset></dd>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/contacts/components/tag",function(t,e,r){var o=function(t){var e,r=[],o=t||{},n=o._id,a=o.selected,i=o.name,s=n.slice(-6);return r.push("<label"+jade.attr("for","tag-"+s,!0,!1)+'><input type="checkbox"'+jade.attr("id","tag-"+s,!0,!1)+' name="tags"'+jade.attr("value",n,!0,!1)+jade.attr("checked",a,!0,!1)+'/><span class="label">'+jade.escape(null==(e=i)?"":e)+"</span></label>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o)}),require.register("views/templates/contacts/components/xtras",function(e,r,o){var n=function(e){var r,o=[],n={},a=e||{},i=a.ref,s=a.xtras,c=a.edit;return n.formatPoint=function(t,e){this&&this.block,this&&this.attributes||{};if(e)switch(t.type.toLowerCase()){case"home":var e="home";break;case"work":var e="building";break;default:switch(t.name){case"tel":var e="phone";break;case"email":var e="envelope";break;default:var e=!1}}o.push("<i"+jade.cls(["type",e?"fa fa-"+e:!1],[null,!0])+">"+jade.escape(null==(r=t.type)?"":r)+'&nbsp;</i><span class="value">'+jade.escape(null==(r=t.value)?"":r)+"</span>")},n.input=function(e,n){var a=(this&&this.block,this&&this.attributes||{}),s=t("datapoint label "+e.replace("."," ")),c=[e,i].join("-"),l=a.placeholder?t("datapoint placeholder "+e):!1,u=a.value;o.push("<label"+jade.attr("for",c,!0,!1)+' class="group"><span class="type">'+jade.escape(null==(r=s)?"":r)+"</span>"),"textarea"==n?o.push("<textarea"+jade.attr("id",c,!0,!1)+jade.attr("name",e,!0,!1)+' class="value">'+jade.escape(null==(r=u)?"":r)+"</textarea>"):o.push("<input"+jade.attr("id",c,!0,!1)+jade.attr("name",e,!0,!1)+' type="text"'+jade.attr("value",u,!0,!1)+jade.attr("placeholder",l,!0,!1)+jade.cls(["value",u?void 0:"empty"],[null,!0])+'/><button class="link clear"><div class="fa fa-times"></div></button>'),o.push("</label>")},function(){var e=s;if("number"==typeof e.length)for(var r=0,a=e.length;a>r;r++){var i=e[r];if(c)n.input.call({attributes:{value:jade.escape(i),placeholder:!0}},r,"text");else{var l={type:t("datapoint label "+r),value:i};o.push('<li class="group">'),n.formatPoint(l),o.push("</li>")}}else{var a=0;for(var r in e){a++;var i=e[r];if(c)n.input.call({attributes:{value:jade.escape(i),placeholder:!0}},r,"text");else{var l={type:t("datapoint label "+r),value:i};o.push('<li class="group">'),n.formatPoint(l),o.push("</li>")}}}}.call(this),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/contacts/group",function(t,e,r){var o=function(t){var e,r=[],o=t||{},n=o.name;return r.push('<dt role="columnheader">'+jade.escape(null==(e=n)?"":e)+"</dt><dd><ul></ul></dd>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o)}),require.register("views/templates/contacts/helpers",function(t,e,r){var o=function(t){var e=[];return e.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o)}),require.register("views/templates/contacts/merge",function(e,r,o){var n=function(e){var r,o=[],n={},a=e||{},i=a.model;return n.radio=function(t,e){this&&this.block,this&&this.attributes||{};o.push("<ul"+jade.cls(["avatar"==e?"avatars":""],[!0])+">"),function(){var n=t;if("number"==typeof n.length)for(var a=0,s=n.length;s>a;a++){var c=n[a],l=c.index,u=["merge",e,l].join("-"),p=i[e]==l;o.push("<li><label"+jade.attr("for",u,!0,!1)+">"),"avatar"==e?o.push('<input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><img"+jade.attr("src",c.value,!0,!1)+"/>"):(o.push('<span data-input="radio"><input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><label"+jade.attr("for",u,!0,!1)+"></label></span><span>"),"fullname"==e?o.push(null==(r=c.value)?"":r):o.push(jade.escape(null==(r=c.value)?"":r)),o.push("</span>")),o.push("</label></li>")}else{var s=0;for(var a in n){s++;var c=n[a],l=c.index,u=["merge",e,l].join("-"),p=i[e]==l;o.push("<li><label"+jade.attr("for",u,!0,!1)+">"),"avatar"==e?o.push('<input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><img"+jade.attr("src",c.value,!0,!1)+"/>"):(o.push('<span data-input="radio"><input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><label"+jade.attr("for",u,!0,!1)+"></label></span><span>"),"fullname"==e?o.push(null==(r=c.value)?"":r):o.push(jade.escape(null==(r=c.value)?"":r)),o.push("</span>")),o.push("</label></li>")}}}.call(this),o.push("</ul>")},o.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo">'),n.radio=function(t,e){this&&this.block,this&&this.attributes||{};o.push("<ul"+jade.cls(["avatar"==e?"avatars":""],[!0])+">"),function(){var n=t;if("number"==typeof n.length)for(var a=0,s=n.length;s>a;a++){var c=n[a],l=c.index,u=["merge",e,l].join("-"),p=i[e]==l;o.push("<li><label"+jade.attr("for",u,!0,!1)+">"),"avatar"==e?o.push('<input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><img"+jade.attr("src",c.value,!0,!1)+"/>"):(o.push('<span data-input="radio"><input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><label"+jade.attr("for",u,!0,!1)+"></label></span><span>"),"fullname"==e?o.push(null==(r=c.value)?"":r):o.push(jade.escape(null==(r=c.value)?"":r)),o.push("</span>")),o.push("</label></li>")}else{var s=0;for(var a in n){s++;var c=n[a],l=c.index,u=["merge",e,l].join("-"),p=i[e]==l;o.push("<li><label"+jade.attr("for",u,!0,!1)+">"),"avatar"==e?o.push('<input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><img"+jade.attr("src",c.value,!0,!1)+"/>"):(o.push('<span data-input="radio"><input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><label"+jade.attr("for",u,!0,!1)+"></label></span><span>"),"fullname"==e?o.push(null==(r=c.value)?"":r):o.push(jade.escape(null==(r=c.value)?"":r)),o.push("</span>")),o.push("</label></li>")}}}.call(this),o.push("</ul>")},o.push("<h1>"+jade.escape(null==(r=t("merge title"))?"":r)+"</h1><dl>"),null!=i.mergeOptions.avatar&&(o.push("<dt>"+jade.escape(null==(r=t("merge choose avatar"))?"":r)+"</dt><dd>"),n.radio(i.mergeOptions.avatar,"avatar"),o.push("</dd>")),null!=i.mergeOptions.fullname&&(o.push("<dt>"+jade.escape(null==(r=t("merge choose name"))?"":r)+"</dt><dd>"),n.radio(i.mergeOptions.fullname,"fullname"),o.push("</dd>")),null!=i.mergeOptions.nickname&&(o.push("<dt>"+jade.escape(null==(r=t("merge choose nickname"))?"":r)+"</dt><dd>"),n.radio(i.mergeOptions.nickname),o.push("</dd>")),(null!=i.mergeOptions.org||null!=i.mergeOptions.department||null!=i.mergeOptions.title)&&(o.push("<dt>"+jade.escape(null==(r=t("merge choose organisation"))?"":r)+"</dt><dd><dl>"),null!=i.mergeOptions.org&&(o.push("<dt>"+jade.escape(null==(r=t("merge choose org"))?"":r)+"</dt><dd>"),n.radio(i.mergeOptions.org,"org"),o.push("</dd>")),null!=i.mergeOptions.department&&(o.push("<dt>"+jade.escape(null==(r=t("merge choose department"))?"":r)+"</dt><dd>"),n.radio(i.mergeOptions.department,"department"),o.push("</dd>")),null!=i.mergeOptions.title&&(o.push("<dt>"+jade.escape(null==(r=t("merge choose title"))?"":r)+"</dt><dd>"),n.radio(i.mergeOptions.title,"title"),o.push("</dd>")),o.push("</dl></dd>")),null!=i.mergeOptions.bday&&(o.push("<dt>"+jade.escape(null==(r=t("merge choose birthday"))?"":r)+"</dt><dd>"),n.radio(i.mergeOptions.bday,"bday"),o.push("</dd>")),o.push('</dl><nav><ul class="actions"><li><button type="submit"><div class="fa fa-code-fork"></div><span>'+jade.escape(null==(r=t("merge actions merge"))?"":r)+'</span></button></li><li><button class="cancel outline secondary"><span>'+jade.escape(null==(r=t("merge actions cancel"))?"":r)+"</span></button></li></ul></nav></div></div>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/contacts/row",function(t,e,r){var o=function(t){var e,r=[],o={},n=t||{},a=n.ref,i=n.id,s=n.selected,c=n._id,l=n.avatar,u=n.n,p=n.initials,d=n.fullname,f=n.tel,h=n.email;if(o.formatPoint=function(t,o){this&&this.block,this&&this.attributes||{};if(o)switch(t.type.toLowerCase()){case"home":var o="home";break;case"work":var o="building";break;default:switch(t.name){case"tel":var o="phone";break;case"email":var o="envelope";break;default:var o=!1}}r.push("<i"+jade.cls(["type",o?"fa fa-"+o:!1],[null,!0])+">"+jade.escape(null==(e=t.type)?"":e)+'&nbsp;</i><span class="value">'+jade.escape(null==(e=t.value)?"":e)+"</span>")},o.formatDatapoints=function(t,e){this&&this.block,this&&this.attributes||{};if(null!=t&&t.length){var n=t.length>1;r.push('<dl role="gridcell"'+jade.attr("aria-haspopup",n?"true":"false",!0,!1)+' aria-expanded="false" data-position="bottom left"'+jade.cls([e],[!0])+"><dt>"),o.formatPoint(t[0]),n&&r.push('<span class="fa fa-caret-down"></span>'),r.push("</dt>"),n&&(r.push("<dd><ul>"),function(){var e=t;if("number"==typeof e.length)for(var n=0,a=e.length;a>n;n++){var i=e[n];r.push("<li>"),o.formatPoint(i,!0),r.push("</li>")}else{var a=0;for(var n in e){a++;var i=e[n];r.push("<li>"),o.formatPoint(i,!0),r.push("</li>")}}}.call(this),r.push("</ul></dd>")),r.push("</dl>")}else r.push('<div role="gridcell"'+jade.cls(["placeholder",e],[null,!0])+"></div>")},r.push('<span data-input="checkbox"><input type="checkbox"'+jade.attr("id",a,!0,!1)+' name="bulk"'+jade.attr("value",i,!0,!1)+jade.attr("checked",s,!0,!1)+"/><label"+jade.attr("for",a,!0,!1)+'></label></span><a role="gridcell"'+jade.attr("href","contacts/"+c,!0,!1)+' class="name">'),l)r.push("<img"+jade.attr("src",l,!0,!1)+' class="avatar"/>');else{var m=ColorHash.getColor(u,"cozy");r.push("<span"+jade.attr("style","background-color:"+m,!0,!1)+' class="avatar initials">'+jade.escape(null==(e=p)?"":e)+"</span>")}return r.push("<p>"+(null==(e=d)?"":e)+"</p></a>"),o.formatDatapoints(f,"tel"),o.formatDatapoints(h,"email"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o)}),require.register("views/templates/duplicates/index",function(e,r,o){var n=function(e){var r,o=[],n=e||{},a=n.size;return o.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo"><h1>'+jade.escape(null==(r=t("duplicates title"))?"":r)+"</h1>"),a>0?o.push('<button type="submit" class="mergeall"><div class="fa fa-code-fork"></div><span>'+jade.escape(null==(r=t("duplicates actions mergeall"))?"":r)+"</span> ("+jade.escape(null==(r=a)?"":r)+')</button><div role="grid"></div>'):o.push('<p class="empty">'+jade.escape(null==(r=t("duplicates empty"))?"":r)+"</p>"),o.push("</div></div>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/duplicates/row",function(e,r,o){var n=function(e){var r,o=[],n={},a=e||{},i=a.result,s=a.candidates,c=a.isMergeable,l=a.merging,u=a.selected;return n.formatPoint=function(t,e){this&&this.block,this&&this.attributes||{};if(e)switch(t.type.toLowerCase()){case"home":var e="home";break;case"work":var e="building";break;default:switch(t.name){case"tel":var e="phone";break;case"email":var e="envelope";break;default:var e=!1}}o.push("<i"+jade.cls(["type",e?"fa fa-"+e:!1],[null,!0])+">"+jade.escape(null==(r=t.type)?"":r)+'&nbsp;</i><span class="value">'+jade.escape(null==(r=t.value)?"":r)+"</span>")},n.fullname=function(t){this&&this.block,this&&this.attributes||{};o.push("<p>"+(null==(r=t.toString({pre:"<b>",post:"</b>"}))?"":r)+"</p>")},n.formatDatapoints=function(t,e){this&&this.block,this&&this.attributes||{};null!=t&&t.length?(o.push('<dl role="gridcell" aria-haspopup="true"'+jade.cls([e],[!0])+"><dt>"),n.formatPoint(t[0]),o.push("</dt></dl>")):o.push('<div role="gridcell"'+jade.cls(["placeholder",e],[null,!0])+"></div>")},n.contactrow=function(t){var e=(this&&this.block,this&&this.attributes||{},t.toJSON());o.push('<div role="gridcell" class="name">'),e.avatar?o.push("<img"+jade.attr("src",e.avatar,!0,!1)+' class="avatar"/>'):o.push('<span class="avatar initials">'+jade.escape(null==(r=e.initials)?"":r)+"</span>"),n.fullname(t),o.push("</div>"),n.formatDatapoints(e.tel,"tel"),n.formatDatapoints(e.email,"email")},i?n.contactrow(i):(o.push('<dt role="columnheader">'),n.fullname(s[0]),o.push('<div class="btn-group"><button class="cancel outline secondary"><span>'+jade.escape(null==(r=t("mergerow actions dismiss"))?"":r)+'</span></button><button type="submit"'+jade.attr("disabled",!c,!0,!1)+jade.attr("aria-busy",l,!0,!1)+'><div class="fa fa-code-fork"></div><span>'+jade.escape(null==(r=t("mergerow actions merge"))?"":r)+"</span></button></div></dt><dd><ul>"),function(){var t=s;if("number"==typeof t.length)for(var e=0,r=t.length;r>e;e++){var a=t[e];o.push('<li role="presentation"><label'+jade.attr("for",a.cid,!0,!1)+' role="row"><span data-input="checkbox"><input type="checkbox"'+jade.attr("id",a.cid,!0,!1)+jade.attr("name","mergecontact-"+e,!0,!1)+jade.attr("value",""+e,!0,!1)+jade.attr("checked",u[e],!0,!1)+"/><label"+jade.attr("for",a.cid,!0,!1)+"></label></span>"),n.contactrow(a),o.push("</label></li>")}else{var r=0;for(var e in t){r++;var a=t[e];o.push('<li role="presentation"><label'+jade.attr("for",a.cid,!0,!1)+' role="row"><span data-input="checkbox"><input type="checkbox"'+jade.attr("id",a.cid,!0,!1)+jade.attr("name","mergecontact-"+e,!0,!1)+jade.attr("value",""+e,!0,!1)+jade.attr("checked",u[e],!0,!1)+"/><label"+jade.attr("for",a.cid,!0,!1)+"></label></span>"),n.contactrow(a),o.push("</label></li>")}}}.call(this),o.push("</ul></dd>")),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/labels/filter",function(t,e,r){var o=function(t){var e,r=[],o=t||{},n=o.id,a=o.name,i=o.selected;return r.push("<a"+jade.attr("href","all"==n?"contacts":"tags/"+a,!0,!1)+' data-input="radio"'+jade.attr("data-id",n,!0,!1)+jade.attr("aria-checked",i?"true":"false",!0,!1)+'><input type="radio"'+jade.attr("id",n,!0,!1)+' name="label-filters"'+jade.attr("checked",i,!0,!1)+"/><label"+jade.attr("for",n,!0,!1)+"></label>"+jade.escape(null==(e=a)?"":e)+"</a>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o)}),require.register("views/templates/labels/index",function(e,r,o){var n=function(e){var r,o=[],n=e||{},a=n.filter;o.push("<legend>"+jade.escape(null==(r=t("tools labels filters"))?"":r)+"</legend><nav><ul><li>");var i="all",s=t("tools labels filters all"),c=null==a;return o.push("<a"+jade.attr("href","all"==i?"contacts":"tags/"+s,!0,!1)+' data-input="radio"'+jade.attr("data-id",i,!0,!1)+jade.attr("aria-checked",c?"true":"false",!0,!1)+'><input type="radio"'+jade.attr("id",i,!0,!1)+' name="label-filters"'+jade.attr("checked",c,!0,!1)+"/><label"+jade.attr("for",i,!0,!1)+"></label>"+jade.escape(null==(r=s)?"":r)+"</a></li></ul></nav>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/layouts/app",function(e,r,o){var n=function(e){var r,o=[],n=e||{},a=n.mode;return o.push('<aside class="drawer"><div class="tool-actions"></div><div class="tool-labels"></div>'),"select"!=a&&o.push('<footer class="tool-subactions"><nav><ul><li><a href="settings" role="button" class="secondary"><div class="fa fa-cog"></div><span>'+jade.escape(null==(r=t("tools subactions settings"))?"":r)+"</span></a></li></ul></nav></footer>"),o.push('</aside><main><div role="toolbar"></div><div role="contentinfo"></div></main><div aria-hidden="true" class="dialogs"></div><div aria-hidden="true" class="alerts"></div>'),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/settings/index",function(e,r,o){var n=function(e){var r,o=[],n=e||{},a=n.errors,i=n.sortkeys,s=n.sort,c=n.locale;return o.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo"><h1>'+jade.escape(null==(r=t("settings title"))?"":r)+'</h1><div class="group"><h2>'+jade.escape(null==(r=t("settings in-out title"))?"":r)+'</h2><nav><ul><li><input type="file" name="upload"/><button class="import"><i class="fa fa-download"></i>'+jade.escape(null==(r=t("settings in-out import action"))?"":r)+'</button></li><li><button formaction="contacts/export" class="export"><i class="fa fa-upload"></i>'+jade.escape(null==(r=t("settings in-out export action"))?"":r)+"</button></li></ul></nav><div"+jade.cls(["feedback",a?"error":""],[null,!0])+">"),a&&a.upload&&o.push(jade.escape(null==(r=t(a.upload))?"":r)),o.push('</div></div><div class="group"><h2>'+jade.escape(null==(r=t("settings display title"))?"":r)+'</h2><select name="sort" class="btn outline secondary">'),function(){var e=i;if("number"==typeof e.length)for(var n=0,a=e.length;a>n;n++){var c=e[n];o.push("<option"+jade.attr("value",c,!0,!1)+jade.attr("selected",s==c,!0,!1)+">"+jade.escape(null==(r=t("settings display sort "+c))?"":r)+"</option>")}else{var a=0;for(var n in e){a++;var c=e[n];o.push("<option"+jade.attr("value",c,!0,!1)+jade.attr("selected",s==c,!0,!1)+">"+jade.escape(null==(r=t("settings display sort "+c))?"":r)+"</option>")}}}.call(this),o.push('</select></div><div class="group"><h2>'+jade.escape(null==(r=t("settings sync title"))?"":r)+"</h2><p>"+jade.escape(null==(r=t("settings sync gplay"))?"":r)+'<a target="_blank" href="https://play.google.com/store/apps/details?id=io.cozy.files_client"><img'+jade.attr("alt",t("settings sync gplay get it"),!0,!1)+jade.attr("src","//developer.android.com/images/brand/"+c+"_generic_rgb_wo_60.png",!0,!1)+"/></a></p><p>"+(null==(r=t("settings sync carddav",{link:"https://cozy.io/mobile/contacts.html"}).replace(/\[(.+)\]\((.+)\)/i,'<a target="_blank" href="$2">$1</a>'))?"":r)+"</p></div></div></div>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/tools/context_actions",function(e,r,o){var n=function(e){var r,o=[],n=e||{},a=n.selected;return o.push("<legend>"+jade.escape(null==(r=t("tools contextual selected",{smart_count:a.length}))?"":r)+'</legend><nav><ul><li><button formaction="select/all">'+jade.escape(null==(r=t("tools contextual select all"))?"":r)+'</button></li><li><button formaction="select/none">'+jade.escape(null==(r=t("tools contextual select none"))?"":r)+'</button></li></ul></nav><nav><ul><li><button formaction="contacts/merge"><i class="fa fa-code-fork"></i>'+jade.escape(null==(r=t("tools contextual merge"))?"":r)+'</button></li><li><button formaction="contacts/export"><i class="fa fa-upload"></i>'+jade.escape(null==(r=t("tools contextual export"))?"":r)+'</button></li><li><button formaction="contacts/delete"><i class="fa fa-trash"></i>'+jade.escape(null==(r=t("tools contextual delete"))?"":r)+"</button></li></ul></nav>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/tools/default_actions",function(e,r,o){var n=function(e){var r,o=[];return o.push('<nav><ul><li><a href="contacts/new" role="button" class="add secondary"><div class="fa fa-plus"></div><span>'+jade.escape(null==(r=t("tools actions add contact"))?"":r)+'</span></a></li><li><a href="contacts/duplicates" role="button" class="add secondary"><div class="fa fa-code-fork"></div><span>'+jade.escape(null==(r=t("tools actions find duplicates"))?"":r)+"</span></a></li></ul></nav>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/tools/search",function(e,r,o){var n=function(e){var r=[];return r.push('<span class="fa fa-search"></span><button class="fa fa-times clear"></button><input type="text" id="contacts-search"'+jade.attr("placeholder",t("tools search placeholder"),!0,!1)+' autocomplete="off"/>'),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof o&&o&&o.exports&&(o.exports=n)}),require.register("views/templates/tools/toolbar",function(t,e,r){var o=function(t){var e=[];return e.push('<button class="drawer-toggle"><i class="fa fa-bars"></i></button>'),e.join("")};"function"==typeof define&&define.amd?define([],function(){return o}):"object"==typeof r&&r&&r.exports&&(r.exports=o)}),require.register("views/tools/context_actions",function(e,r,o){var n,a=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,s=function(t,e){function r(){this.constructor=t}for(var o in e)i.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o.exports=n=function(e){function o(){return this._deleteModalCfg=a(this._deleteModalCfg,this),o.__super__.constructor.apply(this,arguments)}return s(o,e),o.prototype.template=r("views/templates/tools/context_actions"),o.prototype.tagName="fieldset",o.prototype.behaviors=function(){return{Confirm:{triggers:{"click @ui.delete":this._deleteModalCfg}}}},o.prototype.ui={select:'[formaction="select/all"]',unselect:'[formaction="select/none"]',merge:'[formaction="contacts/merge"]',"export":'[formaction="contacts/export"]',"delete":'[formaction="contacts/delete"]'},o.prototype.triggers={"click @ui.select":"select:all","click @ui.unselect":"select:none","click @ui.export":"bulk:export","click @ui.merge":"bulk:merge"},o.prototype.modelEvents={"change:selected":function(t,e){return e.length?this.render():void 0}},o.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},o.prototype._deleteModalCfg=function(){var e,r;return r={smart_count:this.model.get("selected").length},e={event:"bulk:delete",title:t("bulk confirm delete title",r),message:t("bulk confirm delete message",r),btn_ok:t("bulk confirm delete ok"),btn_cancel:t("bulk confirm delete cancel")}},o}(Mn.ItemView)}),require.register("views/tools/default_actions",function(t,e,r){var o,n={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var o in e)n.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.template=e("views/templates/tools/default_actions"),r.prototype.tagName="fieldset",r}(Mn.ItemView)}),require.register("views/tools/search",function(t,e,r){var o,n=function(t,e){return function(){return t.apply(e,arguments)}},a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};r.exports=o=function(t){function r(){return this.updateSearch=n(this.updateSearch,this),r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.template=e("views/templates/tools/search"),r.prototype.tagName="label",r.prototype.className="empty",r.prototype.attributes={"for":"contacts-search"},r.prototype.ui={search:"input",clear:"button.clear"},r.prototype.events=function(){var t;return t=_.debounce(this.updateSearch,450),{"keyup @ui.search":function(e){var r;return r=e.currentTarget.value,this.toggleUi(r),t(r)},"click @ui.clear":this.clearSearch}},r.prototype.updateSearch=function(t){var r;return _.isEmpty(t)&&(t=null,this.toggleUi()),r=e("application"),r.search("text",t)},r.prototype.clearSearch=function(){return this.ui.search.val(""),this.toggleUi(),this.updateSearch()},r.prototype.onDomRefresh=function(){return this.ui.search.focus()},r.prototype.toggleUi=function(t){return this.$el.toggleClass("empty",_.isEmpty(t))},r}(Mn.ItemView)}),require.register("views/tools/toolbar",function(t,e,r){var o,n,a={}.hasOwnProperty,i=function(t,e){function r(){this.constructor=t}for(var o in e)a.call(e,o)&&(t[o]=e[o]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o=e("views/tools/search"),r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return i(r,t),r.prototype.template=e("views/templates/tools/toolbar"),r.prototype.ui={drawer:".drawer-toggle"},r.prototype.triggers={"click @ui.drawer":"drawer:toggle"},r.prototype.onRender=function(){return(new o).render().$el.appendTo(this.$el)},r}(Mn.ItemView)});