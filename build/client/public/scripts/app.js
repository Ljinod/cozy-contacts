!function(){"use strict";var t="undefined"==typeof window?global:window;if("function"!=typeof t.require){var e={},o={},r={}.hasOwnProperty,n={},a=function(t,e){var o=0;e&&(e.indexOf(!1)&&(o="components/".length),e.indexOf("/",o)>0&&(e=e.substring(o,e.indexOf("/",o))));var r=n[t+"/index.js"]||n[e+"/deps/"+t+"/index.js"];return r?"components/"+r.substring(0,r.length-".js".length):t},i=function(){var t=/^\.\.?(\/|$)/;return function(e,o){var r,n,a=[];r=(t.test(o)?e+"/"+o:o).split("/");for(var i=0,s=r.length;s>i;i++)n=r[i],".."===n?a.pop():"."!==n&&""!==n&&a.push(n);return a.join("/")}}(),s=function(t){return t.split("/").slice(0,-1).join("/")},c=function(e){return function(o){var r=i(s(e),o);return t.require(r,e)}},l=function(t,e){var r={id:t,exports:{}};return o[t]=r,e(r.exports,c(t),r),r.exports},u=function(t,n){var s=i(t,".");if(null==n&&(n="/"),s=a(t,n),r.call(o,s))return o[s].exports;if(r.call(e,s))return l(s,e[s]);var c=i(s,"./index");if(r.call(o,c))return o[c].exports;if(r.call(e,c))return l(c,e[c]);throw new Error('Cannot find module "'+t+'" from "'+n+'"')};u.alias=function(t,e){n[e]=t},u.register=u.define=function(t,o){if("object"==typeof t)for(var n in t)r.call(t,n)&&(e[n]=t[n]);else e[t]=o},u.list=function(){var t=[];for(var o in e)r.call(e,o)&&t.push(o);return t},u.brunch=!0,t.require=u}}(),require.register("application",function(t,e,o){var r,n,a,i,s,c,l,u,p,d={}.hasOwnProperty,f=function(t,e){function o(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};l=e("routes"),i=e("models/config"),s=e("collections/contacts"),p=e("collections/tags"),u=e("collections/search"),r=e("views/app_layout"),n=e("views/models/app"),c=e("lib/intent_manager"),a=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return f(o,t),o.prototype.initialize=function(){return this.on("before:start",function(){var t;return t=new i(e("imports").config),this.model=new n(null,{model:t}),this.contacts=new s,this.tags=new p,this.filtered=new u(this.contacts),this.layout=new r({model:this.model}),this.router=new l,this.intentManager=new c,"function"==typeof Object.freeze?Object.freeze(this):void 0}),this.on("start",function(){return this.contacts.fetch({reset:!0}),this.tags.fetch({reset:!0}),this.layout.render(),Backbone.history?Backbone.history.start({pushState:!1}):void 0})},o.prototype.search=function(t,o){var r,n,a;return r=this.model.get("filter"),n="`"+t+":"+o+"`",t=e("config").search.pattern(t),a=null!=r?r.match(t):void 0,o?a?r=r.replace(t,n):(null!=r?r.length:void 0)?r+=n:r=n:a&&(r=r.replace(t,"")),this.model.set("filter",r)},o}(Mn.Application),o.exports=new a}),require.register("collections/charindex",function(t,e,o){var r,n,a,i,s,c={}.hasOwnProperty,l=function(t,e){function o(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};n=BackboneProjections.Filtered,s=e("lib/diacritics"),i=s.asciize,a=s.alphabet,o.exports=r=function(t){function o(t,r){var n;n=e("application"),r.filter=function(t){var e,o,n,s,c,l;return n=i(t.attributes.n).toLowerCase(),"fn"===r.filter.sort?(c=n.split(";"),s=c[0],e=c[1]):(l=n.split(";"),e=l[0],s=l[1]),o=e?e[0]:s?s[0]:"#","#"===r["char"]?!o.match(a):r["char"]===o},r.filter.sort=n.model.get("sort"),o.__super__.constructor.apply(this,arguments),this.stopListening(this.underlying,"sort"),this.listenTo(t,"sort",function(){return _.defer(function(t){return function(){return r.filter.sort=n.model.get("sort"),t.reset(t.underlying.models.filter(t.options.filter))}}(this))})}return l(o,t),o}(n)}),require.register("collections/contacts",function(t,e,o){var r,n,a,i={}.hasOwnProperty,s=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};n=e("lib/contacts_listener"),a=function(t,e){var o,r,n;return t=t.get("n").split(";"),e=e.get("n").split(";"),o=function(){switch(this.comparator.sort){case"gn":return r=""+t[0]+t[1],n=""+e[0]+e[1];case"fn":return r=""+t[1]+t[0],n=""+e[1]+e[0]}}.call(this),r.localeCompare(n)},o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,t),o.prototype.model=e("models/contact"),o.prototype.url="contacts",o.prototype.initialize=function(){var t;return t=e("application"),this.comparator=a,this.comparator.sort=t.model.get("sort"),this.listenTo(t.model,"change:sort",function(t,e){return this.comparator.sort=e,this.sort()}),this.listenToOnce(this,"sync",function(){return(new n).watch(this)})},o.prototype.importFromVCF=function(t){var e,o,r;return o=0,e=t.split(/END:VCARD[\r\n]{0,2}/gi).filter(function(t){return!_.isEmpty(t)}).map(function(t){return""+t+"END:VCARD"}),this.trigger("before:import:progress",e.length),r=function(t){return function(){var n,a;return n=e.pop(),n?(a=new VCardParser,a.read(n),t.create(a.contacts[0],{parse:!0}),t.trigger("import:progress",++o),setTimeout(r)):t.trigger("import",o)}}(this),setTimeout(r,35)},o}(Backbone.Collection)}),require.register("collections/duplicates",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=e("lib/compare_contacts"),o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.model=e("views/models/merge"),o.prototype.url=null,o.prototype.initialize=function(t,e){var o,n;return(o=e.collection)?(n=r.findSimilars(o.toJSON()),n.forEach(function(t){return function(e){return e=e.map(function(t){return o.get(t.id)}),t.add({candidates:e})}}(this))):void 0},o}(Backbone.Collection)}),require.register("collections/search",function(t,e,o){var r,n,a=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,s=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=BackboneProjections.Filtered,o.exports=n=function(t){function o(t,r){var n;null==r&&(r={}),this.filter=a(this.filter,this),n=e("application"),this.search=n.model.get("filter"),this.scores={},r.filter=this.filter,o.__super__.constructor.call(this,t,r),this.listenTo(n.model,"change:filter",function(t,e){return this.search=e,this.update()})}return s(o,t),o.prototype.filter=function(t){var o,r;return o=null!=(r=this.search)?r.match(e("config").search.pattern()):void 0,o?o.reduce(function(e){return function(o,r){var n,a,i,s;return s=r.slice(1,-1).split(":"),a=s[0],i=s[1],n=function(){switch(a){case"tag":return _.contains(t.attributes.tags,i);case"text":return t.match(i,{fullsearch:!0});default:return!0}}(),(null!=n?n.score:void 0)&&(e.scores[t.id]=n.score),n||(o=!1),o}}(this),!0):!0},o.prototype.update=function(){return this.search?this.reset(this.underlying.models.filter(this.options.filter)):this.reset(this.underlying.models)},o}(r)}),require.register("collections/tags",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};n=e("lib/tags_listener"),o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.model=e("models/tag"),o.prototype.url="tags",o.prototype.initialize=function(){return this.listenToOnce(this,"sync",function(){return(new n).watch(this)})},o.prototype.parse=function(t){return _.uniq(t,function(t){return t.name.toLowerCase()})},o}(Backbone.Collection)}),require.register("config",function(t,e,o){o.exports={contact:{xtras:["bday"],datapoints:{main:["tel","email","adr"],types:{"default":["main","work","home"],social:["twitter:social","skype:chat"],url:["website","blog"]}}},settings:{sortkeys:["gn","fn"]},colorSet:["304FFE","2979FF","00B0FF","00DCE9","00D5B8","00C853","E70505","FF5700","FF7900","FFA300","B3C51D","64DD17","FF2828","F819AA","AA00FF","6200EA","7190AB","51658D"],search:{pattern:function(t,e){return e=t?"i":"ig",new RegExp("`"+(t||"\\w+")+":([^`]+)`",e)}}}}),require.register("initialize",function(t,e,o){var r;window.onerror=function(t,e,o,r,n){var a,i,s;return console.error(t,e,o,r,n,null!=n?n.stack:void 0),i=(null!=n?n.toString():void 0)||t,i!==window.lastError?(a={data:{type:"error",error:{msg:t,name:null!=n?n.name:void 0,full:i,stack:null!=n?n.stack:void 0},url:e,line:o,col:r,href:window.location.href}},s=new XMLHttpRequest,s.open("POST","log",!0),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.send(JSON.stringify(a)),window.lastError=i):void 0},r=e("./application"),$(function(){return ColorHash.addScheme("cozy",e("config").colorSet),Mn.Behaviors.behaviorsLookup=e("lib/behaviors"),window.t=e("lib/i18n"),r.start()})}),require.register("lib/behaviors/confirm",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};n=e("lib/views/confirm"),o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.ui={confirms:"[data-confirm]"},o.prototype.events={"click @ui.confirms":"confirm"},o.prototype.initialize=function(t){return this.events=_.extend({},this.events,this._buildTriggers())},o.prototype.confirm=function(t){var e;return t.preventDefault(),t.stopPropagation(),e=this.$(t.currentTarget).data("confirm"),this._triggerView(e)},o.prototype._buildTriggers=function(){var t;return t=this.view,_.reduce(this.options.triggers,function(t,e,o){var r,n;return n=function(){return _.defaults({},_.isFunction(e)?e():e,{preventDefault:!0,stopPropagation:!0})},_.isFunction(e)||(r=n()),t[o]=function(t){var o;return _.isFunction(e)&&(r=n()),t&&(t.preventDefault&&r.preventDefault&&t.preventDefault(),t.stopPropagation&&r.stopPropagation&&t.stopPropagation()),o=this._triggerView(r)},t},{})},o.prototype._triggerView=function(t){var o,r,a;return o=e("application"),a=_.pick(t,"title","message","btn_ok","btn_cancel"),r=new n({model:new Backbone.Model(a)}),this.view.$el.attr("aria-busy",!0),Mn.bindEntityEvents(this,r,{"confirm:close":function(){return this.view.$el.attr("aria-busy",!1),this.view.triggerMethod("confirm:close")},"confirm:true":function(){return this.view.triggerMethod("confirm:true"),t.event?this.view.triggerMethod(t.event):void 0}}),o.layout.showChildView("alerts",r),r},o}(Mn.Behavior)}),require.register("lib/behaviors/dialog",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.behaviors={Keyboard:{keymaps:{27:"key:escape"}}},e.prototype.ui={backdrop:"[role=separator]",content:"[role=contentinfo]"},e.prototype.triggers={"click @ui.backdrop":"click:backdrop"},e.prototype.events={"click @ui.content":"detectClickOutside"},e.prototype.initialize=function(){return this.listenTo(this.view,"click:backdrop",this.close),this.listenTo(this.view,"key:escape",this.close)},e.prototype.close=function(){return this.view.triggerMethod("dialog:close")},e.prototype.detectClickOutside=function(t){var e,o,r;if(t.pageX||t.pageY)return e=this.ui.content[0].getBoundingClientRect(),r=t.pageX<e.left||t.pageX>e.right,o=t.pageY<e.top||t.pageY>e.bottom,o&&r?this.close():void 0},e}(Mn.Behavior)}),require.register("lib/behaviors/dropdown",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.ui={trigger:"[aria-haspopup=true] > :first-child"},e.prototype.events={"click @ui.trigger":"toggleExpand",click:"closeAll"},e.prototype.toggleExpand=function(t){var e;return t.stopPropagation(),e=this.$(t.currentTarget).parent("[aria-haspopup]"),this.closeAll(e),e.attr("aria-expanded","true"!==e.attr("aria-expanded"))},e.prototype.closeAll=function(t){return this.$("[aria-haspopup=true]").not(t).attr("aria-expanded",!1)},e}(Mn.Behavior)}),require.register("lib/behaviors/form",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.behaviors={Keyboard:{keymaps:{13:{event:"form:key:enter",preventDefault:!1}}}},e.prototype.events=function(){return{"click @ui.formAdd":"addField","keyup @ui.formAutoAdd":"addField","keyup @ui.formInputs":_.debounce(this.updateFields,250),"change @ui.formInputs":"updateFields","click @ui.formClear":"clearField","click @ui.formDelete":"deleteField"}},e.prototype.triggers={"click @ui.formSubmit":"form:submit"},e.prototype.updateFields=function(t,e){var o,r;return null==e&&(e=t.currentTarget),(o={}).setValueOf(e.name,e.value),null!=(r=this.view.model)&&r.set(o,{silent:!0}),e.classList.toggle("empty",""===e.value),this.view.triggerMethod("form:field:update",e,t)},e.prototype.addField=function(t){var e,o,r;return"click"===t.type?this.view.triggerMethod("form:field:add",t.currentTarget.value):(e=this.$(t.currentTarget).parents("[data-type]"),r=e.data("type"),(o=!!e.find(".value").filter(function(){return!this.value}).length)?void 0:this.view.triggerMethod("form:field:add",r))},e.prototype.clearField=function(t){var e;return e=this.$(t.currentTarget).prev(".value"),e.val(null),this.view.triggerMethod("form:field:clear",t),this.updateFields(t,e[0])},e.prototype.deleteField=function(t){var e;return e=this.$(t.currentTarget).parents("[data-cid]").data("cid"),this.view.triggerMethod("form:field:delete",e,t)},e}(Mn.Behavior)}),require.register("lib/behaviors/index",function(t,e,o){var r;r={Confirm:e("./confirm"),Dialog:e("./dialog"),Dropdown:e("./dropdown"),Form:e("./form"),Keyboard:e("./keyboard"),Navigator:e("./navigator"),PickAvatar:e("./pickavatar")},o.exports=r}),require.register("lib/behaviors/keyboard",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},i=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};o.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults={eventName:"keydown"},e.prototype.events=function(){var t,e;if(this.options.keymaps)return e=_.mapObject(this.options.keymaps,this._buildKeyboardTrigger),(t={})[this.options.eventName]=function(t){return function(o){var r;return r=o.which.toString(),i.call(_.keys(e),r)<0?void 0:e[r].call(t,o)}}(this),t},e.prototype._buildKeyboardTrigger=function(t){var e,o,r;return o=_.isObject(t),r=_.defaults({},o?t:{},{preventDefault:!0,stopPropagation:!0}),e=o?r.event:t,function(t){return t&&(t.preventDefault&&r.preventDefault&&t.preventDefault(),t.stopPropagation&&r.stopPropagation&&t.stopPropagation()),this.view.triggerMethod(e,t)}},e}(Mn.Behavior)}),require.register("lib/behaviors/navigator",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.behaviors={Confirm:{}},o.prototype.events={"click @ui.navigate":"navigate"},o.prototype.navigate=function(t){var o;return t.preventDefault(),o=function(){var o,r;return r=t.currentTarget,o=r.dataset.next||r.getAttribute("href"),e("application").router.navigate(o,{trigger:!0})},t.currentTarget.dataset.confirm?Mn.bindEntityEvents(this,this.view,{"confirm:true":o,"confirm:close":function(){return Mn.unbindEntityEvents(this,this.view)}}):o()},o}(Mn.Behavior)}),require.register("lib/behaviors/pickavatar",function(t,e,o){var r,n=function(t,e){return function(){return t.apply(e,arguments)}},a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return this.choosePhoto_answer=n(this.choosePhoto_answer,this),this.choosePhoto=n(this.choosePhoto,this),o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.events=function(){return{"click @ui.avatar":"choosePhoto"}},o.prototype.choosePhoto=function(){var t,o,r;return t=e("application"),o={type:"pickObject",params:{objectType:"singlePhoto",isCropped:!0,proportion:1,maxWidth:10,minWidth:10}},r=108e5,t.intentManager.send("nameSpace",o,r).then(this.choosePhoto_answer,function(t){return console.error("contact : response in error : ",t)})},o.prototype.choosePhoto_answer=function(t){var e,o;return e=t.data,e.newPhotoChosen&&null!=(o=this.view.model)?o.set("avatar",e.dataUrl):void 0},o}(Mn.Behavior)}),require.register("lib/compare_contacts",function(t,e,o){var r,n,a,i,s,c,l;i=e("lib/diacritics"),n=e("lib/contact_helper"),o.exports=r={},r.isSamePerson=function(t,e){return t.fn===e.fn&&t.datapoints.some(function(t){var o;return"tel"===(o=t.name)||"adr"===o||"email"===o||"chat"===o?s(t,e):!1})},r.mayBeSamePerson=function(t,e){return a(t.n,e.n)>0},r.findSimilars=function(t){var e,o,n,a,i,s,c,l,u;for(i={},a=[],s=0,l=t.length;l>s;s++){for(e=t[s],i[e._id]=!0,n=[e],c=0,u=t.length;u>c;c++)o=t[c],o._id in i||!r.mayBeSamePerson(e,o)||(i[o._id]=!0,n.push(o));n.length>1&&a.push(n)}return a},r.mergeContacts=function(t,e){return e.datapoints.forEach(function(e){return s(e,t,!0)?void 0:t.datapoints.push(e)}),delete e.datapoints,null!=e.accounts&&(e.accounts.forEach(function(e){return n.hasAccount(t,e.type,e.name)?void 0:n.setAccount(t,e)}),delete e.accounts),t.tags=l(t.tags,e.tags),delete e.tags,null!=e.note&&""!==e.note&&null!=t.note&&""!==t.note&&(t.note+="\n"+e.note),delete e.note,t=c(t,e)},a=function(t,e){var o,r,n,a,s,c,l,u;return l=t.split(";"),a=l[0],r=l[1],o=l[2],o=l[3],o=l[4],u=e.split(";"),s=u[0],n=u[1],o=u[2],o=u[3],o=u[4],c=function(t){return t=i.asciize(t),t.toLowerCase()},a=c(a),r=c(r),s=c(s),n=c(n),""===a&&""===r||""===s&&""===n||!(a===s&&r===n||a===n&&r===s)?-1:1},s=function(t,e,o){return null==o&&(o=!1),null==t.value?!1:e.datapoints.some(function(e){var r,n,a;if(t.name===e.name&&(!o||o&&t.type===e.type)&&null!=e.value){if("tel"===t.name)return t.value.replace(/[-\s]/g,"")===e.value.replace(/[-\s]/g,"");if("adr"===t.name){for(n=!0,r=0;n&&7>r;)n=n&&t.value[r]===e.value[r]||""===t.value[r]&&null==e.value[r]||!(null!=(a=t.value)?a[r]:void 0)&&""===e.value[r],r++;return n}return t.value===e.value}return!1})},l=function(t,e){return t=t||[],e=e||[],t.concat(e.filter(function(e){return t.indexOf(e)<0}))},c=function(t,e){var o,r;for(o in e)r=e[o],null!=r&&(t[o]=r);return t}}),require.register("lib/contact_helper",function(t,e,o){var r,n,a=[].slice;o.exports=r={},r.nToFN=function(t){var e,o,r,n,a,i;return t=t||[],e=t[0],o=t[1],r=t[2],a=t[3],i=t[4],n=[a,o,r,e,i],n=n.filter(function(t){return null!=t&&""!==t}),n.join(" ")},r.fnToN=function(t){return t=t||"",["",t,"","",""]},r.fnToNLastnameNFirstname=function(t){var e,o,r,n,i,s;return t=t||"",s=t.split(" "),o=s[0],r=3<=s.length?a.call(s,1,i=s.length-1):(i=1,[]),e=s[i++],n=[e,o,r.join(" "),"",""]},n=function(t){return t=t.filter(function(t){return null!=t&&""!==t}),t.join(", ")},r.adrArrayToString=function(t){var e,o,r;return t=t||[],r=n(t.slice(0,3)),e=n(t.slice(3,7)),o=r,""!==e&&(o+="\n"+e),o},r.adrCompleteStreet=function(t){return t=t||[],n(t.slice(0,3))},r.adrStringToArray=function(t){return t=t||"",["","",t,"","","",""]},r.imgUrl2DataUrl=function(t,e){var o;return o=new Image,o.onload=function(){var t,r,n,a,i,s;return t=600,s=o.width>o.height?"height":"width",i=t/o[s],r=document.createElement("canvas"),r.height=r.width=t,n=r.getContext("2d"),n.drawImage(o,0,0,i*o.width,i*o.height),a=r.toDataURL("image/jpeg"),e(null,a)},o.src=t},r.getAccount=function(t,e,o){var r;return null==t.accounts?null:(r=t.accounts.filter(function(t){return t.type===e&&t.name===o}),r.length>0?r[0]:null)},r.setAccount=function(t,e){var o,n,a,i;if(o=r.getAccount(t,e.type,e.name),null!=o){i=[];for(n in e)a=e[n],i.push(o[n]=a);return i}return t.accounts=t.accounts||[],t.accounts.push(e)},r.deleteAccount=function(t,e){var o,r,n,a,i;for(i=t.accounts,r=n=0,a=i.length;a>n;r=++n)if(o=i[r],o.type===e.type&&o.name===e.name)return contacts.accounts.splice(r,1),!0;return!1},r.hasAccount=function(t,e,o){return null!=r.getAccount(t,e,o)},r.intrinsicRev=function(t){var e,o,n,a,i,s;for(n=["fn","n","org","title","bday","nickname","url","note"],e="",i=0,s=n.length;s>i;i++)o=n[i],o in t&&null!=t[o]&&""!==t[o]&&(e+=o,e+=": ",e+=t[o],e+=", ");return a=t.datapoints.map(function(t){var e,o;return e="name:"+t.name+", type:"+t.type+", value: ",e+="adr"===t.name?r.adrArrayToString(t.value):"tel"===t.name?null!=(o=t.value)?o.replace(/[^\d+]/g,""):void 0:t.value}),a.sort(),e+="datapoints: "+a.join(", ")}}),require.register("lib/contacts_listener",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=e("models/contact"),o.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.models={contact:r},e.prototype.events=["contact.create","contact.update","contact.delete"],e.prototype.onRemoteCreate=function(t){return this.collection.add(t,{merge:!0})},e.prototype.onRemoteUpdate=function(t){return this.collection.add(t,{merge:!0})},e.prototype.onRemoteDelete=function(t){return this.collection.remove(t)},e}(CozySocketListener)}),require.register("lib/diacritics",function(t,e,o){var r,n,a;r=/[\u0041-\u005A\u0061-\u007A]/g,a={"Á":"A","Ă":"A","Ắ":"A","Ặ":"A","Ằ":"A","Ẳ":"A","Ẵ":"A","Ǎ":"A","Â":"A","Ấ":"A","Ậ":"A","Ầ":"A","Ẩ":"A","Ẫ":"A","Ä":"A","Ǟ":"A","Ȧ":"A","Ǡ":"A","Ạ":"A","Ȁ":"A","À":"A","Ả":"A","Ȃ":"A","Ā":"A","Ą":"A","Å":"A","Ǻ":"A","Ḁ":"A","Ⱥ":"A","Ã":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ḃ":"B","Ḅ":"B","Ɓ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ć":"C","Č":"C","Ç":"C","Ḉ":"C","Ĉ":"C","Ċ":"C","Ƈ":"C","Ȼ":"C","Ď":"D","Ḑ":"D","Ḓ":"D","Ḋ":"D","Ḍ":"D","Ɗ":"D","Ḏ":"D","ǲ":"D","ǅ":"D","Đ":"D","Ƌ":"D","Ǳ":"DZ","Ǆ":"DZ","É":"E","Ĕ":"E","Ě":"E","Ȩ":"E","Ḝ":"E","Ê":"E","Ế":"E","Ệ":"E","Ề":"E","Ể":"E","Ễ":"E","Ḙ":"E","Ë":"E","Ė":"E","Ẹ":"E","Ȅ":"E","È":"E","Ẻ":"E","Ȇ":"E","Ē":"E","Ḗ":"E","Ḕ":"E","Ę":"E","Ɇ":"E","Ẽ":"E","Ḛ":"E","Ꝫ":"ET","Ḟ":"F","Ƒ":"F","Ǵ":"G","Ğ":"G","Ǧ":"G","Ģ":"G","Ĝ":"G","Ġ":"G","Ɠ":"G","Ḡ":"G","Ǥ":"G","Ḫ":"H","Ȟ":"H","Ḩ":"H","Ĥ":"H","Ⱨ":"H","Ḧ":"H","Ḣ":"H","Ḥ":"H","Ħ":"H","Í":"I","Ĭ":"I","Ǐ":"I","Î":"I","Ï":"I","Ḯ":"I","İ":"I","Ị":"I","Ȉ":"I","Ì":"I","Ỉ":"I","Ȋ":"I","Ī":"I","Į":"I","Ɨ":"I","Ĩ":"I","Ḭ":"I","Ꝺ":"D","Ꝼ":"F","Ᵹ":"G","Ꞃ":"R","Ꞅ":"S","Ꞇ":"T","Ꝭ":"IS","Ĵ":"J","Ɉ":"J","Ḱ":"K","Ǩ":"K","Ķ":"K","Ⱪ":"K","Ꝃ":"K","Ḳ":"K","Ƙ":"K","Ḵ":"K","Ꝁ":"K","Ꝅ":"K","Ĺ":"L","Ƚ":"L","Ľ":"L","Ļ":"L","Ḽ":"L","Ḷ":"L","Ḹ":"L","Ⱡ":"L","Ꝉ":"L","Ḻ":"L","Ŀ":"L","Ɫ":"L","ǈ":"L","Ł":"L","Ǉ":"LJ","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ń":"N","Ň":"N","Ņ":"N","Ṋ":"N","Ṅ":"N","Ṇ":"N","Ǹ":"N","Ɲ":"N","Ṉ":"N","Ƞ":"N","ǋ":"N","Ñ":"N","Ǌ":"NJ","Ó":"O","Ŏ":"O","Ǒ":"O","Ô":"O","Ố":"O","Ộ":"O","Ồ":"O","Ổ":"O","Ỗ":"O","Ö":"O","Ȫ":"O","Ȯ":"O","Ȱ":"O","Ọ":"O","Ő":"O","Ȍ":"O","Ò":"O","Ỏ":"O","Ơ":"O","Ớ":"O","Ợ":"O","Ờ":"O","Ở":"O","Ỡ":"O","Ȏ":"O","Ꝋ":"O","Ꝍ":"O","Ō":"O","Ṓ":"O","Ṑ":"O","Ɵ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Õ":"O","Ṍ":"O","Ṏ":"O","Ȭ":"O","Ƣ":"OI","Ꝏ":"OO","Ɛ":"E","Ɔ":"O","Ȣ":"OU","Ṕ":"P","Ṗ":"P","Ꝓ":"P","Ƥ":"P","Ꝕ":"P","Ᵽ":"P","Ꝑ":"P","Ꝙ":"Q","Ꝗ":"Q","Ŕ":"R","Ř":"R","Ŗ":"R","Ṙ":"R","Ṛ":"R","Ṝ":"R","Ȑ":"R","Ȓ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꜿ":"C","Ǝ":"E","Ś":"S","Ṥ":"S","Š":"S","Ṧ":"S","Ş":"S","Ŝ":"S","Ș":"S","Ṡ":"S","Ṣ":"S","Ṩ":"S","ẞ":"SS","Ť":"T","Ţ":"T","Ṱ":"T","Ț":"T","Ⱦ":"T","Ṫ":"T","Ṭ":"T","Ƭ":"T","Ṯ":"T","Ʈ":"T","Ŧ":"T","Ɐ":"A","Ꞁ":"L","Ɯ":"M","Ʌ":"V","Ꜩ":"TZ","Ú":"U","Ŭ":"U","Ǔ":"U","Û":"U","Ṷ":"U","Ü":"U","Ǘ":"U","Ǚ":"U","Ǜ":"U","Ǖ":"U","Ṳ":"U","Ụ":"U","Ű":"U","Ȕ":"U","Ù":"U","Ủ":"U","Ư":"U","Ứ":"U","Ự":"U","Ừ":"U","Ử":"U","Ữ":"U","Ȗ":"U","Ū":"U","Ṻ":"U","Ų":"U","Ů":"U","Ũ":"U","Ṹ":"U","Ṵ":"U","Ꝟ":"V","Ṿ":"V","Ʋ":"V","Ṽ":"V","Ꝡ":"VY","Ẃ":"W","Ŵ":"W","Ẅ":"W","Ẇ":"W","Ẉ":"W","Ẁ":"W","Ⱳ":"W","Ẍ":"X","Ẋ":"X","Ý":"Y","Ŷ":"Y","Ÿ":"Y","Ẏ":"Y","Ỵ":"Y","Ỳ":"Y","Ƴ":"Y","Ỷ":"Y","Ỿ":"Y","Ȳ":"Y","Ɏ":"Y","Ỹ":"Y","Ź":"Z","Ž":"Z","Ẑ":"Z","Ⱬ":"Z","Ż":"Z","Ẓ":"Z","Ȥ":"Z","Ẕ":"Z","Ƶ":"Z","Ĳ":"IJ","Œ":"OE","ᴀ":"A","ᴁ":"AE","ʙ":"B","ᴃ":"B","ᴄ":"C","ᴅ":"D","ᴇ":"E","ꜰ":"F","ɢ":"G","ʛ":"G","ʜ":"H","ɪ":"I","ʁ":"R","ᴊ":"J","ᴋ":"K","ʟ":"L","ᴌ":"L","ᴍ":"M","ɴ":"N","ᴏ":"O","ɶ":"OE","ᴐ":"O","ᴕ":"OU","ᴘ":"P","ʀ":"R","ᴎ":"N","ᴙ":"R","ꜱ":"S","ᴛ":"T","ⱻ":"E","ᴚ":"R","ᴜ":"U","ᴠ":"V","ᴡ":"W","ʏ":"Y","ᴢ":"Z","á":"a","ă":"a","ắ":"a","ặ":"a","ằ":"a","ẳ":"a","ẵ":"a","ǎ":"a","â":"a","ấ":"a","ậ":"a","ầ":"a","ẩ":"a","ẫ":"a","ä":"a","ǟ":"a","ȧ":"a","ǡ":"a","ạ":"a","ȁ":"a","à":"a","ả":"a","ȃ":"a","ā":"a","ą":"a","ᶏ":"a","ẚ":"a","å":"a","ǻ":"a","ḁ":"a","ⱥ":"a","ã":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ḃ":"b","ḅ":"b","ɓ":"b","ḇ":"b","ᵬ":"b","ᶀ":"b","ƀ":"b","ƃ":"b","ɵ":"o","ć":"c","č":"c","ç":"c","ḉ":"c","ĉ":"c","ɕ":"c","ċ":"c","ƈ":"c","ȼ":"c","ď":"d","ḑ":"d","ḓ":"d","ȡ":"d","ḋ":"d","ḍ":"d","ɗ":"d","ᶑ":"d","ḏ":"d","ᵭ":"d","ᶁ":"d","đ":"d","ɖ":"d","ƌ":"d","ı":"i","ȷ":"j","ɟ":"j","ʄ":"j","ǳ":"dz","ǆ":"dz","é":"e","ĕ":"e","ě":"e","ȩ":"e","ḝ":"e","ê":"e","ế":"e","ệ":"e","ề":"e","ể":"e","ễ":"e","ḙ":"e","ë":"e","ė":"e","ẹ":"e","ȅ":"e","è":"e","ẻ":"e","ȇ":"e","ē":"e","ḗ":"e","ḕ":"e","ⱸ":"e","ę":"e","ᶒ":"e","ɇ":"e","ẽ":"e","ḛ":"e","ꝫ":"et","ḟ":"f","ƒ":"f","ᵮ":"f","ᶂ":"f","ǵ":"g","ğ":"g","ǧ":"g","ģ":"g","ĝ":"g","ġ":"g","ɠ":"g","ḡ":"g","ᶃ":"g","ǥ":"g","ḫ":"h","ȟ":"h","ḩ":"h","ĥ":"h","ⱨ":"h","ḧ":"h","ḣ":"h","ḥ":"h","ɦ":"h","ẖ":"h","ħ":"h","ƕ":"hv","í":"i","ĭ":"i","ǐ":"i","î":"i","ï":"i","ḯ":"i","ị":"i","ȉ":"i","ì":"i","ỉ":"i","ȋ":"i","ī":"i","į":"i","ᶖ":"i","ɨ":"i","ĩ":"i","ḭ":"i","ꝺ":"d","ꝼ":"f","ᵹ":"g","ꞃ":"r","ꞅ":"s","ꞇ":"t","ꝭ":"is","ǰ":"j","ĵ":"j","ʝ":"j","ɉ":"j","ḱ":"k","ǩ":"k","ķ":"k","ⱪ":"k","ꝃ":"k","ḳ":"k","ƙ":"k","ḵ":"k","ᶄ":"k","ꝁ":"k","ꝅ":"k","ĺ":"l","ƚ":"l","ɬ":"l","ľ":"l","ļ":"l","ḽ":"l","ȴ":"l","ḷ":"l","ḹ":"l","ⱡ":"l","ꝉ":"l","ḻ":"l","ŀ":"l","ɫ":"l","ᶅ":"l","ɭ":"l","ł":"l","ǉ":"lj","ſ":"s","ẜ":"s","ẛ":"s","ẝ":"s","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ᵯ":"m","ᶆ":"m","ń":"n","ň":"n","ņ":"n","ṋ":"n","ȵ":"n","ṅ":"n","ṇ":"n","ǹ":"n","ɲ":"n","ṉ":"n","ƞ":"n","ᵰ":"n","ᶇ":"n","ɳ":"n","ñ":"n","ǌ":"nj","ó":"o","ŏ":"o","ǒ":"o","ô":"o","ố":"o","ộ":"o","ồ":"o","ổ":"o","ỗ":"o","ö":"o","ȫ":"o","ȯ":"o","ȱ":"o","ọ":"o","ő":"o","ȍ":"o","ò":"o","ỏ":"o","ơ":"o","ớ":"o","ợ":"o","ờ":"o","ở":"o","ỡ":"o","ȏ":"o","ꝋ":"o","ꝍ":"o","ⱺ":"o","ō":"o","ṓ":"o","ṑ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","õ":"o","ṍ":"o","ṏ":"o","ȭ":"o","ƣ":"oi","ꝏ":"oo","ɛ":"e","ᶓ":"e","ɔ":"o","ᶗ":"o","ȣ":"ou","ṕ":"p","ṗ":"p","ꝓ":"p","ƥ":"p","ᵱ":"p","ᶈ":"p","ꝕ":"p","ᵽ":"p","ꝑ":"p","ꝙ":"q","ʠ":"q","ɋ":"q","ꝗ":"q","ŕ":"r","ř":"r","ŗ":"r","ṙ":"r","ṛ":"r","ṝ":"r","ȑ":"r","ɾ":"r","ᵳ":"r","ȓ":"r","ṟ":"r","ɼ":"r","ᵲ":"r","ᶉ":"r","ɍ":"r","ɽ":"r","ↄ":"c","ꜿ":"c","ɘ":"e","ɿ":"r","ś":"s","ṥ":"s","š":"s","ṧ":"s","ş":"s","ŝ":"s","ș":"s","ṡ":"s","ṣ":"s","ṩ":"s","ʂ":"s","ᵴ":"s","ᶊ":"s","ȿ":"s","ɡ":"g","ß":"ss","ᴑ":"o","ᴓ":"o","ᴝ":"u","ť":"t","ţ":"t","ṱ":"t","ț":"t","ȶ":"t","ẗ":"t","ⱦ":"t","ṫ":"t","ṭ":"t","ƭ":"t","ṯ":"t","ᵵ":"t","ƫ":"t","ʈ":"t","ŧ":"t","ᵺ":"th","ɐ":"a","ᴂ":"ae","ǝ":"e","ᵷ":"g","ɥ":"h","ʮ":"h","ʯ":"h","ᴉ":"i","ʞ":"k","ꞁ":"l","ɯ":"m","ɰ":"m","ᴔ":"oe","ɹ":"r","ɻ":"r","ɺ":"r","ⱹ":"r","ʇ":"t","ʌ":"v","ʍ":"w","ʎ":"y","ꜩ":"tz","ú":"u","ŭ":"u","ǔ":"u","û":"u","ṷ":"u","ü":"u","ǘ":"u","ǚ":"u","ǜ":"u","ǖ":"u","ṳ":"u","ụ":"u","ű":"u","ȕ":"u","ù":"u","ủ":"u","ư":"u","ứ":"u","ự":"u","ừ":"u","ử":"u","ữ":"u","ȗ":"u","ū":"u","ṻ":"u","ų":"u","ᶙ":"u","ů":"u","ũ":"u","ṹ":"u","ṵ":"u","ᵫ":"ue","ꝸ":"um","ⱴ":"v","ꝟ":"v","ṿ":"v","ʋ":"v","ᶌ":"v","ⱱ":"v","ṽ":"v","ꝡ":"vy","ẃ":"w","ŵ":"w","ẅ":"w","ẇ":"w","ẉ":"w","ẁ":"w","ⱳ":"w","ẘ":"w","ẍ":"x","ẋ":"x","ᶍ":"x","ý":"y","ŷ":"y","ÿ":"y","ẏ":"y","ỵ":"y","ỳ":"y","ƴ":"y","ỷ":"y","ỿ":"y","ȳ":"y","ẙ":"y","ɏ":"y","ỹ":"y","ź":"z","ž":"z","ẑ":"z","ʑ":"z","ⱬ":"z","ż":"z","ẓ":"z","ȥ":"z","ẕ":"z","ᵶ":"z","ᶎ":"z","ʐ":"z","ƶ":"z","ɀ":"z","ﬀ":"ff","ﬃ":"ffi","ﬄ":"ffl","ﬁ":"fi","ﬂ":"fl","ĳ":"ij","œ":"oe","ﬆ":"st","ₐ":"a","ₑ":"e","ᵢ":"i","ⱼ":"j","ₒ":"o","ᵣ":"r","ᵤ":"u","ᵥ":"v","ₓ":"x"},n=function(t){return t.replace(/[^A-Za-z0-9\[\] ]/g,function(t){return a[t]||t})},o.exports={alphabet:r,diacritics:a,asciize:n}}),require.register("lib/i18n",function(t,e,o){var r;r=function(){var t,o,r,n;o=$("html").attr("lang");try{r=e("locales/"+o)}catch(a){t=a,r=e("locales/en")}return n=new Polyglot({phrases:r,locale:o}),n.t.bind(n)},o.exports=r()}),require.register("lib/intent_manager",function(t,e,o){var r,n;n=3e3,o.exports=r=function(){function t(){this.talker=new Talker(window.parent,"*")}return t.prototype.send=function(t,e,o){return this.talker.timeout=o?o:n,this.talker.send("nameSpace",e)},t}()}),require.register("lib/regions/dialogs",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.toggleDialogs=function(t){return null==t&&(t="true"!==this.$el.attr("aria-hidden")),this.$el.attr("aria-hidden",!t)},e.prototype.onShow=function(){return this.toggleDialogs(!0)},e.prototype.onBeforeEmpty=function(){return this.toggleDialogs(!1)},e}(Mn.Region)}),require.register("lib/tags_listener",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=e("models/tag"),o.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.models={tag:r},e.prototype.events=["tag.create","tag.update","tag.delete"],e.prototype.onRemoteCreate=function(t){return this.collection.add(t,{merge:!0})},e.prototype.onRemoteUpdate=function(t){return this.collection.add(t,{merge:!0})},e.prototype.onRemoteDelete=function(t){return this.collection.remove(t)},e}(CozySocketListener)}),require.register("lib/views/confirm",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.template=e("./templates/confirm"),o.prototype.tagName="section",o.prototype.attributes={role:"alertdialog","aria-busy":!1},o.prototype.ui={btn_ok:"button.ok",btn_cancel:"button.cancel"},o.prototype.triggers={"click @ui.btn_ok":"confirm:true","click @ui.btn_cancel":"confirm:false","click button":"confirm:close"},o.prototype.onDomRefresh=function(){return setTimeout(function(t){return function(){return t.$el.attr("aria-busy",!0)}}(this),50)},o.prototype.onConfirmClose=function(){var t;return t=e("application"),t.layout.alerts.empty()},o}(Mn.ItemView)}),require.register("lib/views/templates/base/alert",function(t,e,o){var r=function(t){
var e=[];return e.push('<div class="wrapper"><div role="contentinfo"></div></div>'),e.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("lib/views/templates/base/dialog",function(t,e,o){var r=function(t){var e=[];return e.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo"></div></div>'),e.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("lib/views/templates/confirm",function(t,e,o){var r=function(t){var e,o=[],r=t||{},n=r.title,a=r.message,i=r.btn_ok,s=r.btn_cancel;return o.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo"><h2>'+jade.escape(null==(e=n)?"":e)+"</h2><p>"+jade.escape(null==(e=a)?"":e)+'</p><nav><ul class="actions"><li><button class="ok">'+jade.escape(null==(e=i)?"":e)+'</button></li><li><button class="secondary cancel">'+jade.escape(null==(e=s)?"":e)+"</button></li></ul></nav></div></div>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("locales/en",function(t,e,o){o.exports={"list counter":"%{smart_count} contact |||| %{smart_count} contacts","list counter no-search":"no contact matches your criteria","list counter empty":"no contact at this time","tools subactions settings":"settings","tools actions add contact":"add contact","tools actions find duplicates":"find duplicates","tools search placeholder":"search for contacts","tools labels filters":"labels","tools labels filters all":"all contacts","tools contextual selected":"%{smart_count} contact selected |||| %{smart_count} contacts selected","tools contextual select all":"select all","tools contextual select none":"select none","tools contextual merge":"merge","tools contextual export":"export","tools contextual delete":"delete","bulk confirm delete title":"Delete contact |||| Delete contacts","bulk confirm delete message":"You'll delete a contact. Are you sure? |||| You'll delete %{smart_count} contacts. Are you sure?","bulk confirm delete ok":"delete","bulk confirm delete cancel":"keep 'em safe","settings title":"settings","settings in-out title":"import/export contacts","settings in-out import action":"import vcard","settings in-out export action":"export vcard","settings in-out import result":"You've just successfully imported %{smart_count} contact. |||| You've just successfully imported %{smart_count} contacts.","settings display title":"display settings","settings display sort gn":"sort by last name","settings display sort fn":"sort by first name","settings sync title":"mobile synchronization","settings sync gplay":"Access all your Cozy directly on your mobile device. Download our app now on the Google Play Store:","settings sync gplay get it":"Get it on Google play","settings sync carddav":"Looking for more information about the synchronization using CardDav? Take a look at [our documentation](%{link}).","card actions create":"create","card actions save":"save","card actions labels":"labels","card actions labels add":"add label","card actions labels create":"create label","card actions cancel":"cancel","card actions edit":"edit","card actions delete":"delete","card actions export":"export","card actions add select":"add field","card actions add birthday":"birthday","card actions add social":"social media","card actions add link":"url","card actions add other":"other information","card confirm delete title":"Remove %{name}?","card confirm delete message":"You'll remove %{name} from your contacts. Are you sure?","card confirm delete ok":"Delete Contact","card confirm delete cancel":"Keep it","card confirm cancel title":"Are you sure you want to leave?","card confirm cancel message":"Your contact hasn't been saved.","card confirm cancel ok":"Leave","card confirm cancel cancel":"Stay on Edit Mode","datapoints section tel":"Phone numbers","datapoints section email":"Email addresses","datapoints section adr":"Postal addresses","datapoints section xtras":"Additional informations","datapoint label name prefix":"prefix","datapoint label name first":"first name","datapoint label name middle":"middle name","datapoint label name given":"last name","datapoint label name suffix":"suffix","datapoint label org":"company","datapoint placeholder org":"add company name","datapoint label department":"department","datapoint placeholder department":"add department","datapoint label title":"title","datapoint placeholder title":"add title","datapoint placeholder tel":"add phone number","datapoint placeholder email":"add email address","datapoint placeholder adr":"add address","datapoint placeholder social":"add social media nickname","datapoint placeholder im":"add social media nickname","datapoint placeholder chat":"add social media nickname","datapoint placeholder url":"add an url","datapoint placeholder other":"add any information","datapoint label bday":"birthday","datapoint placeholder bday":"YYYY-MM-DD","datapoint label note":"notes","duplicates title":"Find Duplicates","duplicates actions mergeall":"merge all","duplicates empty":"No duplicates found","mergerow actions merge":"merge","mergerow actions dismiss":"dismiss","merge title":"Merge contacts","merge choose avatar":"Choose a profile picture:","merge choose name":"Choose a name:","merge choose nickname":"Choose a nickname:","merge choose organisation":"Choose an organisation:","merge choose org":"company","merge choose department":"department","merge choose title":"title","merge choose birthday":"Choose a birthday:","merge actions merge":"merge contacts","merge actions cancel":"cancel","error upload wrong filetype":"The uploaded file isn't a valid VCF/VCard format. Please try with another file."}}),require.register("locales/fr",function(t,e,o){o.exports={"list counter":"%{smart_count} contact |||| %{smart_count} contacts","list counter no-search":"aucun contact ne correspond à votre recherche","list counter empty":"aucun contact disponible","tools subactions settings":"configuration","tools actions add contact":"ajouter un contact","tools actions find duplicates":"doublons","tools search placeholder":"rechercher des contacts","tools labels filters":"libellés","tools labels filters all":"tous les contacts","tools contextual selected":"%{smart_count} contact sélectionné |||| %{smart_count} contacts sélectionnés","tools contextual select all":"tout sélectionner","tools contextual select none":"tout déslectionner","tools contextual merge":"fusionner","tools contextual export":"exporter","tools contextual delete":"supprimer","bulk confirm delete title":"Supprimer le contact |||| Supprimer les contacts","bulk confirm delete message":"Vous allez supprimer un contact. Êtes-vous sûr ? |||| Vous aller supprimer %{smart_count} contacts. Êtes vous sûr ?","bulk confirm delete ok":"Supprimer","bulk confirm delete cancel":"Conserver","settings title":"configuration","settings in-out title":"importer / exporter les contacts","settings in-out import action":"importer un fichier vcard","settings in-out export action":"exporter vos contacts","settings in-out import result":"Vous avez importé %{smart_count} contact. |||| Vous avez importé %{smart_count} contacts.","settings display title":"affichage","settings display sort gn":"trier sur le nom","settings display sort fn":"trier sur le prénom","settings sync title":"synchronisation mobile","settings sync gplay":"Accédez à votre Cozy depuis votre mobile. Télécharger notre application sur le Google Play Store:","settings sync gplay get it":"Disponible sur Google play","settings sync carddav":"Besoin de synchronisation CardDav? Jetez un œil à [notre documentation](%{link}).","card actions create":"créer","card actions save":"enregistrer","card actions labels":"libellés","card actions labels add":"ajouter un libellé","card actions labels create":"créer un libellé","card actions cancel":"annuler","card actions edit":"éditer","card actions delete":"supprimer","card actions export":"exporter","card actions add select":"ajouter un champ","card actions add birthday":"date de naissance","card actions add social":"réseau social","card actions add link":"lien","card actions add other":"autre","card confirm delete title":"Supprimer %{name} ?","card confirm delete message":"Vous allez supprimer %{name} de vos contacts. Êtes-vous sûr ?","card confirm delete ok":"Le Supprimer","card confirm delete cancel":"Le garder","card confirm cancel title":"Voulez-vous vraiment quitter l'édition ?","card confirm cancel message":"Vos modifications n'ont pas été sauvées.","card confirm cancel ok":"Quitter","card confirm cancel cancel":"Rester","datapoints section tel":"Numéros de téléphone","datapoints section email":"Adresses email","datapoints section adr":"Adresses postales","datapoints section xtras":"Informations complémentaires","datapoint label name prefix":"civilité","datapoint label name first":"prénom","datapoint label name middle":"surnom","datapoint label name given":"nom","datapoint label name suffix":"particule","datapoint label org":"société","datapoint placeholder org":"ajouter une société","datapoint label department":"département","datapoint placeholder department":"ajouter un department","datapoint label title":"poste","datapoint placeholder title":"ajouter un poste","datapoint placeholder tel":"ajouter un numéro de téléphone","datapoint placeholder email":"ajouter une adresse email","datapoint placeholder adr":"ajouter une adresse","datapoint placeholder social":"ajouter un nom d'utilisateur","datapoint placeholder im":"ajouter un nom d'utilisateur","datapoint placeholder chat":"ajouter un nom d'utilisateur","datapoint placeholder url":"ajouter une url","datapoint placeholder other":"ajouter une information","datapoint label bday":"anniversaire","datapoint placeholder bday":"YYYY-MM-DD","datapoint label note":"notes","duplicates title":"Doublons","duplicates actions mergeall":"tout fusionner","duplicates empty":"Aucun doublon détecté","mergerow actions merge":"fusionner","mergerow actions dismiss":"abandonner","merge title":"Fusionner les contacts","merge choose avatar":"Choisissez une photo de profil :","merge choose name":"Choisissez un nom :","merge choose nickname":"Choisissez un surnom :","merge choose organisation":"Choisissez une organisation:","merge choose org":"société","merge choose department":"département","merge choose title":"poste","merge choose birthday":"Choisissez un anniversaire :","merge actions merge":"fusionner","merge actions cancel":"annuler","error upload wrong filetype":"Le fichier sélectioné n'est pas un format VCard/VCF valide. Essayez avec un autre fichier."}}),require.register("models/config",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.url="config",e}(Backbone.Model)}),require.register("models/contact",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.defaults={name:"other",type:"other",value:""},e}(Backbone.Model),o.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return i(e,t),e.prototype.urlRoot="contacts",e.prototype.defaults={n:";;;;"},e.prototype.parse=function(t){var e,o,r,a;for(o in t)a=t[o],""===a&&delete t[o];return(r=t.url)&&(delete t.url,t.datapoints.unshift({name:"url",type:"main",value:r})),e=this.attributes.datapoints||new Backbone.Collection(t.datapoints||[],{model:n}),e.comparator="name",t.datapoints=e,t.tags=_.invoke(t.tags,"toLowerCase"),t},e.prototype.sync=function(t,o,r){var n,a,i,s,c;return n=o.get("avatar")||o.get("photo"),n&&(o.unset("avatar",{silent:!0}),o.unset("photo",{silent:!0}),s=r.success,r.success=function(t){return function(e,o,a){return t.savePicture(n,e,{success:function(){return s.apply(t,arguments),t.fetch()},error:r.error})}}(this)),r.attrs=o.toJSON(),a=(null!=(c=o.attributes.datapoints)?c.toJSON():void 0)||[],i=_.findWhere(a,{name:"url"}),i&&(r.attrs.datapoints=_.without(a,i),r.attrs.url=i.value),e.__super__.sync.apply(this,arguments)},e.prototype.toString=function(t){var e,o,r,n;return null==t&&(t={}),n=r=this.attributes.n.split(";"),o=n[0],e=n[1],o=_.compact([t.pre,o,t.post]).join(""),r[0]=e,r[1]=o,_.compact(r).join(" ")},e.prototype.toHighlightedString=function(t,e){var o,r,n,a;return null==e&&(e={}),o=e.format?{pre:"»",post:"«"}:void 0,n=this.toString(o),t&&(r=fuzzy.match(t,n,e)),a=r?r.rendered:n,o&&(a=a.replace("»",e.format.pre).replace("«",e.format.post)),a},e.prototype.match=function(t,e){var o,r,n,a,i,s,c,l,u;for(null==e&&(e={}),i=!1,o=e.format?{pre:"»",post:"«"}:void 0,s=[this.toString(o)],e.fullsearch&&(n=_.compact(this.attributes.datapoints.map(function(t){return"adr"!==t.get("name")?t.get("value"):void 0})),s=s.concat(n).concat(this.attributes.tags)),r=l=0,u=s.length;u>l;r=++l)if(c=s[r],a=fuzzy.match(t,c,e)){i=a,0===r&&o&&(i.rendered=a.rendered.replace("»",e.format.pre).replace("«",e.format.post));break}return i},e.prototype.toJSON=function(){var t;return _.extend({},e.__super__.toJSON.apply(this,arguments),{datapoints:(null!=(t=this.attributes.datapoints)?t.toJSON():void 0)||[]})},e.prototype.savePicture=function(t,e,o){var r,n,a,i,s,c,l;if(!e.id)return o.error(new Error("Model should have been saved once."));for(n=atob(t),r=[],s=c=0,l=n.length;l>=0?l>=c:c>=l;s=l>=0?++c:--c)r.push(n.charCodeAt(s));return a=new Blob([new Uint8Array(r)],{type:"image/jpeg"}),i=new FormData,i.append("picture",a),i.append("contact",e),$.ajax({type:"PUT",url:"contacts/"+e.id+"/picture",data:i,contentType:!1,processData:!1,success:o.success,error:o.error})},e.prototype.picturetoa=function(t){var e,o;return(null!=(o=this.attributes._attachments)?o.picture:void 0)?(e=new Image,e.onload=function(){var e,o,r,n;return o=document.createElement("canvas"),o.width=this.naturalWidth,o.height=this.naturalHeight,r=o.getContext("2d"),r.drawImage(this,0,0),n=o.toDataURL("image/jpeg").split(","),e=n[n.length-1],t(e)},e.src="contacts/"+this.id+"/picture.png"):t()},e.prototype.toVCF=function(t){var e;return e=this.toJSON(),this.picturetoa(function(o){return _.delay(t,0,VCardParser.toVCF(e,o))})},e}(Backbone.Model)}),require.register("models/tag",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.urlRoot="tags",e.prototype.parse=function(t){return t.name=t.name.toLowerCase(),t},e}(Backbone.Model)}),require.register("routes/contacts",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.routes={"new":"create",duplicates:"duplicates",":slug":"show",":slug/edit":"edit","":"index"},o.prototype._ensureContacts=function(t){var o;if(_.isFunction(t))return o=e("application"),o.contacts.isEmpty()?this.listenToOnce(o.contacts,"sync",t):t()},o.prototype._setCardState=function(t,o){var r,n;return r=e("application"),n=r.contacts.get(t)||"new"===t?t:!1,r.model.set("dialog",n),r.trigger("mode:edit",o)},o.prototype.index=function(){var t;return t=e("application"),t.search("tag",null)},o.prototype.show=function(t){return this._ensureContacts(_.wrap(this._setCardState,function(e){return e(t)}))},o.prototype.edit=function(t){return this._ensureContacts(_.wrap(this._setCardState,function(e){return e(t,!0)}))},o.prototype.create=function(){return this._setCardState("new",!0)},o.prototype.duplicates=function(){var t;return t=e("application"),this._ensureContacts(function(){return t.model.set("dialog","duplicates")})},o}(Backbone.SubRoute)}),require.register("routes/index",function(t,e,o){var r,n,a,i={}.hasOwnProperty,s=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=e("routes/contacts"),a=e("routes/tags"),o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,t),o.prototype.routes={settings:"settings","contact/:slug":"legacyContactRedirect","":"index"},o.prototype.initialize=function(){var t;return t=e("application"),t.on("start",function(){var t,e;return t=new r("contacts"),e=new a("tags")}),this.listenTo(t.model,"change:dialog",function(e,o){var r,n,a;if(!o)return r=null!=(a=t.model.get("filter"))?a.match(/tag:(\w+)/i):void 0,n=r?"tags/"+r[1]:"contacts",this.navigate(n)})},o.prototype.index=function(){return this.navigate("contacts",{trigger:!0})},o.prototype.settings=function(){var t;return t=e("application"),t.model.set("dialog","settings")},o.prototype.legacyContactRedirect=function(t){return this.navigate("contacts/"+t,{trigger:!0})},o}(Backbone.Router)}),require.register("routes/tags",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.routes={":slug":"filter"},o.prototype.filter=function(t){var o;return o=e("application"),o.search("tag",t)},o}(Backbone.SubRoute)}),require.register("views/app_layout",function(t,e,o){var r,n,a,i,s,c,l,u,p,d,f,h={}.hasOwnProperty,m=function(t,e){function o(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};a=e("models/contact"),i=e("views/models/contact"),l=e("views/tools/default_actions"),c=e("views/tools/context_actions"),p=e("views/labels"),f=e("views/tools/toolbar"),s=e("views/contacts"),n=e("views/contacts/card"),u=e("views/duplicates"),d=e("views/settings"),o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return m(o,t),o.prototype.template=e("views/templates/layouts/app"),o.prototype.el="[role=application]",o.prototype.behaviors={Navigator:{},Keyboard:{keymaps:{33:"key:pageup",34:"key:pagedown"}}},o.prototype.ui={navigate:"aside [role=button]"},o.prototype.regions={actions:"aside .tool-actions",labels:"aside .tool-labels",content:"main [role=contentinfo]",toolbar:"main [role=toolbar]",dialogs:{selector:".dialogs",regionClass:e("lib/regions/dialogs")},alerts:{selector:".alerts",regionClass:e("lib/regions/dialogs")}},o.prototype.modelEvents={"change:dialog":"showDialog","change:selected":"swapContextualMenu"},o.prototype.childEvents={"drawer:toggle":"toggleDrawer","contacts:select":function(t,e){return this.model.select(e)},"contacts:unselect":function(t,e){return this.model.unselect(e)},"dialog:close":function(){return this.model.set("dialog",!1)}},o.prototype.initialize=function(){var t;return t=e("application"),this.listenToOnce(t.contacts,"sync",function(){return this.showContactsList(),this.disableBusyState()}),this.listenToOnce(t.tags,"sync",function(){return this.showFilters()}),this.listenTo(this.model,"change:scored",function(t,e){return this.showContactsList(e)})},o.prototype.onRender=function(){return this.showChildView("toolbar",new f),this.showChildView("actions",new l)},o.prototype.disableBusyState=function(){return this.$el.attr("aria-busy",!1)},o.prototype.showFilters=function(){return this.showChildView("labels",new p({model:this.model}))},o.prototype.showContactsList=function(t){return null==t&&(t=!1),this.showChildView("content",new s({scored:t}))},o.prototype.showDialog=function(t,e){var o;return e?(o=function(){switch(e){case"settings":return new d({model:this.model});case"duplicates":return new u;default:return this._buildContactView(e)}}.call(this),this.showChildView("dialogs",o)):(this.dialogs.empty(),this.content.currentView.$el.focus())},o.prototype._buildContactView=function(t){var o,r,s;return o=e("application"),r="new"===t?new a(null,{parse:!0}):o.contacts.get(t),s=new i({"new":"new"===t},{model:r}),o.on("mode:edit",function(t){return s.set("edit",t)}),new n({model:s})},o.prototype.toggleDrawer=function(){var t,e;return t=this.$("aside.drawer"),e="true"===t.attr("aria-expanded"),t.attr("aria-expanded",!e)},o.prototype.swapContextualMenu=function(t,e){var o;return o=t._previousAttributes.selected,o.length&&e.length?void 0:_.isEmpty(e)?this.showChildView("actions",new l):this.showChildView("actions",new c({model:this.model}))},o}(Mn.LayoutView)}),require.register("views/contacts/card",function(t,e,o){var r,n,a,i,s,c,l=function(t,e){return function(){return t.apply(e,arguments)}},u={}.hasOwnProperty,p=function(t,e){function o(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=e("views/contacts/components/avatar"),i=e("views/contacts/components/data"),s=e("views/contacts/components/edit_tags"),c=e("lib/i18n"),n=e("config").contact,o.exports=a=function(t){function o(){return this._deleteModalCfg=l(this._deleteModalCfg,this),o.__super__.constructor.apply(this,arguments)}return p(o,t),o.prototype.template=e("views/templates/contacts/card"),o.prototype.tagName="section",o.prototype.className="card",o.prototype.attributes={role:"dialog"},o.prototype.behaviors=function(){return{Navigator:{},Dialog:{},Form:{},Dropdown:{},Confirm:{triggers:{"click @ui.btnDelete":this._deleteModalCfg}}}},o.prototype.ui={btnEdit:".edit[role=button]",btnDelete:"button.delete",btnExport:'[formaction="contact/export"]',navigate:"[href^=contacts], [data-next]",formSubmit:"[type=submit]",formClear:"button.clear",formInputs:".group:not([data-cid]) :input:not(button)",avatar:".avatar"},o.prototype.regions={avatar:"[role=img]",data:".data",tags:"aside .tags"},o.prototype.triggers={"click @ui.btnExport":"export"},o.prototype.modelEvents={"change:edit":"render",save:"onSave",destroy:function(){return this.triggerMethod("dialog:close")}},o.prototype.childEvents={"form:key:enter":"onFormKeyEnter"},o.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},o.prototype.serializeData=function(){return _.extend({},o.__super__.serializeData.apply(this,arguments),{lists:n.datapoints.types})},o.prototype._deleteModalCfg=function(){var t,e;return e={name:this.model.get("fn")},t={event:"delete",title:c("card confirm delete title",e),message:c("card confirm delete message",e),btn_ok:c("card confirm delete ok"),btn_cancel:c("card confirm delete cancel")}},o.prototype.onRender=function(){return this.showChildView("avatar",new r({model:this.model})),this.showChildView("data",new i({model:this.model})),this.showChildView("tags",new s({model:this.model})),this.$("[role=contentinfo]").toggleClass("edit",!!this.model.get("edit"))},o.prototype.onDomRefresh=function(){return this.model.get("edit")?void 0:this.ui.btnEdit.focus()},o.prototype.onSave=function(){var t,o;if(this.model.get("new"))return t=e("application"),o="contacts/"+this.model.get("id"),t.router.navigate(o,{trigger:!0})},o.prototype.onEditCancel=function(){return this.model.get("new")?this.triggerMethod("dialog:close"):void 0},o.prototype.onFormKeyEnter=function(){var t;return t=this.$(".data.edit").find("input:not([type=hidden]), textarea"),"textarea"!==document.activeElement.tagName.toLowerCase()?t.eq(t.index(document.activeElement)+1).focus():void 0},o}(Mn.LayoutView)}),require.register("views/contacts/components/avatar",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.template=e("views/templates/contacts/components/avatar"),o.prototype.behaviors={PickAvatar:{}},o.prototype.ui=function(){return this.options.model.get("edit")?{avatar:".avatar"}:void 0},o.prototype.modelEvents={"change:initials":"updateInitials","change:avatar":"render"},o.prototype.getInitialsColor=function(){return ColorHash.getColor(this.model.get("n"),"cozy")},o.prototype.serializeData=function(){return _.extend({},o.__super__.serializeData.apply(this,arguments),{bg:this.getInitialsColor()})},o.prototype.updateInitials=function(t,e){return this.$(".initials").text(e).css("background-color",this.getInitialsColor())},o}(Mn.ItemView)}),require.register("views/contacts/components/data",function(t,e,o){var r,n,a,i,s,c={}.hasOwnProperty,l=function(t,e){function o(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},u=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};a=e("views/contacts/components/datapoints"),s=e("views/contacts/components/xtras"),i=e("views/contacts/components/edit_actions"),r=e("config").contact,o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return l(o,t),o.prototype.template=e("views/templates/contacts/components/data"),o.prototype.behaviors={Form:{}},o.prototype.ui={formAdd:".actions button"},o.prototype.modelEvents={change:function(){return this.model.get("edit")?void 0:this.render()}},o.prototype.childEvents={"form:key:enter":function(){return this.triggerMethod("form:key:enter")}},o.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},o.prototype.serializeData=function(){return _.extend({},o.__super__.serializeData.apply(this,arguments),{fullname:this.model.toString({pre:"<b>",post:"</b>"})})},o.prototype._renderDatapoints=function(){return this.$(".datapoints").each(function(t){return function(e,o){var r;return r=o.dataset.type,t.addRegion(r,"[data-type="+r+"]"),t.showChildView(r,new a({collection:t.model.getDatapoints(r),name:r,cardViewModel:t.model}))}}(this)),this.addRegion("xtras-infos","[data-type=xtras-infos]"),this.showChildView("xtras-infos",new s({model:this.model}))},o.prototype._renderEditActions=function(){return this.addRegion("actions",".actions"),this.showChildView("actions",new i({model:this.model}))},o.prototype.onRender=function(){return this._renderDatapoints(),this.model.get("edit")?this._renderEditActions():void 0},o.prototype.onDomRefresh=function(){return this.model.get("edit")?this.$(":input:not(button):not([type=hidden])").eq(1).focus():void 0},o.prototype.onFormFieldAdd=function(t){var e;return e=this.getRegion("xtras").currentView,u.call(r.xtras,t)<0?e.addEmptyField(t):void 0},o}(Mn.LayoutView)}),require.register("views/contacts/components/datapoint",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=e("config").contact,o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.tagName=function(){return this.options.cardViewModel.get("edit")?"div":"li"},o.prototype.className="group",o.prototype.attributes=function(){return{"data-cid":this.model.cid}},o.prototype.template=e("views/templates/contacts/components/datapoint"),o.prototype.ui={type:"input.type"},o.prototype.events=function(){return"xtras"===this.options.name?{"keyup @ui.type":_.debounce(this.updateType,250),"change @ui.type":this.updateType}:void 0},o.prototype.serializeData=function(){var t,e;return t=o.__super__.serializeData.apply(this,arguments),e=function(){switch(t.name){case"social":case"chat":return"social";case"url":return"url";default:return"default"}}(),null==t.type&&(t.type=r.datapoints.types[e][0].split(":")[0]),{edit:this.options.cardViewModel.get("edit"),ref:this.options.cardViewModel.get("ref"),name:this.options.name,index:this.options.index,entity:e,point:t}},o.prototype.updateType=function(t){var e,o,n;return o=this.model.get("name"),"url"!==o?(e=_.find(r.datapoints.types.social,function(e){return e.match(new RegExp("^"+t.currentTarget.value.toLowerCase()))}),e?(n=e.split(":"),o=n[n.length-1]):o="other",this.$(t.currentTarget).siblings(".name").val(o)):void 0},o}(Mn.ItemView)}),require.register("views/contacts/components/datapoints",function(t,e,o){var r,n,a,i,s={}.hasOwnProperty,c=function(t,e){function o(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},l=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};i=e("lib/i18n"),n=e("views/contacts/components/datapoint"),r=e("config").contact,o.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.tagName=function(){return this.options.cardViewModel.get("edit")?"fieldset":"ul"},e.prototype.template=function(t){var e;return t.edit?(e=i("datapoints section "+t.name),"<legend>"+e+"</legend>"):void 0},e.prototype.behaviors={Form:{}},e.prototype.ui=function(){var t;return t={formInputs:":input:not(button)",formDelete:"button.delete"},"xtras"!==this.options.name&&(t.formAutoAdd=".value"),t},e.prototype.childView=n,e.prototype.childViewOptions=function(t,e){return _.extend(_.pick(this.options,"name","cardViewModel"),{index:e})},e.prototype.initialize=function(){return this.options.cardViewModel.get("edit")?this._initializeEditMode():void 0},e.prototype.serializeData=function(){return{name:this.options.name,edit:this.options.cardViewModel.get("edit")}},e.prototype._initializeEditMode=function(){return"xtras"!==this.options.name?this.addEmptyField():void 0},e.prototype.onFormFieldAdd=function(t){return this.addEmptyField(t)},e.prototype.onFormFieldUpdate=function(t){var e,o,r;return e=this.$(t).parents("[data-cid]"),r=this.collection.get(e.data("cid")),o=_.reduce(e.find(":input").serializeArray(),function(t,e){return t[_.last(e.name.split("."))]=e.value,t},{}),r.set(o)},e.prototype.onFormFieldDelete=function(t){return this.collection.remove(t)},e.prototype.getDatapoints=function(){return this.collection.filter(function(t){return!_.isEmpty(t.get("value"))})},e.prototype.addEmptyField=function(t){var e;return e=this.collection.add({type:void 0,value:"",name:t||this.options.name}),l.call(r.datapoints.main,t)>=0?void 0:this.$("[data-cid="+e.cid+"] input.value").focus()},e}(Mn.CompositeView)}),require.register("views/contacts/components/edit_actions",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.tagName="dl",o.prototype.attributes={"aria-haspopup":!0,"aria-expanded":!1,"data-position":"top left"},o.prototype.template=e("views/templates/contacts/components/add_field_dropdown"),o.prototype.modelEvents={"change:bday":"render"},o}(Mn.ItemView)}),require.register("views/contacts/components/edit_tags",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};n=e("views/contacts/components/tag"),o.exports=r=function(t){
function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.tagName="dl",o.prototype.attributes={"aria-haspopup":!0,"aria-expanded":!1,"data-position":"bottom right"},o.prototype.template=e("views/templates/contacts/components/edit_tags"),o.prototype.childView=n,o.prototype.childViewOptions=function(t){return{contactViewModel:this.model}},o.prototype.childViewContainer="ul",o.prototype.ui={tags:"li:not(.create) :input",create:".create",dropdown:"dd"},o.prototype.events={"change @ui.tags":"onClickTag","click @ui.dropdown":function(t){return t.stopPropagation()},"click @ui.create button":"toggleCreate","keydown @ui.create [name=name]":"addNewTag"},o.prototype.modelEvents={"change:tags":function(t){return this.toggleCreate(!1),this.children.invoke("render")}},o.prototype.initialize=function(){var t;return t=e("application"),this.collection=t.tags,Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},o.prototype.onClickTag=function(t){var o,r;return o=e("application"),r=this.$("li:not(.create) :input").serializeArray().map(function(t){return o.tags.get(t.value).get("name")}),this.triggerMethod("tags:update",r)},o.prototype.toggleCreate=function(t){return(_.isNull(t)||!_.isBoolean(t))&&(t="true"!==this.ui.create.attr("aria-expanded")),this.ui.create.attr("aria-expanded",t),this.ui.create.find("[name=name]").val(""),t?this.ui.create.find("input[name=name]").focus():void 0},o.prototype.addNewTag=function(t){var e;return t.stopPropagation(),e=t.currentTarget.value,13!==t.which||_.isEmpty(e)?void 0:this.triggerMethod("tags:add",e)},o}(Mn.CompositeView)}),require.register("views/contacts/components/tag",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.tagName="li",o.prototype.template=e("views/templates/contacts/components/tag"),o.prototype.serializeData=function(){var t;return t=this.options.contactViewModel.get("tags"),_.extend({},o.__super__.serializeData.apply(this,arguments),{selected:_.contains(t,this.model.get("name"))})},o}(Mn.ItemView)}),require.register("views/contacts/components/xtras",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},s=[].slice;r=e("config").contact,o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.tagName=function(){return this.model.get("edit")?"fieldset":"ul"},o.prototype.template=e("views/templates/contacts/components/xtras"),o.prototype.modelEvents=function(){return _.reduce(r.xtras,function(t,e){return t["change:"+e]=function(){var t;return t=1<=arguments.length?s.call(arguments,0):[],this.render.apply(this,t),this.setFocus.apply(this,t)},t},{})},o.prototype.serializeData=function(){return{edit:this.model.get("edit"),ref:this.model.get("ref"),xtras:_.reduce(r.xtras,function(t){return function(e,o){return t.model.has(o)&&(e[o]=t.model.get(o)),e}}(this),{})}},o.prototype.setFocus=function(t){var e,o;return o=this.model.get("ref"),e=_.keys(t.changed)[0],this.$("#"+e+"-"+o).focus()},o}(Mn.ItemView)}),require.register("views/contacts/group",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=e("views/models/contact"),o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.template=e("views/templates/contacts/group"),o.prototype.tagName="dl",o.prototype.attributes={role:"rowgroup"},o.prototype.className=function(){return this.model.get("isEmpty")?"empty":void 0},o.prototype.childViewContainer="ul",o.prototype.childView=e("views/contacts/row"),o.prototype.childViewOptions=function(t){return{model:new r({},{model:t})}},o.prototype.modelEvents={"change:isEmpty":"toggleEmpty"},o.prototype.toggleEmpty=function(){return this.$el.toggleClass("empty",this.model.get("isEmpty"))},o}(Mn.CompositeView)}),require.register("views/contacts/index",function(t,e,o){var r,n,a,i,s,c,l={}.hasOwnProperty,u=function(t,e){function o(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};s=BackboneProjections.Sorted,c=e("lib/i18n"),n=e("views/models/contact"),i=e("views/models/group"),r=e("collections/charindex"),o.exports=a=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return u(o,t),o.prototype.template=function(t){var e;return e=t.scored?"ul":"div","<"+e+' role="grid" tabindex="0"/><div class="counter"/>'},o.prototype.getChildView=function(){return e(this.options.scored?"views/contacts/row":"views/contacts/group")},o.prototype.childViewOptions=function(t){return this.options.scored?{model:new n({},{model:t})}:{collection:t.compositeCollection}},o.prototype.childViewContainer="[role=grid]",o.prototype.ui={navigate:".name"},o.prototype.behaviors={Navigator:{},Dropdown:{}},o.prototype.events={"change [type=checkbox]":"updateBulkSelection"},o.prototype.initialize=function(){var t,o,n,a,c,l,u;if(t=e("application"),a=t.filtered,this.options.scored)this.collection=new s(a,{comparator:function(t){return-1*a.scores[t.id]}});else for(n="#abcdefghijklmnopqrstuvwxyz",this.collection=new Backbone.Collection,c=function(t){return function(e){var o,n;return o={name:e},n=new r(a,{"char":e}),t.collection.add(new i(o,{compositeCollection:n}))}}(this),l=0,u=n.length;u>l;l++)o=n[l],c(o);return this.listenTo(this.collection,"reset",this.updateCounter)},o.prototype.onRenderCollection=function(){return this.updateCounter()},o.prototype.onShow=function(){var t;return t=e("application"),this.listenTo(t.layout,{"key:pageup":this.scroll.bind(this,!1),"key:pagedown":this.scroll.bind(this,!0)})},o.prototype.serializeData=function(){return{scored:this.options.scored}},o.prototype.updateCounter=function(){var t,o,r;return t=e("application"),r=t.filtered.size(),o=r?c("list counter",{smart_count:r}):c(t.contacts.size()?"list counter no-search":"list counter empty"),this.$(".counter").text(o).toggleClass("important",t.filtered.isEmpty())},o.prototype.scroll=function(t){var e,o;return e=t?1:-1,o=this._parent.$el.scrollTop()+this._parent.$el.innerHeight()*e,this._parent.$el.scrollTop(o),this.$el.focus()},o.prototype.updateBulkSelection=function(t){var e,o,r;return r=t.currentTarget.checked,e=t.currentTarget.value,o=r?"contacts:select":"contacts:unselect",this.triggerMethod(o,e)},o}(Mn.CompositeView)}),require.register("views/contacts/merge",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};n=e("lib/i18n"),o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.template=e("views/templates/contacts/merge"),o.prototype.tagName="section",o.prototype.className="merge",o.prototype.attributes={role:"alertdialog"},o.prototype.behaviors={Dialog:{},Form:{}},o.prototype.ui={formSubmit:"[type=submit]",formInputs:"input",cancel:".cancel"},o.prototype.modelEvents={"contacts:merge":"onClose"},o.prototype.events={"click @ui.cancel":"onCancel"},o.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},o.prototype.serializeData=function(){return{model:this.model.toJSON()}},o.prototype.onDomRefresh=function(){return _.defer(function(t){return function(){return t.$el.attr("aria-busy",!0)}}(this))},o.prototype.onFormSubmit=function(){return this.model.merge(),this.onClose()},o.prototype.onCancel=function(){return this.model.trigger("contacts:merge",this.model,"abort")},o.prototype.onClose=function(){return e("application").layout.alerts.empty()},o}(Mn.ItemView)}),require.register("views/contacts/row",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},s=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};n=e("config").search.pattern("text"),o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.template=e("views/templates/contacts/row"),o.prototype.tagName="li",o.prototype.attributes={role:"row"},o.prototype.modelEvents={change:"render",sync:"render"},o.prototype.initialize=function(){var t;return t=e("application"),this.listenTo(t.model,"change:selected",this.refreshChecked)},o.prototype.serializeData=function(){var t,r,a,i,c,l;return t=e("application"),r=null!=(c=t.model.get("filter"))?c.match(n):void 0,a={pre:"<b>",post:"</b>"},i=this.model.toHighlightedString((null!=r?r[1]:void 0)||null,{pre:'<span class="search">',post:"</span>",format:a}),_.extend({},o.__super__.serializeData.call(this),{fullname:i,selected:(l=this.model.id,s.call(t.model.get("selected"),l)>=0)})},o.prototype.refreshChecked=function(t,e){var o;return this.$("[type=checkbox]").prop("checked",(o=this.model.id,s.call(e,o)>=0))},o}(Mn.ItemView)}),require.register("views/duplicates/index",function(t,e,o){var r,n,a,i,s={}.hasOwnProperty,c=function(t,e){function o(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};n=e("collections/duplicates"),i=e("lib/i18n"),r=e("config").contact,o.exports=a=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return c(o,t),o.prototype.template=e("views/templates/duplicates"),o.prototype.tagName="section",o.prototype.className="duplicates",o.prototype.attributes={role:"dialog"},o.prototype.childViewContainer="[role=grid]",o.prototype.childView=e("views/duplicates/row"),o.prototype.templateHelpers=function(){return{size:this.toMerge.size()}},o.prototype.behaviors={Dialog:{}},o.prototype.ui={mergeAll:".mergeall"},o.prototype.events={"click @ui.mergeAll":"mergeAll"},o.prototype.collectionEvents={"contacts:merge":"render"},o.prototype.initialize=function(){var t;return t=e("application"),this.collection=new n(null,{collection:t.contacts}),this.toMerge=new BackboneProjections.Filtered(this.collection,{filter:function(t){return t.isMergeable()}}),this.bindEntityEvents(this.collection,this.getOption("collectionEvents"))},o.prototype.mergeAll=function(){return this.$("button,input").prop("disabled",!0),_.defer(function(t){return function(){return t.ui.mergeAll.attr("aria-busy",!0)}}(this)),async.eachSeries(this.toMerge.toArray(),function(t){return function(e,o){return t.listenTo(e,"contacts:merge",function(t,e){return _.defer(o,e)}),t.children.findByModel(e).merge()}}(this),function(t){return function(e){return t.$("button,input").removeAttr("disabled"),t.ui.mergeAll.attr("aria-busy","false"),e?console.error(e):void 0}}(this))},o}(Mn.CompositeView)}),require.register("views/duplicates/row",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},s=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};r=e("views/models/contact"),o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.template=e("views/templates/duplicates/row"),o.prototype.tagName=function(){return this.model.has("result")?"div":"dl"},o.prototype.className=function(){return this.model.has("result")?"merged":""},o.prototype.attributes=function(){return{role:this.model.has("result")?"row":"rowgroup"}},o.prototype.ui={submit:"[type=submit]",dismiss:".cancel"},o.prototype.modelEvents={change:"render","contacts:merge":"onContactsMerge"},o.prototype.events={"click @ui.submit":"merge","click [type=checkbox]":"check","click @ui.dismiss":"dismiss"},o.prototype.serializeData=function(){var t;return t=this.model.has("result")?new r({"new":!1},{model:this.model.get("result")}):void 0,_.extend(o.__super__.serializeData.apply(this,arguments),{candidates:this.model.get("candidates").map(function(t){return new r({"new":!1},{model:t})}),selected:this.model.get("candidates").map(function(t){return function(e){return s.call(t.model.get("toMerge"),e)>=0}}(this)),isMergeable:this.model.isMergeable(),result:t,merging:this.merging})},o.prototype.check=function(t){var e;return e=$(t.target),this.model.selectCandidate(e.val(),e.is(":checked"))},o.prototype.dismiss=function(){return this.model.collection.remove(this.model)},o.prototype.onContactsMerge=function(){return this.merging=!1,this.render()},o.prototype.merge=function(){var t,o,r;return this.triggerMethod("merge"),this.merging=!0,this.$("button, input").prop("disabled",!0),_.defer(function(t){return function(){return t.ui.submit.attr("aria-busy",!0)}}(this)),r=this.model.buildMergeOptions(),0===Object.keys(r).length?this.model.merge():(t=e("views/contacts/merge"),o=e("application"),o.layout.showChildView("alerts",new t({model:this.model})))},o}(Mn.ItemView)}),require.register("views/labels/filter",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.template=e("views/templates/labels/filter"),o.prototype.tagName="li",o.prototype.serializeData=function(){var t,r,n,a;return t=e("application"),n=new RegExp("tag:"+this.model.get("name"),"i"),r=null!=(a=t.model.get("filter"))?a.match(n):void 0,_.extend({},o.__super__.serializeData.apply(this,arguments),{selected:!!r})},o}(Mn.ItemView)}),require.register("views/labels/index",function(t,e,o){var r,n,a,i={}.hasOwnProperty,s=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=BackboneProjections.Filtered,a=e("config").search.pattern("tag"),o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,t),o.prototype.template=e("views/templates/labels"),o.prototype.tagName="fieldset",o.prototype.ui={navigate:"a"},o.prototype.behaviors={Navigator:{}},o.prototype.childViewContainer="ul",o.prototype.childView=e("views/labels/filter"),o.prototype.modelEvents={"change:filter":"toggleSelected"},o.prototype.initialize=function(){var t;return t=e("application"),this.collection=new r(t.tags,{filter:function(e){return t.contacts.length?!!t.contacts.find(function(t){return _.contains(t.get("tags"),e.get("name"))}):!1}}),this.collection.listenTo(t.contacts,{reset:this.collection.update,update:this.collection.update,"change:tags":this.collection.update})},o.prototype.toggleSelected=function(t,e){var o,r;return o=null!=e&&null!=(r=e.match(a))?r[1]:void 0,r=o?this.collection.find({name:o}).id:"all",this.$("a:not([data-id="+r+"])").attr("aria-checked",!1).find("input").prop("checked",!1),this.$("a[data-id="+r+"]").attr("aria-checked",!0).find("input").prop("checked",!0)},o}(Mn.CompositeView)}),require.register("views/models/app",function(t,e,o){var r,n,a,i={}.hasOwnProperty,s=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},c=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};a=e("views/contacts/merge"),n=e("views/models/merge"),o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,t),o.prototype.defaults={dialog:!1,filter:null,scored:!1,errors:null},o.prototype.viewEvents={"settings:sort":"updateSortSetting","settings:upload":"onUploadFile","select:all":"selectAll","select:none":"unselectAll","bulk:delete":"bulkDelete","bulk:export":function(){return this.bulkExport()},"bulk:merge":"bulkMerge","contacts:export":function(){return this.bulkExport(!0)}},o.prototype.initialize=function(){return this.set("selected",[]),this.listenTo(this,"change:filter",function(t,o){return this.unselectAll(),this.set("scored",e("config").search.pattern("text").test(o))})},o.prototype.select=function(t){var e;return e=this.attributes.selected.slice(0),e.push(t),this.set({selected:e})},o.prototype.unselect=function(t){var e;return e=_.without(this.attributes.selected,t),this.set({selected:e})},o.prototype.selectAll=function(){var t,o;return t=e("application"),o=t.filtered.map(function(t){return t.id}),this.set({selected:o})},o.prototype.unselectAll=function(){return this.set({selected:[]})},o.prototype.bulkDelete=function(){var t;return t=e("application"),_.each(this.attributes.selected,function(e){return function(o){return _.defer(function(){return t.contacts.get(o).destroy({wait:!0,success:function(){return e.unselect(o)}})})}}(this))},o.prototype.bulkMerge=function(){var t,o,r,i;return t=e("application"),o=t.contacts.filter(function(t){return function(e){var o;return o=e.id,c.call(t.attributes.selected,o)>=0}}(this)),i=new n({candidates:o}),r=i.buildMergeOptions(),i.on("contacts:merge",function(t){return function(){return t.unselectAll(),t.select(i.get("result").id)}}(this)),0===Object.keys(r).length?i.merge():t.layout.showChildView("alerts",new a({model:i}))},o.prototype.bulkExport=function(t){var o,r,n,a;return o=e("application"),r=t?o.contacts.size():this.attributes.selected.length,a=[],n=_.after(r,function(){var t,e;return e=moment().format("YYYYMMDD"),t=new Blob(a,{type:"text/plain;charset=utf-8"}),saveAs(t,""+e+"_cozy_contacts_"+a.length+".vcf")}),o.contacts.chain().filter(function(e){return function(o){var r;return t||(r=o.id,c.call(e.attributes.selected,r)>=0)}}(this)).invoke("toVCF",function(t){return a.push(t),n()})},o.prototype.updateSortSetting=function(t){return this.model.save("sort",t)},o.prototype.onUploadFile=function(t){var o;return/.+\.(vcf|vcard)$/i.test(t.name)?(this.trigger("before:import"),o=new FileReader,o.readAsText(t),o.onloadend=function(t){return function(){var r,n,a;return n=o.result,a=/^BEGIN:VCARD[\r\n]{1,2}(?:.+[\r\n]{1,2})+END:VCARD[\r\n]{0,2}$/,a.test(n)?(r=e("application"),r.contacts.importFromVCF(n)):t.set("errors",{upload:"error upload wrong filetype"})}}(this)):this.set("errors",{upload:"error upload wrong filetype"})},o}(Backbone.ViewModel)}),require.register("views/models/contact",function(t,e,o){var r,n,a,i,s={}.hasOwnProperty,c=function(t,e){function o(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},l=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};a=BackboneProjections.Filtered,i=e("lib/diacritics").asciize,r=e("config").contact,o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return c(o,t),o.prototype.defaults={"new":!1,edit:!1},o.prototype.map={avatar:"_attachments",initials:"n",name:"n"},o.prototype.events={"before:save":"syncDatapoints",save:"onSave",reset:"onReset"},o.prototype.viewEvents={"edit:cancel":"reset","tags:update":"updateTags","tags:add":"addNewTag","form:field:add":"onAddField","form:submit":function(){return this.save()},"export":"downloadAsVCF","delete":function(){return this.destroy()}},o.prototype.proxy=["toString","toHighlightedString","match"],o.prototype.initialize=function(){return this._setRef(),this.getDatapoints=_.memoize(this.getDatapoints,function(t){return this.attributes.edit?"edit-"+t:t}),this.listenTo(this,"change:edit",function(t,e){var o,r,n;if(e){o=this.getDatapoints.cache,n=[];for(r in o)/^edit/.test(r)&&n.push(delete o[r]);return n}})},o.prototype.toJSON=function(){var t;return t=_.reduce(r.datapoints.main,function(t){return function(e,o){return e[o]=t.getDatapoints(o).toJSON(),e}}(this),{xtras:this.getDatapoints("xtras").toJSON()}),_.extend({},o.__super__.toJSON.apply(this,arguments),t)},o.prototype.getMappedAvatar=function(t){return(null!=t?t.picture:void 0)?"contacts/"+this.model.id+"/picture.png?revpos="+t.picture.revpos:null},o.prototype.saveMappedAvatar=function(){var t,e;return t={},e=this.get("avatar"),null!=e&&null==e.match(/contacts\/.+\/picture.png/)&&(t.avatar=e.split(",")[1]),t},o.prototype.getMappedInitials=function(t){var e,o,r;return r=t.split(";"),o=r[0],e=r[1],(""+(e?i(e)[0]:"")+(o?i(o)[0]:"")).toUpperCase()},o.prototype.getMappedName=function(t){var e,o,r,n,a,i,s;return s=t.split(";"),o=s[0],e=s[1],r=s[2],a=s[3],i=s[4],n={first:e,given:o},r&&(n.middle=r),a&&(n.prefix=a),i&&(n.suffix=i),n},o.prototype.saveMappedName=function(){var t,e;return e=_.clone(this.get("name")),(t={}).n=[e.given,e.first,e.middle,e.prefix,e.suffix].join(";"),t},o.prototype._setRef=function(){return this.set("ref",this.model.cid)},o.prototype.onAddField=function(t){return l.call(r.xtras,t)>=0?this.set(t,""):void 0},o.prototype.getDatapoints=function(t){var e,o;return e=function(e){var o;return l.call(r.datapoints.main,t)>=0?e.get("name")===t:(o=e.get("name"),l.call(r.datapoints.main,o)<0)},this.attributes.edit?(o=this.model.get("datapoints").filter(e).map(function(t){return t.clone()}),new Backbone.Collection(o)):new a(this.model.get("datapoints"),{filter:e})},o.prototype.syncDatapoints=function(){var t,e,o;return t=this.getDatapoints.cache,e=this.model.get("datapoints"),o=_.reduce(t,function(t,e,o){return/^edit/.test(o)?t.concat(e.filter(function(t){return!_.isEmpty(t.get("value"))})):t},[]),e.reset(o)},o.prototype.updateTags=function(t){return this.model.save({tags:t})},o.prototype.addNewTag=function(t){var o;return o=e("application"),o.tags.create({name:t},{wait:!0,success:function(e){return function(){var o;return o=e.model.get("tags").concat(t),e.model.save({tags:o})}}(this)})},o.prototype.onSave=function(){return this.get("new")?e("application").contacts.add(this.model):void 0},o.prototype.onReset=function(){return this._setRef()},o.prototype.downloadAsVCF=function(){return this.model.toVCF(function(t){return function(e){var o;return o=new Blob([e],{type:"text/plain;charset=utf-8"}),saveAs(o,""+t.model.get("fn")+".vcf")}}(this))},o}(Backbone.ViewModel)}),require.register("views/models/group",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults=function(){return{isEmpty:this.isEmpty()}},e.prototype.initialize=function(){return this.listenTo(this.compositeCollection,{update:function(){return this.set("isEmpty",this.isEmpty())},reset:function(){return this.set("isEmpty",this.isEmpty())}})},e.prototype.isEmpty=function(){return!this.compositeCollection.length},e}(Backbone.ViewModel)}),require.register("views/models/merge",function(t,e,o){var r,n,a,i,s,c,l={}.hasOwnProperty,u=function(t,e){function o(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},p=[].indexOf||function(t){for(var e=0,o=this.length;o>e;e++)if(e in this&&this[e]===t)return e;return-1};a=e("models/contact"),s=e("views/models/contact"),n=e("lib/compare_contacts"),i=e("lib/contact_helper"),r=["org","title","department","bday","nickname"],o.exports=c=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return u(o,t),o.prototype.initialize=function(t){return null!=t.candidates?this.set("toMerge",t.candidates.slice(0)):void 0},o.prototype.selectCandidate=function(t,e){return e?this.isCandidateSelected(t)||this.attributes.toMerge.push(this.get("candidates")[t]):this.unselectCandidate(t),this.trigger("change",this)},o.prototype.unselectCandidate=function(t){return this.attributes.toMerge=this.attributes.toMerge.filter(function(e){return function(o){return o!==e.get("candidates")[t]}}(this))},o.prototype.isCandidateSelected=function(t){var e;return e=this.get("candidates")[t],p.call(this.get("toMerge"),e)>=0},o.prototype.toMergeAsJson=function(){return this.get("toMerge").map(function(t){return t.toJSON()})},o.prototype.isMergeable=function(){return!this.has("result")&&this.get("toMerge").length>1},o.prototype.buildMergeOptions=function(){var t,e,o,n,a,i;for(o={},e=r.concat(["avatar","fullname"]),a=0,i=e.length;i>a;a++)t=e[a],n=[],this.get("toMerge").forEach(function(e,o){var r,a;return a="avatar"===t?e.has("_attachments")?"contacts/"+e.get("id")+"/picture.png":null:"fullname"===t?e.toString({pre:"<b>",post:"</b>"}):e.get(t),r=function(t){return t.value===a},null==a||""===a||n.some(r)?void 0:n.push({value:a,index:o})}),n.length>0&&this.set(t,n[0].index),n.length>1&&(o[t]=n);return this.set("mergeOptions",o),o},o.prototype.merge=function(t){var e,o,s,c,l,u,p,d,f;if(u=this.toMergeAsJson(),u.length<=1)return t(new Error("not enought contact to merge."));for(c={datapoints:[],tags:[]},u.forEach(function(t){return n.mergeContacts(c,t)}),delete c._id,delete c.id,delete c.revision,delete c._rev,delete c._attachments,s=r,this.has("fullname")&&(this.set("n",this.get("fullname")),this.set("fn",this.get("fullname")),s=s.concat(["n","fn"])),d=0,f=s.length;f>d;d++)o=s[d],this.has(o)&&(c[o]=u[this.get(o)][o]);return l=new a(c,{parse:!0}),e=function(e){return function(o){return o?t(o):(e.listenToOnce(l,"sync",e.afterSyncResult.bind(e)),l.save(),null!=t?t():void 0)}}(this),this.has("avatar")?(p="contacts/"+u[this.get("avatar")].id+"/picture.png",i.imgUrl2DataUrl(p,function(t,o){return l.set("avatar",o.split(",")[1]),e(t)})):e()},o.prototype.afterSyncResult=function(t){return async.each(this.get("toMerge"),function(t,e){return t.destroy({success:function(){return e()},error:function(t,o,r){return e(o)}})},function(o){return function(r){return r?(console.error(r),o.trigger("contacts:merge",o,r)):(o.attributes.toMerge=[],o.attributes.candidates=[],o.set("result",t),o.trigger("contacts:merge",o,null)),e("application").contacts.add(t)}}(this))},o}(Backbone.ViewModel)}),require.register("views/settings/index",function(t,e,o){var r,n,a,i={}.hasOwnProperty,s=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};n=e("config").settings,a=e("lib/i18n"),o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return s(o,t),o.prototype.template=e("views/templates/settings"),o.prototype.tagName="section",o.prototype.className="settings",o.prototype.attributes={role:"dialog"},o.prototype.behaviors={Dialog:{}},o.prototype.ui={sort:"[name=sort]","import":"button.import",upload:"[type=file]","export":'[formaction="contacts/export"]',feedback:".feedback"},o.prototype.triggers={"click @ui.export":"contacts:export"},o.prototype.events={"change @ui.sort":"updateSort","click @ui.import":"triggerUploader","change @ui.upload":"onUploadFile"},o.prototype.modelEvents={"change:errors":"render","before:import":"onBeforeImport"},o.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents),this.listenTo(e("application").contacts,{"before:import:progress":this.onBeforeImportProgress,"import:progress":this.onProgressImport,"import":this.onProgressEnd})},o.prototype.serializeData=function(){return _.extend({},o.__super__.serializeData.apply(this,arguments),n,{locale:e("imports").locale})},o.prototype.updateSort=function(t){return t.preventDefault(),t.stopPropagation(),this.triggerMethod("settings:sort",t.currentTarget.value)},o.prototype.triggerUploader=function(t){return t.preventDefault(),t.stopPropagation(),this.ui.upload.trigger("click")},o.prototype.onUploadFile=function(t){return t.preventDefault(),t.stopPropagation(),this.triggerMethod("settings:upload",t.currentTarget.files[0])},o.prototype.onBeforeImport=function(){return this.ui["import"].prop("disabled",!0),this.ui.feedback.empty()},o.prototype.onBeforeImportProgress=function(t){var e;return this.ui.progress=$("<progress/>",{max:t,value:0}),this.ui.counter=$("<span/>",{text:0}),e=$("<div/>",{text:"/"+t}).prepend(this.ui.counter),this.ui.progress.appendTo(this.ui.feedback),e.appendTo(this.ui.feedback)},o.prototype.onProgressImport=function(t){return this.ui.progress.val(t),this.ui.counter.text(t)},o.prototype.onProgressEnd=function(t){return this.ui.feedback.empty().text(a("settings in-out import result",{smart_count:t})),this.ui["import"].prop("disabled",!1)},o}(Mn.ItemView)}),require.register("views/templates/contacts/card",function(e,o,r){var n=function(e){var o,r=[],n=e||{},a=n.edit,i=n.lists,s=n.id,c=n._id;return r.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo">'),a&&function(){var t=i;if("number"==typeof t.length)for(var e=0,o=t.length;o>e;e++){var n=t[e];r.push("<datalist"+jade.attr("id","list-"+e,!0,!1)+">"),function(){var t=n;if("number"==typeof t.length)for(var e=0,o=t.length;o>e;e++){var a=t[e],i=a.split(":");r.push("<option"+jade.attr("value",i[0],!0,!1)+jade.attr("data-name",i[1],!0,!1)+"></option>")}else{var o=0;for(var e in t){o++;var a=t[e],i=a.split(":");r.push("<option"+jade.attr("value",i[0],!0,!1)+jade.attr("data-name",i[1],!0,!1)+"></option>")}}}.call(this),r.push("</datalist>")}else{var o=0;for(var e in t){o++;var n=t[e];r.push("<datalist"+jade.attr("id","list-"+e,!0,!1)+">"),function(){var t=n;if("number"==typeof t.length)for(var e=0,o=t.length;o>e;e++){var a=t[e],i=a.split(":");r.push("<option"+jade.attr("value",i[0],!0,!1)+jade.attr("data-name",i[1],!0,!1)+"></option>")}else{var o=0;for(var e in t){o++;var a=t[e],i=a.split(":");r.push("<option"+jade.attr("value",i[0],!0,!1)+jade.attr("data-name",i[1],!0,!1)+"></option>")}}}.call(this),r.push("</datalist>")}}}.call(this),r.push('<div role="img"></div><div class="data"></div><aside><ul>'),a?(s?r.push('<li><button type="submit"'+jade.attr("data-next","contacts/"+c,!0,!1)+' class="outline"><i class="fa fa-check"></i><span>'+jade.escape(null==(o=t("card actions save"))?"":o)+"</span></button></li>"):r.push('<li><button type="submit" class="outline"><i class="fa fa-plus"></i><span>'+jade.escape(null==(o=t("card actions create"))?"":o)+"</span></button></li>"),r.push('<li><a role="button"'+jade.attr("href",s?"contacts/"+c:"contacts",!0,!1)+jade.attr("data-confirm",'{"event":"edit:cancel","title":"'+t("card confirm cancel title")+'","message":"'+t("card confirm cancel message")+'","btn_ok":"'+t("card confirm cancel ok")+'","btn_cancel":"'+t("card confirm cancel cancel")+'"}',!0,!1)+' class="cancel outline secondary"><i class="fa fa-times"></i><span>'+jade.escape(null==(o=t("card actions cancel"))?"":o)+"</span></a></li>")):r.push('<li><a role="button"'+jade.attr("href","contacts/"+c+"/edit",!0,!1)+' class="edit outline secondary"><i class="fa fa-pencil"></i><span>'+jade.escape(null==(o=t("card actions edit"))?"":o)+'</span></a></li><li><button formaction="contact/export" class="outline secondary"><i class="fa fa-upload"></i><span>'+jade.escape(null==(o=t("card actions export"))?"":o)+'</span></button></li><li><button class="delete outline danger special"><i class="fa fa-trash"></i><span>'+jade.escape(null==(o=t("card actions delete"))?"":o)+"</span></button></li>"),r.push('<li class="tags"></li></ul></aside></div></div>'),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/contacts/components/add_field_dropdown",function(e,o,r){
var n=function(e){var o,r=[],n=e||{},a=n.bday;return r.push('<dt role="button" class="outline secondary caret">'+jade.escape(null==(o=t("card actions add select"))?"":o)+'<i class="fa fa-caret-down"></i></dt><dd role="listbox"><ul>'),null==a&&r.push('<li role="option"><button value="bday" class="link">'+jade.escape(null==(o=t("card actions add birthday"))?"":o)+"</button></li>"),r.push('<li role="option"><button value="social" class="link">'+jade.escape(null==(o=t("card actions add social"))?"":o)+'</button></li><li role="option"><button value="url" class="link">'+jade.escape(null==(o=t("card actions add link"))?"":o)+'</button></li><li role="option"><button value="other" class="link">'+jade.escape(null==(o=t("card actions add other"))?"":o)+"</button></li></ul></dd>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/contacts/components/avatar",function(t,e,o){var r=function(t){var e,o=[],r=t||{},n=r.avatar,a=r.bg,i=r.initials;return n?o.push("<img"+jade.attr("src",n,!0,!1)+' class="avatar"/>'):o.push("<span"+jade.attr("style","background-color:"+a,!0,!1)+' class="avatar initials">'+jade.escape(null==(e=i)?"":e)+"</span>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("views/templates/contacts/components/data",function(e,o,r){var n=function(e){var o,r=[],n={},a=e||{},i=a.ref,s=a.edit,c=a.name,l=a.org,u=a.department,p=a.title,d=a.fullname,f=a.tags,h=a.note;return n.formatJob=function(t,e,n){this&&this.block,this&&this.attributes||{};t&&r.push(jade.escape(null==(o=t)?"":o)),t&&e&&r.push(" - "),e&&r.push(jade.escape(null==(o=e)?"":o)),(e&&n||t&&n)&&r.push(" "),n&&r.push("("+jade.escape(null==(o=n)?"":o)+")")},n.input=function(e,n){var a=(this&&this.block,this&&this.attributes||{}),s=t("datapoint label "+e.replace("."," ")),c=[e,i].join("-"),l=a.placeholder?t("datapoint placeholder "+e):!1,u=a.value;r.push("<label"+jade.attr("for",c,!0,!1)+' class="group"><span class="type">'+jade.escape(null==(o=s)?"":o)+"</span>"),"textarea"==n?r.push("<textarea"+jade.attr("id",c,!0,!1)+jade.attr("name",e,!0,!1)+' class="value">'+jade.escape(null==(o=u)?"":o)+"</textarea>"):r.push("<input"+jade.attr("id",c,!0,!1)+jade.attr("name",e,!0,!1)+' type="text"'+jade.attr("value",u,!0,!1)+jade.attr("placeholder",l,!0,!1)+jade.cls(["value",u?void 0:"empty"],[null,!0])+'/><button class="link clear"><div class="fa fa-times"></div></button>'),r.push("</label>")},s?(n.input.call({attributes:{value:jade.escape(c.prefix)}},"name.prefix"),n.input.call({attributes:{value:jade.escape(c.first)}},"name.first"),n.input.call({attributes:{value:jade.escape(c.middle)}},"name.middle"),n.input.call({attributes:{value:jade.escape(c.given)}},"name.given"),n.input.call({attributes:{value:jade.escape(c.suffix)}},"name.suffix"),r.push('<fieldset data-type="infos" class="block">'),n.input.call({attributes:{value:jade.escape(l),placeholder:!0}},"org"),n.input.call({attributes:{value:jade.escape(u),placeholder:!0}},"department"),n.input.call({attributes:{value:jade.escape(p),placeholder:!0}},"title"),r.push("</fieldset>")):(r.push("<header><h1>"+(null==(o=d)?"":o)+'</h1><ul class="tags">'),function(){var t=f;if("number"==typeof t.length)for(var e=0,n=t.length;n>e;e++){var a=t[e];r.push("<li>"+jade.escape(null==(o=a)?"":o)+"</li>")}else{var n=0;for(var e in t){n++;var a=t[e];r.push("<li>"+jade.escape(null==(o=a)?"":o)+"</li>")}}}.call(this),r.push('</ul></header><ul data-type="infos" class="block">'),(p||l||u||h)&&((p||l||u)&&(r.push("<li>"),n.formatJob(p,l,u),r.push("</li>")),h&&r.push("<li>"+jade.escape(null==(o=h)?"":o)+"</li>")),r.push("</ul>")),r.push('<div data-type="tel" class="block datapoints"></div><div data-type="email" class="block datapoints"></div><div data-type="adr" class="block datapoints"></div><div class="block"><div data-type="xtras" class="datapoints"></div><div data-type="xtras-infos"></div>'),s&&n.input.call({attributes:{value:jade.escape(h)}},"note","textarea"),r.push("</div>"),s&&r.push('<div class="actions"></div>'),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/contacts/components/datapoint",function(e,o,r){var n=function(e){var o,r=[],n={},a=e||{},i=a.entity,s=a.ref,c=a.edit,l=a.point,u=a.name,p=a.index;return n.formatPoint=function(t,e){this&&this.block,this&&this.attributes||{};if(e)switch(t.type.toLowerCase()){case"home":var e="home";break;case"work":var e="building";break;default:switch(t.name){case"tel":var e="phone";break;case"email":var e="envelope";break;default:var e=!1}}r.push("<i"+jade.cls(["type",e?"fa fa-"+e:!1],[null,!0])+">"+jade.escape(null==(o=t.type)?"":o)+'&nbsp;</i><span class="value">'+jade.escape(null==(o=t.value)?"":o)+"</span>")},n.groupInput=function(e,o,n){var a=(this&&this.block,this&&this.attributes||{}),c=a.placeholder?t("datapoint placeholder "+("default"==i?e.name:i)):!1,l=o+"."+n;r.push("<input"+jade.attr("id",""+l+".type-"+s,!0,!1)+jade.attr("name",""+l+".type",!0,!1)+' type="text"'+jade.attr("value",e.type,!0,!1)+jade.attr("list","list-"+i,!0,!1)+' class="type"/><input'+jade.attr("id",""+l+".value-"+s,!0,!1)+jade.attr("name",""+l+".value",!0,!1)+' type="text"'+jade.attr("value",e.value,!0,!1)+jade.attr("placeholder",c,!0,!1)+jade.cls(["value",e.value?void 0:"empty"],[null,!0])+'/><button class="link delete"><div class="fa fa-trash"></div></button><input'+jade.attr("id",""+l+".name-"+s,!0,!1)+jade.attr("name",""+l+".name",!0,!1)+' type="hidden"'+jade.attr("value",e.name,!0,!1)+' class="name"/>')},c?n.groupInput.call({attributes:{placeholder:!0}},l,u,p):n.formatPoint(l),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/contacts/components/edit_tags",function(e,o,r){var n=function(e){var o,r=[];return r.push('<dt role="button" class="outline secondary caret"><i class="fa fa-tags fa-flip-horizontal"></i>'+jade.escape(null==(o=t("card actions labels"))?"":o)+'<i class="fa fa-caret-down"></i></dt><dd><fieldset><legend>'+jade.escape(null==(o=t("card actions labels add"))?"":o)+'</legend><ul></ul><div aria-expanded="false" class="create"><label for="tag-new"><input type="text" name="name"/></label><button><i class="fa fa-plus"></i>'+jade.escape(null==(o=t("card actions labels create"))?"":o)+"</button></div></fieldset></dd>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/contacts/components/tag",function(t,e,o){var r=function(t){var e,o=[],r=t||{},n=r._id,a=r.selected,i=r.name,s=n.slice(-6);return o.push("<label"+jade.attr("for","tag-"+s,!0,!1)+'><input type="checkbox"'+jade.attr("id","tag-"+s,!0,!1)+' name="tags"'+jade.attr("value",n,!0,!1)+jade.attr("checked",a,!0,!1)+'/><span class="label">'+jade.escape(null==(e=i)?"":e)+"</span></label>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("views/templates/contacts/components/xtras",function(e,o,r){var n=function(e){var o,r=[],n={},a=e||{},i=a.ref,s=a.xtras,c=a.edit;return n.formatPoint=function(t,e){this&&this.block,this&&this.attributes||{};if(e)switch(t.type.toLowerCase()){case"home":var e="home";break;case"work":var e="building";break;default:switch(t.name){case"tel":var e="phone";break;case"email":var e="envelope";break;default:var e=!1}}r.push("<i"+jade.cls(["type",e?"fa fa-"+e:!1],[null,!0])+">"+jade.escape(null==(o=t.type)?"":o)+'&nbsp;</i><span class="value">'+jade.escape(null==(o=t.value)?"":o)+"</span>")},n.input=function(e,n){var a=(this&&this.block,this&&this.attributes||{}),s=t("datapoint label "+e.replace("."," ")),c=[e,i].join("-"),l=a.placeholder?t("datapoint placeholder "+e):!1,u=a.value;r.push("<label"+jade.attr("for",c,!0,!1)+' class="group"><span class="type">'+jade.escape(null==(o=s)?"":o)+"</span>"),"textarea"==n?r.push("<textarea"+jade.attr("id",c,!0,!1)+jade.attr("name",e,!0,!1)+' class="value">'+jade.escape(null==(o=u)?"":o)+"</textarea>"):r.push("<input"+jade.attr("id",c,!0,!1)+jade.attr("name",e,!0,!1)+' type="text"'+jade.attr("value",u,!0,!1)+jade.attr("placeholder",l,!0,!1)+jade.cls(["value",u?void 0:"empty"],[null,!0])+'/><button class="link clear"><div class="fa fa-times"></div></button>'),r.push("</label>")},function(){var e=s;if("number"==typeof e.length)for(var o=0,a=e.length;a>o;o++){var i=e[o];if(c)n.input.call({attributes:{value:jade.escape(i),placeholder:!0}},o,"text");else{var l={type:t("datapoint label "+o),value:i};r.push('<li class="group">'),n.formatPoint(l),r.push("</li>")}}else{var a=0;for(var o in e){a++;var i=e[o];if(c)n.input.call({attributes:{value:jade.escape(i),placeholder:!0}},o,"text");else{var l={type:t("datapoint label "+o),value:i};r.push('<li class="group">'),n.formatPoint(l),r.push("</li>")}}}}.call(this),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/contacts/group",function(t,e,o){var r=function(t){var e,o=[],r=t||{},n=r.name;return o.push('<dt role="columnheader">'+jade.escape(null==(e=n)?"":e)+"</dt><dd><ul></ul></dd>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("views/templates/contacts/helpers",function(t,e,o){var r=function(t){var e=[];return e.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("views/templates/contacts/merge",function(e,o,r){var n=function(e){var o,r=[],n={},a=e||{},i=a.model;return n.radio=function(t,e){this&&this.block,this&&this.attributes||{};r.push("<ul"+jade.cls(["avatar"==e?"avatars":""],[!0])+">"),function(){var n=t;if("number"==typeof n.length)for(var a=0,s=n.length;s>a;a++){var c=n[a],l=c.index,u=["merge",e,l].join("-"),p=i[e]==l;r.push("<li><label"+jade.attr("for",u,!0,!1)+">"),"avatar"==e?r.push('<input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><img"+jade.attr("src",c.value,!0,!1)+"/>"):(r.push('<span data-input="radio"><input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><label"+jade.attr("for",u,!0,!1)+"></label></span><span>"),"fullname"==e?r.push(null==(o=c.value)?"":o):r.push(jade.escape(null==(o=c.value)?"":o)),r.push("</span>")),r.push("</label></li>")}else{var s=0;for(var a in n){s++;var c=n[a],l=c.index,u=["merge",e,l].join("-"),p=i[e]==l;r.push("<li><label"+jade.attr("for",u,!0,!1)+">"),"avatar"==e?r.push('<input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><img"+jade.attr("src",c.value,!0,!1)+"/>"):(r.push('<span data-input="radio"><input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><label"+jade.attr("for",u,!0,!1)+"></label></span><span>"),"fullname"==e?r.push(null==(o=c.value)?"":o):r.push(jade.escape(null==(o=c.value)?"":o)),r.push("</span>")),r.push("</label></li>")}}}.call(this),r.push("</ul>")},r.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo">'),n.radio=function(t,e){this&&this.block,this&&this.attributes||{};r.push("<ul"+jade.cls(["avatar"==e?"avatars":""],[!0])+">"),function(){var n=t;if("number"==typeof n.length)for(var a=0,s=n.length;s>a;a++){var c=n[a],l=c.index,u=["merge",e,l].join("-"),p=i[e]==l;r.push("<li><label"+jade.attr("for",u,!0,!1)+">"),"avatar"==e?r.push('<input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><img"+jade.attr("src",c.value,!0,!1)+"/>"):(r.push('<span data-input="radio"><input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><label"+jade.attr("for",u,!0,!1)+"></label></span><span>"),"fullname"==e?r.push(null==(o=c.value)?"":o):r.push(jade.escape(null==(o=c.value)?"":o)),r.push("</span>")),r.push("</label></li>")}else{var s=0;for(var a in n){s++;var c=n[a],l=c.index,u=["merge",e,l].join("-"),p=i[e]==l;r.push("<li><label"+jade.attr("for",u,!0,!1)+">"),"avatar"==e?r.push('<input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><img"+jade.attr("src",c.value,!0,!1)+"/>"):(r.push('<span data-input="radio"><input type="radio"'+jade.attr("name",e,!0,!1)+jade.attr("value",l,!0,!1)+jade.attr("id",u,!0,!1)+jade.attr("checked",p,!0,!1)+"/><label"+jade.attr("for",u,!0,!1)+"></label></span><span>"),"fullname"==e?r.push(null==(o=c.value)?"":o):r.push(jade.escape(null==(o=c.value)?"":o)),r.push("</span>")),r.push("</label></li>")}}}.call(this),r.push("</ul>")},r.push("<h1>"+jade.escape(null==(o=t("merge title"))?"":o)+"</h1><dl>"),null!=i.mergeOptions.avatar&&(r.push("<dt>"+jade.escape(null==(o=t("merge choose avatar"))?"":o)+"</dt><dd>"),n.radio(i.mergeOptions.avatar,"avatar"),r.push("</dd>")),null!=i.mergeOptions.fullname&&(r.push("<dt>"+jade.escape(null==(o=t("merge choose name"))?"":o)+"</dt><dd>"),n.radio(i.mergeOptions.fullname,"fullname"),r.push("</dd>")),null!=i.mergeOptions.nickname&&(r.push("<dt>"+jade.escape(null==(o=t("merge choose nickname"))?"":o)+"</dt><dd>"),n.radio(i.mergeOptions.nickname),r.push("</dd>")),(null!=i.mergeOptions.org||null!=i.mergeOptions.department||null!=i.mergeOptions.title)&&(r.push("<dt>"+jade.escape(null==(o=t("merge choose organisation"))?"":o)+"</dt><dd><dl>"),null!=i.mergeOptions.org&&(r.push("<dt>"+jade.escape(null==(o=t("merge choose org"))?"":o)+"</dt><dd>"),n.radio(i.mergeOptions.org,"org"),r.push("</dd>")),null!=i.mergeOptions.department&&(r.push("<dt>"+jade.escape(null==(o=t("merge choose department"))?"":o)+"</dt><dd>"),n.radio(i.mergeOptions.department,"department"),r.push("</dd>")),null!=i.mergeOptions.title&&(r.push("<dt>"+jade.escape(null==(o=t("merge choose title"))?"":o)+"</dt><dd>"),n.radio(i.mergeOptions.title,"title"),r.push("</dd>")),r.push("</dl></dd>")),null!=i.mergeOptions.bday&&(r.push("<dt>"+jade.escape(null==(o=t("merge choose birthday"))?"":o)+"</dt><dd>"),n.radio(i.mergeOptions.bday,"bday"),r.push("</dd>")),r.push('</dl><nav><ul class="actions"><li><button type="submit"><div class="fa fa-code-fork"></div><span>'+jade.escape(null==(o=t("merge actions merge"))?"":o)+'</span></button></li><li><button class="cancel outline secondary"><span>'+jade.escape(null==(o=t("merge actions cancel"))?"":o)+"</span></button></li></ul></nav></div></div>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/contacts/row",function(t,e,o){var r=function(t){var e,o=[],r={},n=t||{},a=n.ref,i=n.id,s=n.selected,c=n._id,l=n.avatar,u=n.n,p=n.initials,d=n.fullname,f=n.tel,h=n.email;if(r.formatPoint=function(t,r){this&&this.block,this&&this.attributes||{};if(r)switch(t.type.toLowerCase()){case"home":var r="home";break;case"work":var r="building";break;default:switch(t.name){case"tel":var r="phone";break;case"email":var r="envelope";break;default:var r=!1}}o.push("<i"+jade.cls(["type",r?"fa fa-"+r:!1],[null,!0])+">"+jade.escape(null==(e=t.type)?"":e)+'&nbsp;</i><span class="value">'+jade.escape(null==(e=t.value)?"":e)+"</span>")},r.formatDatapoints=function(t,e){this&&this.block,this&&this.attributes||{};if(null!=t&&t.length){var n=t.length>1;o.push('<dl role="gridcell"'+jade.attr("aria-haspopup",n?"true":"false",!0,!1)+' aria-expanded="false" data-position="bottom left"'+jade.cls([e],[!0])+"><dt>"),r.formatPoint(t[0]),n&&o.push('<span class="fa fa-caret-down"></span>'),o.push("</dt>"),n&&(o.push("<dd><ul>"),function(){var e=t;if("number"==typeof e.length)for(var n=0,a=e.length;a>n;n++){var i=e[n];o.push("<li>"),r.formatPoint(i,!0),o.push("</li>")}else{var a=0;for(var n in e){a++;var i=e[n];o.push("<li>"),r.formatPoint(i,!0),o.push("</li>")}}}.call(this),o.push("</ul></dd>")),o.push("</dl>")}else o.push('<div role="gridcell"'+jade.cls(["placeholder",e],[null,!0])+"></div>")},o.push('<span data-input="checkbox"><input type="checkbox"'+jade.attr("id",a,!0,!1)+' name="bulk"'+jade.attr("value",i,!0,!1)+jade.attr("checked",s,!0,!1)+"/><label"+jade.attr("for",a,!0,!1)+'></label></span><a role="gridcell"'+jade.attr("href","contacts/"+c,!0,!1)+' class="name">'),l)o.push("<img"+jade.attr("src",l,!0,!1)+' class="avatar"/>');else{var m=ColorHash.getColor(u,"cozy");o.push("<span"+jade.attr("style","background-color:"+m,!0,!1)+' class="avatar initials">'+jade.escape(null==(e=p)?"":e)+"</span>")}return o.push("<p>"+(null==(e=d)?"":e)+"</p></a>"),r.formatDatapoints(f,"tel"),r.formatDatapoints(h,"email"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("views/templates/duplicates/index",function(e,o,r){var n=function(e){var o,r=[],n=e||{},a=n.size;return r.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo"><h1>'+jade.escape(null==(o=t("duplicates title"))?"":o)+"</h1>"),a>0?r.push('<button type="submit" class="mergeall"><div class="fa fa-code-fork"></div><span>'+jade.escape(null==(o=t("duplicates actions mergeall"))?"":o)+"</span> ("+jade.escape(null==(o=a)?"":o)+')</button><div role="grid"></div>'):r.push('<p class="empty">'+jade.escape(null==(o=t("duplicates empty"))?"":o)+"</p>"),r.push("</div></div>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/duplicates/row",function(e,o,r){var n=function(e){var o,r=[],n={},a=e||{},i=a.result,s=a.candidates,c=a.isMergeable,l=a.merging,u=a.selected;return n.formatPoint=function(t,e){this&&this.block,this&&this.attributes||{};if(e)switch(t.type.toLowerCase()){case"home":var e="home";break;case"work":var e="building";break;default:switch(t.name){case"tel":var e="phone";break;case"email":var e="envelope";break;default:var e=!1}}r.push("<i"+jade.cls(["type",e?"fa fa-"+e:!1],[null,!0])+">"+jade.escape(null==(o=t.type)?"":o)+'&nbsp;</i><span class="value">'+jade.escape(null==(o=t.value)?"":o)+"</span>")},n.fullname=function(t){this&&this.block,this&&this.attributes||{};r.push("<p>"+(null==(o=t.toString({pre:"<b>",post:"</b>"}))?"":o)+"</p>")},n.formatDatapoints=function(t,e){this&&this.block,this&&this.attributes||{};null!=t&&t.length?(r.push('<dl role="gridcell" aria-haspopup="true"'+jade.cls([e],[!0])+"><dt>"),n.formatPoint(t[0]),r.push("</dt></dl>")):r.push('<div role="gridcell"'+jade.cls(["placeholder",e],[null,!0])+"></div>")},n.contactrow=function(t){var e=(this&&this.block,this&&this.attributes||{},t.toJSON());r.push('<div role="gridcell" class="name">'),e.avatar?r.push("<img"+jade.attr("src",e.avatar,!0,!1)+' class="avatar"/>'):r.push('<span class="avatar initials">'+jade.escape(null==(o=e.initials)?"":o)+"</span>"),n.fullname(t),r.push("</div>"),n.formatDatapoints(e.tel,"tel"),n.formatDatapoints(e.email,"email")},i?n.contactrow(i):(r.push('<dt role="columnheader">'),n.fullname(s[0]),r.push('<div class="btn-group"><button class="cancel outline secondary"><span>'+jade.escape(null==(o=t("mergerow actions dismiss"))?"":o)+'</span></button><button type="submit"'+jade.attr("disabled",!c,!0,!1)+jade.attr("aria-busy",l,!0,!1)+'><div class="fa fa-code-fork"></div><span>'+jade.escape(null==(o=t("mergerow actions merge"))?"":o)+"</span></button></div></dt><dd><ul>"),function(){var t=s;if("number"==typeof t.length)for(var e=0,o=t.length;o>e;e++){var a=t[e];r.push('<li role="presentation"><label'+jade.attr("for",a.cid,!0,!1)+' role="row"><span data-input="checkbox"><input type="checkbox"'+jade.attr("id",a.cid,!0,!1)+jade.attr("name","mergecontact-"+e,!0,!1)+jade.attr("value",""+e,!0,!1)+jade.attr("checked",u[e],!0,!1)+"/><label"+jade.attr("for",a.cid,!0,!1)+"></label></span>"),n.contactrow(a),r.push("</label></li>")}else{var o=0;for(var e in t){o++;var a=t[e];r.push('<li role="presentation"><label'+jade.attr("for",a.cid,!0,!1)+' role="row"><span data-input="checkbox"><input type="checkbox"'+jade.attr("id",a.cid,!0,!1)+jade.attr("name","mergecontact-"+e,!0,!1)+jade.attr("value",""+e,!0,!1)+jade.attr("checked",u[e],!0,!1)+"/><label"+jade.attr("for",a.cid,!0,!1)+"></label></span>"),n.contactrow(a),r.push("</label></li>")}}}.call(this),r.push("</ul></dd>")),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/labels/filter",function(t,e,o){var r=function(t){var e,o=[],r=t||{},n=r.id,a=r.name,i=r.selected;return o.push("<a"+jade.attr("href","all"==n?"contacts":"tags/"+a,!0,!1)+' data-input="radio"'+jade.attr("data-id",n,!0,!1)+jade.attr("aria-checked",i?"true":"false",!0,!1)+'><input type="radio"'+jade.attr("id",n,!0,!1)+' name="label-filters"'+jade.attr("checked",i,!0,!1)+"/><label"+jade.attr("for",n,!0,!1)+"></label>"+jade.escape(null==(e=a)?"":e)+"</a>"),o.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("views/templates/labels/index",function(e,o,r){var n=function(e){var o,r=[],n=e||{},a=n.filter;r.push("<legend>"+jade.escape(null==(o=t("tools labels filters"))?"":o)+"</legend><nav><ul><li>");var i="all",s=t("tools labels filters all"),c=null==a;return r.push("<a"+jade.attr("href","all"==i?"contacts":"tags/"+s,!0,!1)+' data-input="radio"'+jade.attr("data-id",i,!0,!1)+jade.attr("aria-checked",c?"true":"false",!0,!1)+'><input type="radio"'+jade.attr("id",i,!0,!1)+' name="label-filters"'+jade.attr("checked",c,!0,!1)+"/><label"+jade.attr("for",i,!0,!1)+"></label>"+jade.escape(null==(o=s)?"":o)+"</a></li></ul></nav>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/layouts/app",function(e,o,r){var n=function(e){var o,r=[],n=e||{},a=n.mode;return r.push('<aside class="drawer"><div class="tool-actions"></div><div class="tool-labels"></div>'),"select"!=a&&r.push('<footer class="tool-subactions"><nav><ul><li><a href="settings" role="button" class="secondary"><div class="fa fa-cog"></div><span>'+jade.escape(null==(o=t("tools subactions settings"))?"":o)+"</span></a></li></ul></nav></footer>"),r.push('</aside><main><div role="toolbar"></div><div role="contentinfo"></div></main><div aria-hidden="true" class="dialogs"></div><div aria-hidden="true" class="alerts"></div>'),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/settings/index",function(e,o,r){var n=function(e){var o,r=[],n=e||{},a=n.errors,i=n.sortkeys,s=n.sort,c=n.locale;return r.push('<div role="separator"></div><div class="wrapper"><div role="contentinfo"><h1>'+jade.escape(null==(o=t("settings title"))?"":o)+'</h1><div class="group"><h2>'+jade.escape(null==(o=t("settings in-out title"))?"":o)+'</h2><nav><ul><li><input type="file" name="upload"/><button class="import"><i class="fa fa-download"></i>'+jade.escape(null==(o=t("settings in-out import action"))?"":o)+'</button></li><li><button formaction="contacts/export" class="export"><i class="fa fa-upload"></i>'+jade.escape(null==(o=t("settings in-out export action"))?"":o)+"</button></li></ul></nav><div"+jade.cls(["feedback",a?"error":""],[null,!0])+">"),a&&a.upload&&r.push(jade.escape(null==(o=t(a.upload))?"":o)),r.push('</div></div><div class="group"><h2>'+jade.escape(null==(o=t("settings display title"))?"":o)+'</h2><select name="sort" class="btn outline secondary">'),function(){var e=i;if("number"==typeof e.length)for(var n=0,a=e.length;a>n;n++){var c=e[n];r.push("<option"+jade.attr("value",c,!0,!1)+jade.attr("selected",s==c,!0,!1)+">"+jade.escape(null==(o=t("settings display sort "+c))?"":o)+"</option>")}else{var a=0;for(var n in e){a++;var c=e[n];r.push("<option"+jade.attr("value",c,!0,!1)+jade.attr("selected",s==c,!0,!1)+">"+jade.escape(null==(o=t("settings display sort "+c))?"":o)+"</option>")}}}.call(this),r.push('</select></div><div class="group"><h2>'+jade.escape(null==(o=t("settings sync title"))?"":o)+"</h2><p>"+jade.escape(null==(o=t("settings sync gplay"))?"":o)+'<a target="_blank" href="https://play.google.com/store/apps/details?id=io.cozy.files_client"><img'+jade.attr("alt",t("settings sync gplay get it"),!0,!1)+jade.attr("src","//developer.android.com/images/brand/"+c+"_generic_rgb_wo_60.png",!0,!1)+"/></a></p><p>"+(null==(o=t("settings sync carddav",{link:"https://cozy.io/mobile/contacts.html"}).replace(/\[(.+)\]\((.+)\)/i,'<a target="_blank" href="$2">$1</a>'))?"":o)+"</p></div></div></div>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/tools/context_actions",function(e,o,r){var n=function(e){var o,r=[],n=e||{},a=n.selected;return r.push("<legend>"+jade.escape(null==(o=t("tools contextual selected",{smart_count:a.length}))?"":o)+'</legend><nav class="select"><ul><li><button formaction="select/all">'+jade.escape(null==(o=t("tools contextual select all"))?"":o)+'</button></li><li><button formaction="select/none">'+jade.escape(null==(o=t("tools contextual select none"))?"":o)+'</button></li></ul></nav><nav><ul><li><button formaction="contacts/merge" class="secondary"><i class="fa fa-code-fork"></i>'+jade.escape(null==(o=t("tools contextual merge"))?"":o)+'</button></li><li><button formaction="contacts/export" class="secondary"><i class="fa fa-upload"></i>'+jade.escape(null==(o=t("tools contextual export"))?"":o)+'</button></li><li><button formaction="contacts/delete" class="secondary"><i class="fa fa-trash"></i>'+jade.escape(null==(o=t("tools contextual delete"))?"":o)+"</button></li></ul></nav>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/tools/default_actions",function(e,o,r){var n=function(e){var o,r=[];return r.push('<nav><ul><li><a href="contacts/new" role="button" class="add secondary"><div class="fa fa-plus"></div><span>'+jade.escape(null==(o=t("tools actions add contact"))?"":o)+'</span></a></li><li><a href="contacts/duplicates" role="button" class="add secondary"><div class="fa fa-code-fork"></div><span>'+jade.escape(null==(o=t("tools actions find duplicates"))?"":o)+"</span></a></li></ul></nav>"),r.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/tools/search",function(e,o,r){var n=function(e){var o=[];return o.push('<span class="fa fa-search"></span><button class="fa fa-times clear"></button><input type="text" id="contacts-search"'+jade.attr("placeholder",t("tools search placeholder"),!0,!1)+' autocomplete="off"/>'),o.join("")};"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof r&&r&&r.exports&&(r.exports=n)}),require.register("views/templates/tools/toolbar",function(t,e,o){var r=function(t){var e=[];return e.push('<button class="drawer-toggle"><i class="fa fa-bars"></i></button>'),e.join("")};"function"==typeof define&&define.amd?define([],function(){return r}):"object"==typeof o&&o&&o.exports&&(o.exports=r)}),require.register("views/tools/context_actions",function(e,o,r){var n,a=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,s=function(t,e){function o(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r.exports=n=function(e){function r(){return this._deleteModalCfg=a(this._deleteModalCfg,this),r.__super__.constructor.apply(this,arguments)}return s(r,e),r.prototype.template=o("views/templates/tools/context_actions"),r.prototype.tagName="fieldset",r.prototype.behaviors=function(){return{Confirm:{triggers:{"click @ui.delete":this._deleteModalCfg}}}},r.prototype.ui={select:'[formaction="select/all"]',unselect:'[formaction="select/none"]',merge:'[formaction="contacts/merge"]',"export":'[formaction="contacts/export"]',"delete":'[formaction="contacts/delete"]'},r.prototype.triggers={"click @ui.select":"select:all","click @ui.unselect":"select:none","click @ui.export":"bulk:export","click @ui.merge":"bulk:merge"},r.prototype.modelEvents={"change:selected":function(t,e){return e.length?this.render():void 0}},r.prototype.initialize=function(){return Mn.bindEntityEvents(this.model,this,this.model.viewEvents)},r.prototype._deleteModalCfg=function(){var e,o;return o={smart_count:this.model.get("selected").length},e={event:"bulk:delete",title:t("bulk confirm delete title",o),message:t("bulk confirm delete message",o),btn_ok:t("bulk confirm delete ok"),btn_cancel:t("bulk confirm delete cancel")}},r}(Mn.ItemView)}),require.register("views/tools/default_actions",function(t,e,o){var r,n={}.hasOwnProperty,a=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.template=e("views/templates/tools/default_actions"),o.prototype.tagName="fieldset",o}(Mn.ItemView)}),require.register("views/tools/search",function(t,e,o){var r,n=function(t,e){return function(){return t.apply(e,arguments)}},a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};o.exports=r=function(t){function o(){return this.updateSearch=n(this.updateSearch,this),o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.template=e("views/templates/tools/search"),o.prototype.tagName="label",o.prototype.className="empty",o.prototype.attributes={"for":"contacts-search"},o.prototype.ui={search:"input",clear:"button.clear"},o.prototype.events=function(){var t;return t=_.debounce(this.updateSearch,250),{"keyup @ui.search":function(e){var o;return o=e.currentTarget.value,this.toggleUi(o),t(o)},"click @ui.clear":this.clearSearch}},o.prototype.updateSearch=function(t){var o;return _.isEmpty(t)&&(t=null,this.toggleUi()),o=e("application"),o.search("text",t)},o.prototype.clearSearch=function(){return this.ui.search.val(""),this.toggleUi(),this.updateSearch()},o.prototype.onDomRefresh=function(){return this.ui.search.focus()},o.prototype.toggleUi=function(t){return this.$el.toggleClass("empty",_.isEmpty(t))},o}(Mn.ItemView)}),require.register("views/tools/toolbar",function(t,e,o){var r,n,a={}.hasOwnProperty,i=function(t,e){function o(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t};r=e("views/tools/search"),o.exports=n=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return i(o,t),o.prototype.template=e("views/templates/tools/toolbar"),o.prototype.ui={drawer:".drawer-toggle"},o.prototype.triggers={"click @ui.drawer":"drawer:toggle"},o.prototype.onRender=function(){return(new r).render().$el.appendTo(this.$el)},o}(Mn.ItemView)});